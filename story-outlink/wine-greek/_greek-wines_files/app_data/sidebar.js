!function e(t,n,r){var o="function"==typeof hypothesisRequire&&hypothesisRequire;function i(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof hypothesisRequire&&hypothesisRequire;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,(function(e){var n=t[a][1][e];return i(n||e)}),l,l.exports,e,t,n,r)}return n[a].exports}for(var a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){!function(e){var t,n,r,o=e.jQuery||e.angular.element,i=e.document.documentElement,a=o(i);return u("change",c),t=c,n=(e.jQuery||e.angular.element).prototype,r=n.val,n.val=function(e){var n=r.apply(this,arguments);return arguments.length>0&&l(this,(function(n){t(n,e)})),n},o.prototype.checkAndTriggerAutoFillEvent=function(){var e,t;for(e=0;e<this.length;e++)s(t=this[e])||(c(t),f(t))},u("blur",(function(t){e.setTimeout((function(){(function(e){for(;e;){if("FORM"===e.nodeName)return o(e);e=e.parentNode}return o()})(t).find("input").checkAndTriggerAutoFillEvent()}),20)})),void e.document.addEventListener("DOMContentLoaded",(function(){l(document.getElementsByTagName("input"),c),e.setTimeout((function(){a.find("input").checkAndTriggerAutoFillEvent()}),200)}),!1);function s(e){"$$currentValue"in e||(e.$$currentValue=e.getAttribute("value"));var t=e.value,n=e.$$currentValue;return!t&&!n||t===n}function c(e){e.$$currentValue=e.value}function u(e,t){i.addEventListener(e,(function(e){var n=e.target;t(n)}),!0)}function l(e,t){if(e.forEach)return e.forEach(t);var n;for(n=0;n<e.length;n++)t(e[n])}function f(t){var n=e.document.createEvent("HTMLEvents");n.initEvent("change",!0,!0),t.dispatchEvent(n)}}(window)},{}],2:[function(e,t,n){
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var e={}.hasOwnProperty;function n(){for(var t=[],r=0;r<arguments.length;r++){var o=arguments[r];if(o){var i=typeof o;if("string"===i||"number"===i)t.push(o);else if(Array.isArray(o)&&o.length){var a=n.apply(null,o);a&&t.push(a)}else if("object"===i)for(var s in o)e.call(o,s)&&o[s]&&t.push(s)}}return t.join(" ")}void 0!==t&&t.exports?(n.default=n,t.exports=n):"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],(function(){return n})):window.classNames=n}()},{}],3:[function(e,t,n){!function(e,r){"object"==typeof n&&void 0!==t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.DOMPurify=r()}(this,(function(){"use strict";var e=Object.freeze||function(e){return e},t=e(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),n=e(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),r=e(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),o=e(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),i=e(["#text"]),a=Object.freeze||function(e){return e},s=a(["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","coords","crossorigin","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","integrity","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","minlength","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"]),c=a(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),u=a(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),l=a(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),f=Object.hasOwnProperty,d=Object.setPrototypeOf,p=("undefined"!=typeof Reflect&&Reflect).apply;function h(e,t){d&&d(e,null);for(var n=t.length;n--;){var r=t[n];if("string"==typeof r){var o=r.toLowerCase();o!==r&&(Object.isFrozen(t)||(t[n]=o),r=o)}e[r]=!0}return e}function m(e){var t={},n=void 0;for(n in e)p(f,e,[n])&&(t[n]=e[n]);return t}p||(p=function(e,t,n){return e.apply(t,n)});var g=Object.seal||function(e){return e},v=g(/\{\{[\s\S]*|[\s\S]*\}\}/gm),y=g(/<%[\s\S]*|[\s\S]*%>/gm),b=g(/^data-[\-\w.\u00B7-\uFFFF]/),_=g(/^aria-[\-\w]+$/),w=g(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),A=g(/^(?:\w+script|data):/i),T=g(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g),E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function S(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var O=("undefined"!=typeof Reflect&&Reflect).apply,k=Array.prototype.slice,x=Object.freeze,N=function(){return"undefined"==typeof window?null:window};O||(O=function(e,t,n){return e.apply(t,n)});var C=function(e,t){if("object"!==(void 0===e?"undefined":E(e))||"function"!=typeof e.createPolicy)return null;var n=null;t.currentScript&&t.currentScript.hasAttribute("data-tt-policy-suffix")&&(n=t.currentScript.getAttribute("data-tt-policy-suffix"));var r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};return function e(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N(),f=function(t){return e(t)};if(f.version="2.0.7",f.removed=[],!a||!a.document||9!==a.document.nodeType)return f.isSupported=!1,f;var d=a.document,p=!1,g=!1,j=a.document,D=a.DocumentFragment,I=a.HTMLTemplateElement,L=a.Node,P=a.NodeFilter,R=a.NamedNodeMap,F=void 0===R?a.NamedNodeMap||a.MozNamedAttrMap:R,U=a.Text,M=a.Comment,B=a.DOMParser,H=a.TrustedTypes;if("function"==typeof I){var $=j.createElement("template");$.content&&$.content.ownerDocument&&(j=$.content.ownerDocument)}var q=C(H,d),G=q?q.createHTML(""):"",z=j,V=z.implementation,W=z.createNodeIterator,K=z.getElementsByTagName,Y=z.createDocumentFragment,Q=d.importNode,J={};f.isSupported=V&&void 0!==V.createHTMLDocument&&9!==j.documentMode;var X=v,Z=y,ee=b,te=_,ne=A,re=T,oe=w,ie=null,ae=h({},[].concat(S(t),S(n),S(r),S(o),S(i))),se=null,ce=h({},[].concat(S(s),S(c),S(u),S(l))),ue=null,le=null,fe=!0,de=!0,pe=!1,he=!1,me=!1,ge=!1,ve=!1,ye=!1,be=!1,_e=!1,we=!1,Ae=!1,Te=!0,Ee=!0,Se=!1,Oe={},ke=h({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),xe=h({},["audio","video","img","source","image"]),Ne=null,Ce=h({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),je=null,De=j.createElement("form"),Ie=function(e){je&&je===e||(e&&"object"===(void 0===e?"undefined":E(e))||(e={}),ie="ALLOWED_TAGS"in e?h({},e.ALLOWED_TAGS):ae,se="ALLOWED_ATTR"in e?h({},e.ALLOWED_ATTR):ce,Ne="ADD_URI_SAFE_ATTR"in e?h(m(Ce),e.ADD_URI_SAFE_ATTR):Ce,ue="FORBID_TAGS"in e?h({},e.FORBID_TAGS):{},le="FORBID_ATTR"in e?h({},e.FORBID_ATTR):{},Oe="USE_PROFILES"in e&&e.USE_PROFILES,fe=!1!==e.ALLOW_ARIA_ATTR,de=!1!==e.ALLOW_DATA_ATTR,pe=e.ALLOW_UNKNOWN_PROTOCOLS||!1,he=e.SAFE_FOR_JQUERY||!1,me=e.SAFE_FOR_TEMPLATES||!1,ge=e.WHOLE_DOCUMENT||!1,be=e.RETURN_DOM||!1,_e=e.RETURN_DOM_FRAGMENT||!1,we=e.RETURN_DOM_IMPORT||!1,Ae=e.RETURN_TRUSTED_TYPE||!1,ye=e.FORCE_BODY||!1,Te=!1!==e.SANITIZE_DOM,Ee=!1!==e.KEEP_CONTENT,Se=e.IN_PLACE||!1,oe=e.ALLOWED_URI_REGEXP||oe,me&&(de=!1),_e&&(be=!0),Oe&&(ie=h({},[].concat(S(i))),se=[],!0===Oe.html&&(h(ie,t),h(se,s)),!0===Oe.svg&&(h(ie,n),h(se,c),h(se,l)),!0===Oe.svgFilters&&(h(ie,r),h(se,c),h(se,l)),!0===Oe.mathMl&&(h(ie,o),h(se,u),h(se,l))),e.ADD_TAGS&&(ie===ae&&(ie=m(ie)),h(ie,e.ADD_TAGS)),e.ADD_ATTR&&(se===ce&&(se=m(se)),h(se,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&h(Ne,e.ADD_URI_SAFE_ATTR),Ee&&(ie["#text"]=!0),ge&&h(ie,["html","head","body"]),ie.table&&(h(ie,["tbody"]),delete ue.tbody),x&&x(e),je=e)},Le=function(e){f.removed.push({element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=G}},Pe=function(e,t){try{f.removed.push({attribute:t.getAttributeNode(e),from:t})}catch(e){f.removed.push({attribute:null,from:t})}t.removeAttribute(e)},Re=function(e){var t=void 0,n=void 0;if(ye)e="<remove></remove>"+e;else{var r=e.match(/^[\s]+/);(n=r&&r[0])&&(e=e.slice(n.length))}if(p)try{t=(new B).parseFromString(e,"text/html")}catch(e){}if(g&&h(ue,["title"]),!t||!t.documentElement){var o=(t=V.createHTMLDocument("")).body;o.parentNode.removeChild(o.parentNode.firstElementChild),o.outerHTML=q?q.createHTML(e):e}return e&&n&&t.body.insertBefore(j.createTextNode(n),t.body.childNodes[0]||null),K.call(t,ge?"html":"body")[0]};f.isSupported&&(function(){try{Re('<svg><p><textarea><img src="</textarea><img src=x abc=1//">').querySelector("svg img")&&(p=!0)}catch(e){}}(),function(){try{var e=Re("<x/><title>&lt;/title&gt;&lt;img&gt;");/<\/title/.test(e.querySelector("title").innerHTML)&&(g=!0)}catch(e){}}());var Fe=function(e){return W.call(e.ownerDocument||e,e,P.SHOW_ELEMENT|P.SHOW_COMMENT|P.SHOW_TEXT,(function(){return P.FILTER_ACCEPT}),!1)},Ue=function(e){return"object"===(void 0===L?"undefined":E(L))?e instanceof L:e&&"object"===(void 0===e?"undefined":E(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Me=function(e,t,n){J[e]&&J[e].forEach((function(e){e.call(f,t,n,je)}))},Be=function(e){var t,n=void 0;if(Me("beforeSanitizeElements",e,null),!((t=e)instanceof U||t instanceof M||"string"==typeof t.nodeName&&"string"==typeof t.textContent&&"function"==typeof t.removeChild&&t.attributes instanceof F&&"function"==typeof t.removeAttribute&&"function"==typeof t.setAttribute&&"string"==typeof t.namespaceURI))return Le(e),!0;var r=e.nodeName.toLowerCase();if(Me("uponSanitizeElement",e,{tagName:r,allowedTags:ie}),("svg"===r||"math"===r)&&0!==e.querySelectorAll("p, br").length)return Le(e),!0;if(!ie[r]||ue[r]){if(Ee&&!ke[r]&&"function"==typeof e.insertAdjacentHTML)try{var o=e.innerHTML;e.insertAdjacentHTML("AfterEnd",q?q.createHTML(o):o)}catch(e){}return Le(e),!0}return"noscript"===r&&/<\/noscript/i.test(e.innerHTML)?(Le(e),!0):"noembed"===r&&/<\/noembed/i.test(e.innerHTML)?(Le(e),!0):(!he||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(f.removed.push({element:e.cloneNode()}),e.innerHTML?e.innerHTML=e.innerHTML.replace(/</g,"&lt;"):e.innerHTML=e.textContent.replace(/</g,"&lt;")),me&&3===e.nodeType&&(n=(n=(n=e.textContent).replace(X," ")).replace(Z," "),e.textContent!==n&&(f.removed.push({element:e.cloneNode()}),e.textContent=n)),Me("afterSanitizeElements",e,null),!1)},He=function(e,t,n){if(Te&&("id"===t||"name"===t)&&(n in j||n in De))return!1;if(de&&ee.test(t));else if(fe&&te.test(t));else{if(!se[t]||le[t])return!1;if(Ne[t]);else if(oe.test(n.replace(re,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==n.indexOf("data:")||!xe[e])if(pe&&!ne.test(n.replace(re,"")));else if(n)return!1}return!0},$e=function(e){var t=void 0,n=void 0,r=void 0,o=void 0,i=void 0;Me("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:se};for(i=a.length;i--;){var c=t=a[i],u=c.name,l=c.namespaceURI;if(n=t.value.trim(),r=u.toLowerCase(),s.attrName=r,s.attrValue=n,s.keepAttr=!0,Me("uponSanitizeAttribute",e,s),n=s.attrValue,"name"===r&&"IMG"===e.nodeName&&a.id)o=a.id,a=O(k,a,[]),Pe("id",e),Pe(u,e),a.indexOf(o)>i&&e.setAttribute("id",o.value);else{if("INPUT"===e.nodeName&&"type"===r&&"file"===n&&s.keepAttr&&(se[r]||!le[r]))continue;"id"===u&&e.setAttribute(u,""),Pe(u,e)}if(s.keepAttr)if(/svg|math/i.test(e.namespaceURI)&&new RegExp("</("+Object.keys(ke).join("|")+")","i").test(n))Pe(u,e);else{me&&(n=(n=n.replace(X," ")).replace(Z," "));var d=e.nodeName.toLowerCase();if(He(d,r,n))try{l?e.setAttributeNS(l,u,n):e.setAttribute(u,n),f.removed.pop()}catch(e){}}}Me("afterSanitizeAttributes",e,null)}},qe=function e(t){var n=void 0,r=Fe(t);for(Me("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)Me("uponSanitizeShadowNode",n,null),Be(n)||(n.content instanceof D&&e(n.content),$e(n));Me("afterSanitizeShadowDOM",t,null)};return f.sanitize=function(e,t){var n=void 0,r=void 0,o=void 0,i=void 0,s=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!Ue(e)){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");if("string"!=typeof(e=e.toString()))throw new TypeError("dirty is not a string, aborting")}if(!f.isSupported){if("object"===E(a.toStaticHTML)||"function"==typeof a.toStaticHTML){if("string"==typeof e)return a.toStaticHTML(e);if(Ue(e))return a.toStaticHTML(e.outerHTML)}return e}if(ve||Ie(t),f.removed=[],Se);else if(e instanceof L)1===(r=(n=Re("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===r.nodeName?n=r:"HTML"===r.nodeName?n=r:n.appendChild(r);else{if(!be&&!me&&!ge&&Ae&&-1===e.indexOf("<"))return q?q.createHTML(e):e;if(!(n=Re(e)))return be?null:G}n&&ye&&Le(n.firstChild);for(var c=Fe(Se?e:n);o=c.nextNode();)3===o.nodeType&&o===i||Be(o)||(o.content instanceof D&&qe(o.content),$e(o),i=o);if(i=null,Se)return e;if(be){if(_e)for(s=Y.call(n.ownerDocument);n.firstChild;)s.appendChild(n.firstChild);else s=n;return we&&(s=Q.call(d,s,!0)),s}var u=ge?n.outerHTML:n.innerHTML;return me&&(u=(u=u.replace(X," ")).replace(Z," ")),q&&Ae?q.createHTML(u):u},f.setConfig=function(e){Ie(e),ve=!0},f.clearConfig=function(){je=null,ve=!1},f.isValidAttribute=function(e,t,n){je||Ie({});var r=e.toLowerCase(),o=t.toLowerCase();return He(r,o,n)},f.addHook=function(e,t){"function"==typeof t&&(J[e]=J[e]||[],J[e].push(t))},f.removeHook=function(e){J[e]&&J[e].pop()},f.removeHooks=function(e){J[e]&&(J[e]=[])},f.removeAllHooks=function(){J={}},f}()}))},{}],4:[function(e,t,n){
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */
"use strict";var r=/["'&<>]/;t.exports=function(e){var t,n=""+e,o=r.exec(n);if(!o)return n;var i="",a=0,s=0;for(a=o.index;a<n.length;a++){switch(n.charCodeAt(a)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}s!==a&&(i+=n.substring(s,a)),s=a+1,i+=t}return s!==a?i+n.substring(s,a):i}},{}],5:[function(e,t,n){"use strict";var r=/[|\\{}()[\]^$+*?.]/g;t.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(r,"\\$&")}},{}],6:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=Object.defineProperty,a=Object.getOwnPropertyDescriptor,s=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===o.call(e)},c=function(e){if(!e||"[object Object]"!==o.call(e))return!1;var t,n=r.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!i)return!1;for(t in e);return void 0===t||r.call(e,t)},u=function(e,t){i&&"__proto__"===t.name?i(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},l=function(e,t){if("__proto__"===t){if(!r.call(e,t))return;if(a)return a(e,t).value}return e[t]};t.exports=function e(){var t,n,r,o,i,a,f=arguments[0],d=1,p=arguments.length,h=!1;for("boolean"==typeof f&&(h=f,f=arguments[1]||{},d=2),(null==f||"object"!=typeof f&&"function"!=typeof f)&&(f={});d<p;++d)if(null!=(t=arguments[d]))for(n in t)r=l(f,n),f!==(o=l(t,n))&&(h&&o&&(c(o)||(i=s(o)))?(i?(i=!1,a=r&&s(r)?r:[]):a=r&&c(r)?r:{},u(f,{name:n,newValue:e(h,a,o)})):void 0!==o&&u(f,{name:n,newValue:o}));return f}},{}],7:[function(e,t,n){!function(e,r){"object"==typeof n&&void 0!==t?r():"function"==typeof define&&define.amd?define(r):r()}(0,(function(){"use strict";function e(e){var t=!0,n=!1,r=null,o={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function i(e){return!!(e&&e!==document&&"HTML"!==e.nodeName&&"BODY"!==e.nodeName&&"classList"in e&&"contains"in e.classList)}function a(e){e.classList.contains("focus-visible")||(e.classList.add("focus-visible"),e.setAttribute("data-focus-visible-added",""))}function s(e){t=!1}function c(){document.addEventListener("mousemove",u),document.addEventListener("mousedown",u),document.addEventListener("mouseup",u),document.addEventListener("pointermove",u),document.addEventListener("pointerdown",u),document.addEventListener("pointerup",u),document.addEventListener("touchmove",u),document.addEventListener("touchstart",u),document.addEventListener("touchend",u)}function u(e){e.target.nodeName&&"html"===e.target.nodeName.toLowerCase()||(t=!1,document.removeEventListener("mousemove",u),document.removeEventListener("mousedown",u),document.removeEventListener("mouseup",u),document.removeEventListener("pointermove",u),document.removeEventListener("pointerdown",u),document.removeEventListener("pointerup",u),document.removeEventListener("touchmove",u),document.removeEventListener("touchstart",u),document.removeEventListener("touchend",u))}document.addEventListener("keydown",(function(n){n.metaKey||n.altKey||n.ctrlKey||(i(e.activeElement)&&a(e.activeElement),t=!0)}),!0),document.addEventListener("mousedown",s,!0),document.addEventListener("pointerdown",s,!0),document.addEventListener("touchstart",s,!0),document.addEventListener("visibilitychange",(function(e){"hidden"==document.visibilityState&&(n&&(t=!0),c())}),!0),c(),e.addEventListener("focus",(function(e){var n,r,s;i(e.target)&&(t||(r=(n=e.target).type,"INPUT"==(s=n.tagName)&&o[r]&&!n.readOnly||"TEXTAREA"==s&&!n.readOnly||n.isContentEditable))&&a(e.target)}),!0),e.addEventListener("blur",(function(e){var t;i(e.target)&&(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added"))&&(n=!0,window.clearTimeout(r),r=window.setTimeout((function(){n=!1,window.clearTimeout(r)}),100),(t=e.target).hasAttribute("data-focus-visible-added")&&(t.classList.remove("focus-visible"),t.removeAttribute("data-focus-visible-added")))}),!0),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host?e.host.setAttribute("data-js-focus-visible",""):e.nodeType===Node.DOCUMENT_NODE&&document.documentElement.classList.add("js-focus-visible")}if("undefined"!=typeof window&&"undefined"!=typeof document){var t;window.applyFocusVisiblePolyfill=e;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch(e){(t=document.createEvent("CustomEvent")).initCustomEvent("focus-visible-polyfill-ready",!1,!1,{})}window.dispatchEvent(t)}"undefined"!=typeof document&&e(document)}))},{}],8:[function(e,t,n){(function(e){var n="Expected a function",r=NaN,o="[object Symbol]",i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt,l="object"==typeof e&&e&&e.Object===Object&&e,f="object"==typeof self&&self&&self.Object===Object&&self,d=l||f||Function("return this")(),p=Object.prototype.toString,h=Math.max,m=Math.min,g=function(){return d.Date.now()};function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&p.call(e)==o}(e))return r;if(v(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=v(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=s.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):a.test(e)?r:+e}t.exports=function(e,t,r){var o,i,a,s,c,u,l=0,f=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError(n);function b(t){var n=o,r=i;return o=i=void 0,l=t,s=e.apply(r,n)}function _(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-l>=a}function w(){var e=g();if(_(e))return A(e);c=setTimeout(w,function(e){var n=t-(e-u);return d?m(n,a-(e-l)):n}(e))}function A(e){return c=void 0,p&&o?b(e):(o=i=void 0,s)}function T(){var e=g(),n=_(e);if(o=arguments,i=this,u=e,n){if(void 0===c)return function(e){return l=e,c=setTimeout(w,t),f?b(e):s}(u);if(d)return c=setTimeout(w,t),b(u)}return void 0===c&&(c=setTimeout(w,t)),s}return t=y(t)||0,v(r)&&(f=!!r.leading,a=(d="maxWait"in r)?h(y(r.maxWait)||0,t):a,p="trailing"in r?!!r.trailing:p),T.cancel=function(){void 0!==c&&clearTimeout(c),l=0,o=u=i=c=void 0},T.flush=function(){return void 0===c?s:A(g())},T}}).call(this,window)},{}],9:[function(e,t,n){(function(e){var n="Expected a function",r="__lodash_hash_undefined__",o=1/0,i="[object Function]",a="[object GeneratorFunction]",s="[object Symbol]",c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/,l=/^\./,f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/\\(\\)?/g,p=/^\[object .+?Constructor\]$/,h="object"==typeof e&&e&&e.Object===Object&&e,m="object"==typeof self&&self&&self.Object===Object&&self,g=h||m||Function("return this")();var v,y=Array.prototype,b=Function.prototype,_=Object.prototype,w=g["__core-js_shared__"],A=(v=/[^.]+$/.exec(w&&w.keys&&w.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",T=b.toString,E=_.hasOwnProperty,S=_.toString,O=RegExp("^"+T.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=g.Symbol,x=y.splice,N=B(g,"Map"),C=B(Object,"create"),j=k?k.prototype:void 0,D=j?j.toString:void 0;function I(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function L(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function P(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function R(e,t){for(var n=e.length;n--;)if(G(e[n][0],t))return n;return-1}function F(e,t){for(var n=0,r=(t=function(e,t){if(z(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!W(e))||u.test(e)||!c.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:function(e){return z(e)?e:H(e)}(t)).length;null!=e&&n<r;)e=e[$(t[n++])];return n&&n==r?e:void 0}function U(e){return!(!V(e)||function(e){return!!A&&A in e}(e))&&(function(e){var t=V(e)?S.call(e):"";return t==i||t==a}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?O:p).test(function(e){if(null!=e){try{return T.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function M(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function B(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return U(n)?n:void 0}I.prototype.clear=function(){this.__data__=C?C(null):{}},I.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},I.prototype.get=function(e){var t=this.__data__;if(C){var n=t[e];return n===r?void 0:n}return E.call(t,e)?t[e]:void 0},I.prototype.has=function(e){var t=this.__data__;return C?void 0!==t[e]:E.call(t,e)},I.prototype.set=function(e,t){return this.__data__[e]=C&&void 0===t?r:t,this},L.prototype.clear=function(){this.__data__=[]},L.prototype.delete=function(e){var t=this.__data__,n=R(t,e);return!(n<0||(n==t.length-1?t.pop():x.call(t,n,1),0))},L.prototype.get=function(e){var t=this.__data__,n=R(t,e);return n<0?void 0:t[n][1]},L.prototype.has=function(e){return R(this.__data__,e)>-1},L.prototype.set=function(e,t){var n=this.__data__,r=R(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},P.prototype.clear=function(){this.__data__={hash:new I,map:new(N||L),string:new I}},P.prototype.delete=function(e){return M(this,e).delete(e)},P.prototype.get=function(e){return M(this,e).get(e)},P.prototype.has=function(e){return M(this,e).has(e)},P.prototype.set=function(e,t){return M(this,e).set(e,t),this};var H=q((function(e){e=function(e){return null==e?"":function(e){if("string"==typeof e)return e;if(W(e))return D?D.call(e):"";var t=e+"";return"0"==t&&1/e==-o?"-0":t}(e)}(e);var t=[];return l.test(e)&&t.push(""),e.replace(f,(function(e,n,r,o){t.push(r?o.replace(d,"$1"):n||e)})),t}));function $(e){if("string"==typeof e||W(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}function q(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(n);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(q.Cache||P),r}function G(e,t){return e===t||e!=e&&t!=t}q.Cache=P;var z=Array.isArray;function V(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function W(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&S.call(e)==s}t.exports=function(e,t,n){var r=null==e?void 0:F(e,t);return void 0===r?n:r}}).call(this,window)},{}],10:[function(e,t,n){!function(n){"use strict";var r,o,i,a,s;n?function(){var e=n.crypto||n.msCrypto;if(!r&&e&&e.getRandomValues)try{var t=new Uint8Array(16);a=r=function(){return e.getRandomValues(t),t},r()}catch(e){}if(!r){var i=new Array(16);o=r=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i},"undefined"!=typeof console&&console.warn&&console.warn("[SECURITY] node-uuid: crypto not usable, falling back to insecure Math.random()")}}():function(){if("function"==typeof e)try{var t=e("crypto").randomBytes;i=r=t&&function(){return t(16)},r()}catch(t){}}();for(var c="function"==typeof Buffer?Buffer:Array,u=[],l={},f=0;f<256;f++)u[f]=(f+256).toString(16).substr(1),l[u[f]]=f;function d(e,t){var n=t||0,r=u;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}var p=r(),h=[1|p[0],p[1],p[2],p[3],p[4],p[5]],m=16383&(p[6]<<8|p[7]),g=0,v=0;function y(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new c(16):null,e=null);var i=(e=e||{}).random||(e.rng||r)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var a=0;a<16;a++)t[o+a]=i[a];return t||d(i)}var b=y;b.v1=function(e,t,n){var r=t&&n||0,o=t||[],i=null!=(e=e||{}).clockseq?e.clockseq:m,a=null!=e.msecs?e.msecs:(new Date).getTime(),s=null!=e.nsecs?e.nsecs:v+1,c=a-g+(s-v)/1e4;if(c<0&&null==e.clockseq&&(i=i+1&16383),(c<0||a>g)&&null==e.nsecs&&(s=0),s>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=a,v=s,m=i;var u=(1e4*(268435455&(a+=122192928e5))+s)%4294967296;o[r++]=u>>>24&255,o[r++]=u>>>16&255,o[r++]=u>>>8&255,o[r++]=255&u;var l=a/4294967296*1e4&268435455;o[r++]=l>>>8&255,o[r++]=255&l,o[r++]=l>>>24&15|16,o[r++]=l>>>16&255,o[r++]=i>>>8|128,o[r++]=255&i;for(var f=e.node||h,p=0;p<6;p++)o[r+p]=f[p];return t||d(o)},b.v4=y,b.parse=function(e,t,n){var r=t&&n||0,o=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,(function(e){o<16&&(t[r+o++]=l[e])}));o<16;)t[r+o++]=0;return t},b.unparse=d,b.BufferClass=c,b._rng=r,b._mathRNG=o,b._nodeRNG=i,b._whatwgRNG=a,void 0!==t&&t.exports?t.exports=b:"function"==typeof define&&define.amd?define((function(){return b})):(s=n.uuid,b.noConflict=function(){return n.uuid=s,b},n.uuid=b)}("undefined"!=typeof window?window:null)},{crypto:void 0}],11:[function(e,t,n){var r=e("preact");function o(e){return e.type===r.Fragment?"Wrapper":"function"==typeof e.type?"Composite":"string"==typeof e.type?"Native":"Text"}function i(e){return e.type===r.Fragment?"Fragment":"function"==typeof e.type?e.type.displayName||e.type.name:"string"==typeof e.type?e.type:"#text"}function a(e,t,n){var r=t.pop(),o=t.reduce((function(e,t){return e?e[t]:null}),e);o&&(o[r]=n)}function s(e){var t=e.__c,n=null;null!=t&&t instanceof r.Component&&(n={setState:t.setState.bind(t),forceUpdate:t.forceUpdate.bind(t),setInState:function(e,n){t.setState((function(t){return a(t,e,n),t}))},setInProps:function(n,r){a(e.props,n,r),t.setState({})},setInContext:function(e,n){a(t.context,e,n),t.setState({})}});var s=c(e),u=e.endTime-e.startTime;return{nodeType:o(e),type:e.type,name:i(e),ref:e.ref||null,key:e.key||null,updater:n,text:null===e.type?e.props:null,state:null!=t&&t instanceof r.Component?t.state:null,props:e.props,children:null!==e.type?null!=s&&1==s.length&&null===s[0].type?s[0].props:s:null,publicInstance:l(e),memoizedInteractions:[],actualDuration:u,actualStartTime:e.startTime,treeBaseDuration:u}}function c(e){return null==e.__c?null!=e.__k?e.__k.filter(Boolean):[]:null!=e.__k?e.__k.filter(Boolean):null}function u(e){return e.type===r.Fragment&&null===e.__}function l(e){return u(e)?e.__k.length>0&&null!=e.__k[0]&&null!=e.__k[0].__e?e.__k[0].__e.parentNode:e:null!=e.__c?e.__c:e.type===r.Fragment?e.props:e.__e}function f(e,t,n){if(null==e||null==t)return!1;for(var r in e)if((!n||"children"!=r||null==t[r])&&e[r]!==t[r])return!1;return Object.keys(e).length===Object.keys(t).length}var d=r.Component.prototype.setState;r.Component.prototype.setState=function(e,t){return null==this.__v?console.warn('Calling "this.setState" inside the constructor of a component is a no-op and might be a bug in your application. Instead, set "this.state = {}" directly.'):null==this.__P&&console.warn('Can\'t call "this.setState" on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in the componentWillUnmount method.'),d.call(this,e,t)};var p=r.Component.prototype.forceUpdate;r.Component.prototype.forceUpdate=function(e){return null==this.__v?console.warn('Calling "this.forceUpdate" inside the constructor of a component is a no-op and might be a bug in your application.'):null==this.__P&&console.warn('Can\'t call "this.setState" on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in the componentWillUnmount method.'),p.call(this,e)};!function(){function e(e,t){this.rid=t,this.hook=e,this.pending=[],this.inst2vnode=new WeakMap,this.connected=!1}var t=e.prototype;t.markConnected=function(){this.connected=!0,this.flushPendingEvents()},t.flushPendingEvents=function(){if(this.connected){var e=this.pending;this.pending=[];for(var t=0;t<e.length;t++){var n=e[t];this.hook.emit(n.type,n)}}},t.mount=function(e){this.inst2vnode.set(l(e),e);var t=s(e),n=[{internalInstance:e,data:t,renderer:this.rid,type:"mount"}];if(Array.isArray(t.children))for(var r,o=t.children.slice();null!=(r=o.pop());){var i=c(r);o.push.apply(o,i),this.inst2vnode.set(l(r),r);var a=s(r);n.push({internalInstance:r,data:a,renderer:this.rid,type:"mount"})}for(var f=n.length;--f>=0;)this.pending.push(n[f]);u(e)&&this.pending.push({internalInstance:e,data:t,renderer:this.rid,type:"root"})},t.update=function(e){var t=s(e);if(Array.isArray(t.children))for(var n=0;n<t.children.length;n++){var r=t.children[n],o=l(r);null==this.inst2vnode.get(o)?this.mount(r):this.update(r),t.children[n]=this.inst2vnode.get(o)}var i=this.inst2vnode.get(t.publicInstance);!function(e,t){return e.props!==t.props&&!f(e.props,t.props,!0)||null!=e.__c&&!f(t.__c.__u,t.__c.state)||e.__e!==t.__e||e.ref!==t.ref}(i,e)?this.pending.push({internalInstance:i,data:t,renderer:this.rid,type:"updateProfileTimes"}):this.pending.push({internalInstance:i,data:t,renderer:this.rid,type:"update"})},t.handleCommitFiberRoot=function(e){var t=l(e);this.inst2vnode.has(t)?this.update(e):this.mount(e);var n=null;if(u(e))e.treeBaseDuration=0,n=e;else for(n=e;null!=n.__;)n=n.__;return this.pending.push({internalInstance:n,renderer:this.rid,data:s(n),type:"rootCommitted"}),this.flushPendingEvents(),e},t.handleCommitFiberUnmount=function(e){var t=l(e);this.inst2vnode.delete(t),this.pending.push({internalInstance:e,renderer:this.rid,type:"unmount"})},t.getNativeFromReactElement=function(e){return e.__e},t.getReactElementFromNative=function(e){return this.inst2vnode.get(e)||null},t.walkTree=function(){},t.cleanup=function(){}}();new Map;new Set(["dom","fragment"]);Date.now;try{performance.now.bind(performance)}catch(r){}},{preact:12}],12:[function(e,t,n){var r,o,i,a,s,c,u,l={},f=[],d=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function p(e,t){for(var n in t)e[n]=t[n];return e}function h(e){var t=e.parentNode;t&&t.removeChild(e)}function m(e,t,n){var r,o=arguments,i={};for(r in t)"key"!==r&&"ref"!==r&&(i[r]=t[r]);if(arguments.length>3)for(n=[n],r=3;r<arguments.length;r++)n.push(o[r]);if(null!=n&&(i.children=n),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===i[r]&&(i[r]=e.defaultProps[r]);return g(e,i,t&&t.key,t&&t.ref)}function g(e,t,n,o){var i={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:null,__c:null,constructor:void 0};return r.vnode&&r.vnode(i),i}function v(e){return e.children}function y(e,t){this.props=e,this.context=t}function b(e,t){if(null==t)return e.__?b(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?b(e):null}function _(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return _(e)}}function w(e){(!e.__d&&(e.__d=!0)&&1===i.push(e)||s!==r.debounceRendering)&&((s=r.debounceRendering)||a)(A)}function A(){var e,t,n,r,o,a,s;for(i.sort((function(e,t){return t.__v.__b-e.__v.__b}));e=i.pop();)e.__d&&(n=void 0,r=void 0,a=(o=(t=e).__v).__e,(s=t.__P)&&(n=[],r=x(s,o,p({},o),t.__n,void 0!==s.ownerSVGElement,null,n,null==a?b(o):a),N(n,o),r!=a&&_(o)))}function T(e,t,n,r,o,i,a,s,c){var u,d,p,m,g,v,y,_=n&&n.__k||f,w=_.length;if(s==l&&(s=null!=i?i[0]:w?b(n,0):null),u=0,t.__k=E(t.__k,(function(n){if(null!=n){if(n.__=t,n.__b=t.__b+1,null===(p=_[u])||p&&n.key==p.key&&n.type===p.type)_[u]=void 0;else for(d=0;d<w;d++){if((p=_[d])&&n.key==p.key&&n.type===p.type){_[d]=void 0;break}p=null}if(m=x(e,n,p=p||l,r,o,i,a,s,c),(d=n.ref)&&p.ref!=d&&(y||(y=[]),p.ref&&y.push(p.ref,null,n),y.push(d,n.__c||m,n)),null!=m){if(null==v&&(v=m),null!=n.__d)m=n.__d,n.__d=null;else if(i==p||m!=s||null==m.parentNode){e:if(null==s||s.parentNode!==e)e.appendChild(m);else{for(g=s,d=0;(g=g.nextSibling)&&d<w;d+=2)if(g==m)break e;e.insertBefore(m,s)}"option"==t.type&&(e.value="")}s=m.nextSibling,"function"==typeof t.type&&(t.__d=m)}}return u++,n})),t.__e=v,null!=i&&"function"!=typeof t.type)for(u=i.length;u--;)null!=i[u]&&h(i[u]);for(u=w;u--;)null!=_[u]&&D(_[u],_[u]);if(y)for(u=0;u<y.length;u++)j(y[u],y[++u],y[++u])}function E(e,t,n){if(null==n&&(n=[]),null==e||"boolean"==typeof e)t&&n.push(t(null));else if(Array.isArray(e))for(var r=0;r<e.length;r++)E(e[r],t,n);else n.push(t?t("string"==typeof e||"number"==typeof e?g(null,e,null,null):null!=e.__e||null!=e.__c?g(e.type,e.props,e.key,null):e):e);return n}function S(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]="number"==typeof n&&!1===d.test(t)?n+"px":null==n?"":n}function O(e,t,n,r,o){var i,a,s,c,u;if(o?"className"===t&&(t="class"):"class"===t&&(t="className"),"key"===t||"children"===t);else if("style"===t)if(i=e.style,"string"==typeof n)i.cssText=n;else{if("string"==typeof r&&(i.cssText="",r=null),r)for(a in r)n&&a in n||S(i,a,"");if(n)for(s in n)r&&n[s]===r[s]||S(i,s,n[s])}else"o"===t[0]&&"n"===t[1]?(c=t!==(t=t.replace(/Capture$/,"")),u=t.toLowerCase(),t=(u in e?u:t).slice(2),n?(r||e.addEventListener(t,k,c),(e.l||(e.l={}))[t]=n):e.removeEventListener(t,k,c)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&!o&&t in e?e[t]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==n||!1===n?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),n):null==n||!1===n?e.removeAttribute(t):e.setAttribute(t,n))}function k(e){this.l[e.type](r.event?r.event(e):e)}function x(e,t,n,o,i,a,s,c,u){var l,f,d,h,m,g,b,_,w,A,S=t.type;if(void 0!==t.constructor)return null;(l=r.__b)&&l(t);try{e:if("function"==typeof S){if(_=t.props,w=(l=S.contextType)&&o[l.__c],A=l?w?w.props.value:l.__:o,n.__c?b=(f=t.__c=n.__c).__=f.__E:("prototype"in S&&S.prototype.render?t.__c=f=new S(_,A):(t.__c=f=new y(_,A),f.constructor=S,f.render=I),w&&w.sub(f),f.props=_,f.state||(f.state={}),f.context=A,f.__n=o,d=f.__d=!0,f.__h=[]),null==f.__s&&(f.__s=f.state),null!=S.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=p({},f.__s)),p(f.__s,S.getDerivedStateFromProps(_,f.__s))),h=f.props,m=f.state,d)null==S.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(null==S.getDerivedStateFromProps&&null==f.__e&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(_,A),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(_,f.__s,A)){for(f.props=_,f.state=f.__s,f.__d=!1,f.__v=t,t.__e=n.__e,t.__k=n.__k,f.__h.length&&s.push(f),l=0;l<t.__k.length;l++)t.__k[l]&&(t.__k[l].__=t);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(_,f.__s,A),null!=f.componentDidUpdate&&f.__h.push((function(){f.componentDidUpdate(h,m,g)}))}f.context=A,f.props=_,f.state=f.__s,(l=r.__r)&&l(t),f.__d=!1,f.__v=t,f.__P=e,l=f.render(f.props,f.state,f.context),t.__k=E(null!=l&&l.type==v&&null==l.key?l.props.children:l),null!=f.getChildContext&&(o=p(p({},o),f.getChildContext())),d||null==f.getSnapshotBeforeUpdate||(g=f.getSnapshotBeforeUpdate(h,m)),T(e,t,n,o,i,a,s,c,u),f.base=t.__e,f.__h.length&&s.push(f),b&&(f.__E=f.__=null),f.__e=null}else t.__e=C(n.__e,t,n,o,i,a,s,u);(l=r.diffed)&&l(t)}catch(e){r.__e(e,t,n)}return t.__e}function N(e,t){r.__c&&r.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){r.__e(e,t.__v)}}))}function C(e,t,n,r,o,i,a,s){var c,u,d,p,h,m=n.props,g=t.props;if(o="svg"===t.type||o,null==e&&null!=i)for(c=0;c<i.length;c++)if(null!=(u=i[c])&&(null===t.type?3===u.nodeType:u.localName===t.type)){e=u,i[c]=null;break}if(null==e){if(null===t.type)return document.createTextNode(g);e=o?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type),i=null}if(null===t.type)null!=i&&(i[i.indexOf(e)]=null),m!==g&&(e.data=g);else if(t!==n){if(null!=i&&(i=f.slice.call(e.childNodes)),d=(m=n.props||l).dangerouslySetInnerHTML,p=g.dangerouslySetInnerHTML,!s){if(m===l)for(m={},h=0;h<e.attributes.length;h++)m[e.attributes[h].name]=e.attributes[h].value;(p||d)&&(p&&d&&p.__html==d.__html||(e.innerHTML=p&&p.__html||""))}(function(e,t,n,r,o){var i;for(i in n)i in t||O(e,i,null,n[i],r);for(i in t)o&&"function"!=typeof t[i]||"value"===i||"checked"===i||n[i]===t[i]||O(e,i,t[i],n[i],r)})(e,g,m,o,s),t.__k=t.props.children,p||T(e,t,n,r,"foreignObject"!==t.type&&o,i,a,l,s),s||("value"in g&&void 0!==g.value&&g.value!==e.value&&(e.value=null==g.value?"":g.value),"checked"in g&&void 0!==g.checked&&g.checked!==e.checked&&(e.checked=g.checked))}return e}function j(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){r.__e(e,n)}}function D(e,t,n){var o,i,a;if(r.unmount&&r.unmount(e),(o=e.ref)&&j(o,null,t),n||"function"==typeof e.type||(n=null!=(i=e.__e)),e.__e=e.__d=null,null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){r.__e(e,t)}o.base=o.__P=null}if(o=e.__k)for(a=0;a<o.length;a++)o[a]&&D(o[a],t,n);null!=i&&h(i)}function I(e,t,n){return this.constructor(e,n)}function L(e,t,n){var o,i,a;r.__&&r.__(e,t),i=(o=n===c)?null:n&&n.__k||t.__k,e=m(v,null,[e]),a=[],x(t,(o?t:n||t).__k=e,i||l,l,void 0!==t.ownerSVGElement,n&&!o?[n]:i?null:f.slice.call(t.childNodes),a,n||l,o),N(a,e)}r={__e:function(e,t){for(var n;t=t.__;)if((n=t.__c)&&!n.__)try{if(n.constructor&&null!=n.constructor.getDerivedStateFromError)n.setState(n.constructor.getDerivedStateFromError(e));else{if(null==n.componentDidCatch)continue;n.componentDidCatch(e)}return w(n.__E=n)}catch(t){e=t}throw e}},o=function(e){return null!=e&&void 0===e.constructor},y.prototype.setState=function(e,t){var n;n=this.__s!==this.state?this.__s:this.__s=p({},this.state),"function"==typeof e&&(e=e(n,this.props)),e&&p(n,e),null!=e&&this.__v&&(this.__e=!1,t&&this.__h.push(t),w(this))},y.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),w(this))},y.prototype.render=v,i=[],a="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,c=l,u=0,n.render=L,n.hydrate=function(e,t){L(e,t,c)},n.createElement=m,n.h=m,n.Fragment=v,n.createRef=function(){return{}},n.isValidElement=o,n.Component=y,n.cloneElement=function(e,t){return t=p(p({},e.props),t),arguments.length>2&&(t.children=f.slice.call(arguments,2)),g(e.type,t,t.key||e.key,t.ref||e.ref)},n.createContext=function(e){var t={},n={__c:"__cC"+u++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var r,o=this;return this.getChildContext||(r=[],this.getChildContext=function(){return t[n.__c]=o,t},this.shouldComponentUpdate=function(t){e.value!==t.value&&r.some((function(e){e.context=t.value,w(e)}))},this.sub=function(e){r.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){r.splice(r.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Consumer.contextType=n,n},n.toChildArray=E,n._e=D,n.options=r},{}],13:[function(e,t,n){var r,o,i,a=e("preact"),s=[],c=a.options.__r,u=a.options.diffed,l=a.options.__c,f=a.options.unmount;function d(e){a.options.__h&&a.options.__h(o);var t=o.__H||(o.__H={t:[],u:[]});return e>=t.t.length&&t.t.push({}),t.t[e]}function p(e,t,n){var i=d(r++);return i.__c||(i.__c=o,i.o=[n?n(t):_(void 0,t),function(t){var n=e(i.o[0],t);i.o[0]!==n&&(i.o[0]=n,i.__c.setState({}))}]),i.o}function h(e,t){var n=d(r++);b(n.i,t)&&(n.o=e,n.i=t,o.__h.push(n))}function m(e,t){var n=d(r++);return b(n.i,t)?(n.i=t,n.p=e,n.o=e()):n.o}function g(){s.some((function(e){e.__P&&(e.__H.u.forEach(v),e.__H.u.forEach(y),e.__H.u=[])})),s=[]}function v(e){e.v&&e.v()}function y(e){var t=e.o();"function"==typeof t&&(e.v=t)}function b(e,t){return!e||t.some((function(t,n){return t!==e[n]}))}function _(e,t){return"function"==typeof t?t(e):t}a.options.__r=function(e){c&&c(e),r=0,(o=e.__c).__H&&(o.__H.u.forEach(v),o.__H.u.forEach(y),o.__H.u=[])},a.options.diffed=function(e){u&&u(e);var t=e.__c;if(t){var n=t.__H;n&&n.u.length&&(1!==s.push(t)&&i===a.options.requestAnimationFrame||((i=a.options.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);"undefined"!=typeof window&&(t=requestAnimationFrame(n))})(g))}},a.options.__c=function(e,t){t.some((function(e){e.__h.forEach(v),e.__h=e.__h.filter((function(e){return!e.o||y(e)}))})),l&&l(e,t)},a.options.unmount=function(e){f&&f(e);var t=e.__c;if(t){var n=t.__H;n&&n.t.forEach((function(e){return e.v&&e.v()}))}},n.useState=function(e){return p(_,e)},n.useReducer=p,n.useEffect=function(e,t){var n=d(r++);b(n.i,t)&&(n.o=e,n.i=t,o.__H.u.push(n))},n.useLayoutEffect=h,n.useRef=function(e){return m((function(){return{current:e}}),[])},n.useImperativeHandle=function(e,t,n){h((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==n?n:n.concat(e))},n.useMemo=m,n.useCallback=function(e,t){return m((function(){return e}),t)},n.useContext=function(e){var t=o.context[e.__c];if(!t)return e.__;var n=d(r++);return null==n.o&&(n.o=!0,t.sub(o)),t.props.value},n.useDebugValue=function(e,t){a.options.useDebugValue&&a.options.useDebugValue(t?t(e):e)}},{preact:12}],14:[function(e,t,n){"use strict";var r=e("./lib/ReactPropTypesSecret");function o(){}function i(){}i.resetWarningCache=o,t.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},{"./lib/ReactPropTypesSecret":16}],15:[function(e,t,n){t.exports=e("./factoryWithThrowingShims")()},{"./factoryWithThrowingShims":14}],16:[function(e,t,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},{}],17:[function(e,t,n){"use strict";var r=e("strict-uri-encode");n.extract=function(e){return e.split("?")[1]||""},n.parse=function(e){return"string"!=typeof e?{}:(e=e.trim().replace(/^(\?|#|&)/,""))?e.split("&").reduce((function(e,t){var n=t.replace(/\+/g," ").split("="),r=n.shift(),o=n.length>0?n.join("="):void 0;return r=decodeURIComponent(r),o=void 0===o?null:decodeURIComponent(o),e.hasOwnProperty(r)?Array.isArray(e[r])?e[r].push(o):e[r]=[e[r],o]:e[r]=o,e}),{}):{}},n.stringify=function(e){return e?Object.keys(e).sort().map((function(t){var n=e[t];return void 0===n?"":null===n?t:Array.isArray(n)?n.slice().sort().map((function(e){return r(t)+"="+r(e)})).join("&"):r(t)+"="+r(n)})).filter((function(e){return e.length>0})).join("&"):""}},{"strict-uri-encode":27}],18:[function(e,t,n){"use strict";function r(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}n.__esModule=!0;var o=r();o.withExtraArgument=r,n.default=o},{}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,o=(r=e("symbol-observable"))&&"object"==typeof r&&"default"in r?r.default:r,i=function(){return Math.random().toString(36).substring(7).split("").join(".")},a={INIT:"@@redux/INIT"+i(),REPLACE:"@@redux/REPLACE"+i(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+i()}};function s(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function c(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function u(e,t){return function(){return t(e.apply(this,arguments))}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(n,!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}n.__DO_NOT_USE__ActionTypes=a,n.applyMiddleware=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},i=t.map((function(e){return e(o)}));return d({},n,{dispatch:r=p.apply(void 0,i)(n.dispatch)})}}},n.bindActionCreators=function(e,t){if("function"==typeof e)return u(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var n={};for(var r in e){var o=e[r];"function"==typeof o&&(n[r]=u(o,t))}return n},n.combineReducers=function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}var i,s=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:a.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:a.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+a.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(e){i=e}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,o={},a=0;a<s.length;a++){var u=s[a],l=n[u],f=e[u],d=l(f,t);if(void 0===d){var p=c(u,t);throw new Error(p)}o[u]=d,r=r||d!==f}return r?o:e}},n.compose=p,n.createStore=function e(t,n,r){var i;if("function"==typeof n&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof n&&void 0===r&&(r=n,n=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(e)(t,n)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var c=t,u=n,l=[],f=l,d=!1;function p(){f===l&&(f=l.slice())}function h(){if(d)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return u}function m(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(d)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return p(),f.push(e),function(){if(t){if(d)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,p();var n=f.indexOf(e);f.splice(n,1)}}}function g(e){if(!s(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(d)throw new Error("Reducers may not dispatch actions.");try{d=!0,u=c(u,e)}finally{d=!1}for(var t=l=f,n=0;n<t.length;n++)(0,t[n])();return e}return g({type:a.INIT}),(i={dispatch:g,subscribe:m,getState:h,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");c=e,g({type:a.REPLACE})}})[o]=function(){var e,t=m;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(h())}return n(),{unsubscribe:t(n)}}})[o]=function(){return this},e},i}},{"symbol-observable":28}],20:[function(e,t,n){"use strict";function r(e,t){return e===t}function o(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,o=0;o<r;o++)if(!e(t[o],n[o]))return!1;return!0}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,n=null,i=null;return function(){return o(t,n,arguments)||(i=e.apply(null,arguments)),n=arguments,i}}function a(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}function s(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=0,s=r.pop(),c=a(r),u=e.apply(void 0,[function(){return i++,s.apply(null,arguments)}].concat(n)),l=e((function(){for(var e=[],t=c.length,n=0;n<t;n++)e.push(c[n].apply(null,arguments));return u.apply(null,e)}));return l.resultFunc=s,l.dependencies=c,l.recomputations=function(){return i},l.resetRecomputations=function(){return i=0},l}}n.__esModule=!0,n.defaultMemoize=i,n.createSelectorCreator=s,n.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map((function(t){return e[t]})),(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((function(e,t,r){return e[n[r]]=t,e}),{})}))};var c=n.createSelector=s(i)},{}],21:[function(e,t,n){t.exports=e("./lib/retry")},{"./lib/retry":22}],22:[function(e,t,n){var r=e("./retry_operation");n.operation=function(e){var t=n.timeouts(e);return new r(t,{forever:e&&e.forever,unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},n.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],o=0;o<t.retries;o++)r.push(this.createTimeout(o,t));return e&&e.forever&&!r.length&&r.push(this.createTimeout(o,t)),r.sort((function(e,t){return e-t})),r},n.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,r=Math.round(n*t.minTimeout*Math.pow(t.factor,e));return Math.min(r,t.maxTimeout)},n.wrap=function(e,t,r){if(t instanceof Array&&(r=t,t=null),!r)for(var o in r=[],e)"function"==typeof e[o]&&r.push(o);for(var i=0;i<r.length;i++){var a=r[i],s=e[a];e[a]=function(r){var o=n.operation(t),i=Array.prototype.slice.call(arguments,1),a=i.pop();i.push((function(e){o.retry(e)||(e&&(arguments[0]=o.mainError()),a.apply(this,arguments))})),o.attempt((function(){r.apply(e,i)}))}.bind(e,s),e[a].options=t}}},{"./retry_operation":23}],23:[function(e,t,n){function r(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}t.exports=r,r.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts},r.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},r.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),n=this._timeouts.shift()}var r=this,o=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n);return this._options.unref&&o.unref(),!0},r.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},r.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},r.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},r.prototype.start=r.prototype.try,r.prototype.errors=function(){return this._errors},r.prototype.attempts=function(){return this._attempts},r.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var o=this._errors[r],i=o.message,a=(e[i]||0)+1;e[i]=a,a>=n&&(t=o,n=a)}return t}},{}],24:[function(e,t,n){var r="complete",o="canceled";function i(e,t,n){e.self===e?e.scrollTo(t,n):(e.scrollLeft=t,e.scrollTop=n)}function a(e){var t=e._scrollSettings;if(t){var n=t.maxSynchronousAlignments,o=function(e,t){var n,r,o,i,a,s,c,u=e.align,l=e.target.getBoundingClientRect(),f=u&&null!=u.left?u.left:.5,d=u&&null!=u.top?u.top:.5,p=u&&null!=u.leftOffset?u.leftOffset:0,h=u&&null!=u.topOffset?u.topOffset:0,m=f,g=d;if(e.isWindow(t))s=Math.min(l.width,t.innerWidth),c=Math.min(l.height,t.innerHeight),r=l.left+t.pageXOffset-t.innerWidth*m+s*m,o=l.top+t.pageYOffset-t.innerHeight*g+c*g,o-=h,i=(r-=p)-t.pageXOffset,a=o-t.pageYOffset;else{s=l.width,c=l.height,n=t.getBoundingClientRect();var v=l.left-(n.left-t.scrollLeft),y=l.top-(n.top-t.scrollTop);r=v+s*m-t.clientWidth*m,o=y+c*g-t.clientHeight*g,r=Math.max(Math.min(r,t.scrollWidth-t.clientWidth),0),o=Math.max(Math.min(o,t.scrollHeight-t.clientHeight),0),o-=h,i=(r-=p)-t.scrollLeft,a=o-t.scrollTop}return{x:r,y:o,differenceX:i,differenceY:a}}(t,e),s=Date.now()-t.startTime,c=Math.min(1/t.time*s,1);if(t.endIterations>=n)return i(e,o.x,o.y),e._scrollSettings=null,t.end(r);var u=1-t.ease(c);if(i(e,o.x-o.differenceX*u,o.y-o.differenceY*u),s>=t.time)return t.endIterations++,a(e);!function(e){if("requestAnimationFrame"in window)return window.requestAnimationFrame(e);setTimeout(e,16)}(a.bind(null,e))}}function s(e){return e.self===e}function c(e,t,n,r){var i,c=!t._scrollSettings,u=t._scrollSettings,l=Date.now(),f={passive:!0};function d(e){t._scrollSettings=null,t.parentElement&&t.parentElement._scrollSettings&&t.parentElement._scrollSettings.end(e),n.debug&&console.log("Scrolling ended with type",e,"for",t),r(e),i&&(t.removeEventListener("touchstart",i,f),t.removeEventListener("wheel",i,f))}u&&u.end(o);var p=n.maxSynchronousAlignments;null==p&&(p=3),t._scrollSettings={startTime:u?u.startTime:Date.now(),endIterations:0,target:e,time:n.time+(u?l-u.startTime:0),ease:n.ease,align:n.align,isWindow:n.isWindow||s,maxSynchronousAlignments:p,end:d},"cancellable"in n&&!n.cancellable||(i=d.bind(null,o),t.addEventListener("touchstart",i,f),t.addEventListener("wheel",i,f)),c&&a(t)}function u(e){return"pageXOffset"in e||(e.scrollHeight!==e.clientHeight||e.scrollWidth!==e.clientWidth)&&"hidden"!==getComputedStyle(e).overflow}function l(){return!0}t.exports=function(e,t,n){if(e){"function"==typeof t&&(n=t,t=null),t||(t={}),t.time=isNaN(t.time)?1e3:t.time,t.ease=t.ease||function(e){return 1-Math.pow(1-e,e/2)};var o=e.parentElement,i=1,a=t.validTarget||l,s=t.isScrollable;for(t.debug&&(console.log("About to scroll to",e),o||console.error("Target did not have a parent, is it mounted in the DOM?"));o;)if("BODY"===o.tagName&&(o=(o=o.ownerDocument).defaultView||o.ownerWindow),t.debug&&console.log("Scrolling parent node",o),a(o,i)&&(s?s(o,u):u(o))&&(i++,c(e,o,t,f)),!(o=o.parentElement)){f(r);break}}function f(e){--i||n&&n(e)}}},{}],25:[function(e,t,n){(function(e){!function(){"use strict";var r=function e(t){var n,r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element"),o=60103,i={use_static:!1};function a(e){var t=Object.getPrototypeOf(e);return t?Object.create(t):{}}function s(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!1,value:n})}function c(e,t){s(e,t,(function(){throw new v("The "+t+" method cannot be invoked on an Immutable data structure.")}))}"object"!=typeof(n=t)||Array.isArray(n)||null===n||void 0!==t.use_static&&(i.use_static=Boolean(t.use_static));var u="__immutable_invariants_hold";function l(e){return"object"!=typeof e||null===e||Boolean(Object.getOwnPropertyDescriptor(e,u))}function f(e,t){return e===t||e!=e&&t!=t}function d(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Date)}var p=["setPrototypeOf"],h=p.concat(["push","pop","sort","splice","shift","unshift","reverse"]),m=["keys"].concat(["map","filter","slice","concat","reduce","reduceRight"]),g=p.concat(["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]);function v(e){this.name="MyError",this.message=e,this.stack=(new Error).stack}function y(e,t){for(var n in s(e,u,!0),t)t.hasOwnProperty(n)&&c(e,t[n]);return Object.freeze(e),e}function b(e,t){var n=e[t];s(e,t,(function(){return V(n.apply(e,arguments))}))}function _(e,t,n){var r=n&&n.deep;if(e in this&&(r&&this[e]!==t&&d(t)&&d(this[e])&&(t=V.merge(this[e],t,{deep:!0,mode:"replace"})),f(this[e],t)))return this;var o=k.call(this);return o[e]=V(t),T(o)}v.prototype=new Error,v.prototype.constructor=Error;var w=V([]);function A(e,t,n){var r=e[0];if(1===e.length)return _.call(this,r,t,n);var o,i=e.slice(1),a=this[r];if("object"==typeof a&&null!==a)o=V.setIn(a,i,t);else{var s=i[0];o=""!==s&&isFinite(s)?A.call(w,i,t):F.call(R,i,t)}if(r in this&&a===o)return this;var c=k.call(this);return c[r]=o,T(c)}function T(e){for(var t in m)m.hasOwnProperty(t)&&b(e,m[t]);i.use_static||(s(e,"flatMap",S),s(e,"asObject",x),s(e,"asMutable",k),s(e,"set",_),s(e,"setIn",A),s(e,"update",M),s(e,"updateIn",H),s(e,"getIn",$));for(var n=0,r=e.length;n<r;n++)e[n]=V(e[n]);return y(e,h)}function E(){return new Date(this.getTime())}function S(e){if(0===arguments.length)return this;var t,n=[],r=this.length;for(t=0;t<r;t++){var o=e(this[t],t,this);Array.isArray(o)?n.push.apply(n,o):n.push(o)}return T(n)}function O(e){if(void 0===e&&0===arguments.length)return this;if("function"!=typeof e){var t=Array.isArray(e)?e.slice():Array.prototype.slice.call(arguments);t.forEach((function(e,t,n){"number"==typeof e&&(n[t]=e.toString())})),e=function(e,n){return-1!==t.indexOf(n)}}var n=a(this);for(var r in this)this.hasOwnProperty(r)&&!1===e(this[r],r)&&(n[r]=this[r]);return z(n)}function k(e){var t,n,r=[];if(e&&e.deep)for(t=0,n=this.length;t<n;t++)r.push(N(this[t]));else for(t=0,n=this.length;t<n;t++)r.push(this[t]);return r}function x(e){"function"!=typeof e&&(e=function(e){return e});var t,n={},r=this.length;for(t=0;t<r;t++){var o=e(this[t],t,this),i=o[0],a=o[1];n[i]=a}return z(n)}function N(e){return!e||"object"!=typeof e||!Object.getOwnPropertyDescriptor(e,u)||e instanceof Date?e:V.asMutable(e,{deep:!0})}function C(e,t){for(var n in e)Object.getOwnPropertyDescriptor(e,n)&&(t[n]=e[n]);return t}function j(e,t){if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#merge can only be invoked with objects or arrays, not "+JSON.stringify(e));var n,r,o=Array.isArray(e),i=t&&t.deep,s=t&&t.mode||"merge",c=t&&t.merger;function u(e,r,o){var s,u=V(r[o]),l=c&&c(e[o],u,t),p=e[o];void 0===n&&void 0===l&&e.hasOwnProperty(o)&&f(u,p)||f(p,s=void 0!==l?l:i&&d(p)&&d(u)?V.merge(p,u,t):u)&&e.hasOwnProperty(o)||(void 0===n&&(n=C(e,a(e))),n[o]=s)}if(o)for(var l=0,p=e.length;l<p;l++){var h=e[l];for(r in h)h.hasOwnProperty(r)&&u(void 0!==n?n:this,h,r)}else{for(r in e)Object.getOwnPropertyDescriptor(e,r)&&u(this,e,r);"replace"===s&&function(e,t){for(var r in e)t.hasOwnProperty(r)||(void 0===n&&(n=C(e,a(e))),delete n[r])}(this,e)}return void 0===n?this:z(n)}function D(e,t){var n=t&&t.deep;if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#replace can only be invoked with objects or arrays, not "+JSON.stringify(e));return V.merge(this,e,{deep:n,mode:"replace"})}var I,L,P,R=V({});function F(e,t,n){if(!Array.isArray(e)||0===e.length)throw new TypeError('The first argument to Immutable#setIn must be an array containing at least one "key" string.');var r=e[0];if(1===e.length)return U.call(this,r,t,n);var o,i=e.slice(1),s=this[r];if(o=this.hasOwnProperty(r)&&"object"==typeof s&&null!==s?V.setIn(s,i,t):F.call(R,i,t),this.hasOwnProperty(r)&&s===o)return this;var c=C(this,a(this));return c[r]=o,z(c)}function U(e,t,n){var r=n&&n.deep;if(this.hasOwnProperty(e)&&(r&&this[e]!==t&&d(t)&&d(this[e])&&(t=V.merge(this[e],t,{deep:!0,mode:"replace"})),f(this[e],t)))return this;var o=C(this,a(this));return o[e]=V(t),z(o)}function M(e,t){var n=Array.prototype.slice.call(arguments,2),r=this[e];return V.set(this,e,t.apply(r,[r].concat(n)))}function B(e,t){for(var n=0,r=t.length;null!=e&&n<r;n++)e=e[t[n]];return n&&n==r?e:void 0}function H(e,t){var n=Array.prototype.slice.call(arguments,2),r=B(this,e);return V.setIn(this,e,t.apply(r,[r].concat(n)))}function $(e,t){var n=B(this,e);return void 0===n?t:n}function q(e){var t,n=a(this);if(e&&e.deep)for(t in this)this.hasOwnProperty(t)&&(n[t]=N(this[t]));else for(t in this)this.hasOwnProperty(t)&&(n[t]=this[t]);return n}function G(){return{}}function z(e){return i.use_static||(s(e,"merge",j),s(e,"replace",D),s(e,"without",O),s(e,"asMutable",q),s(e,"set",U),s(e,"setIn",F),s(e,"update",M),s(e,"updateIn",H),s(e,"getIn",$)),y(e,p)}function V(e,t,n){if(l(e)||function(e){return"object"==typeof e&&null!==e&&(e.$$typeof===o||e.$$typeof===r)}(e)||function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)||function(e){return e instanceof Error}(e))return e;if(function(e){return"object"==typeof e&&"function"==typeof e.then}(e))return e.then(V);if(Array.isArray(e))return T(e.slice());if(e instanceof Date)return a=new Date(e.getTime()),i.use_static||s(a,"asMutable",E),y(a,g);var a,c=t&&t.prototype,u=(c&&c!==Object.prototype?function(){return Object.create(c)}:G)();if(null==n&&(n=64),n<=0)throw new v("Attempt to construct Immutable from a deeply nested object was detected. Have you tried to wrap an object with circular references (e.g. React element)? See https://github.com/rtfeldman/seamless-immutable/wiki/Deeply-nested-object-was-detected for details.");for(var f in n-=1,e)Object.getOwnPropertyDescriptor(e,f)&&(u[f]=V(e[f],void 0,n));return z(u)}function W(e){return function(){var t=[].slice.call(arguments),n=t.shift();return e.apply(n,t)}}function K(e,t){return function(){var n=[].slice.call(arguments),r=n.shift();return Array.isArray(r)?t.apply(r,n):e.apply(r,n)}}return V.from=V,V.isImmutable=l,V.ImmutableError=v,V.merge=W(j),V.replace=W(D),V.without=W(O),V.asMutable=(I=q,L=k,P=E,function(){var e=[].slice.call(arguments),t=e.shift();return Array.isArray(t)?L.apply(t,e):t instanceof Date?P.apply(t,e):I.apply(t,e)}),V.set=K(U,_),V.setIn=K(F,A),V.update=W(M),V.updateIn=W(H),V.getIn=W($),V.flatMap=W(S),V.asObject=W(x),i.use_static||(V.static=e({use_static:!0})),Object.freeze(V),V}();"function"==typeof define&&define.amd?define((function(){return r})):"object"==typeof t?t.exports=r:"object"==typeof n?n.Immutable=r:"object"==typeof window?window.Immutable=r:"object"==typeof e&&(e.Immutable=r)}()}).call(this,window)},{}],26:[function(e,t,n){t.exports=function(e,t,n,r){var o=n?n.call(r,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),c=0;c<i.length;c++){var u=i[c];if(!s(u))return!1;var l=e[u],f=t[u];if(!1===(o=n?n.call(r,l,f,u):void 0)||void 0===o&&l!==f)return!1}return!0}},{}],27:[function(e,t,n){"use strict";t.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},{}],28:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i,a=e("./ponyfill.js"),s=(i=a)&&i.__esModule?i:{default:i};o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:void 0!==t?t:Function("return this")();var c=(0,s.default)(o);n.default=c}).call(this,window)},{"./ponyfill.js":29}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}},{}],30:[function(e,t,n){function r(){}r.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},t.exports=r,t.exports.TinyEmitter=r},{}],31:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--plus"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8V3v5H3h5zm0 0v5-5h5-5z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>'},{}],32:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M15 0c.27 0 .505.099.703.297A.961.961 0 0116 1v15l-4-3H1a.974.974 0 01-.703-.29A.953.953 0 010 12V1C0 .719.096.482.29.29A.966.966 0 011 0h14zM7 3l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C4.156 5.229 4 6 4 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188C4.729 8.854 5.082 9 5.5 9c.417 0 .77-.146 1.063-.438C6.854 8.271 7 7.918 7 7.5c0-.417-.146-.77-.438-1.063A1.447 1.447 0 005.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L7 4V3zm5 0l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C9.156 5.229 9 6 9 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188c.291.291.645.437 1.062.437.417 0 .77-.146 1.063-.438.291-.291.437-.645.437-1.062 0-.417-.146-.77-.438-1.063A1.447 1.447 0 0010.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L12 4V3z"/>\n</svg>\n'},{}],33:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--arrow-left"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12L3 8l4-4M4 8h9-9z"></path></g></svg>\n'},{}],34:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--arrow-right"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 4l4 4-4 4m3-4H3h9z"></path></g></svg>\n'},{}],35:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cancel"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8l3.536-3.536L8 8 4.464 4.464 8 8zm0 0l-3.536 3.536L8 8l3.536 3.536L8 8z"></path></g></svg>\n'},{}],36:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cc-std"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M7.985 0c2.238 0 4.143.781 5.715 2.343a7.694 7.694 0 011.714 2.579C15.804 5.888 16 6.914 16 8a8.164 8.164 0 01-.579 3.078 7.344 7.344 0 01-1.707 2.536 8.222 8.222 0 01-2.657 1.772c-.99.41-2.014.614-3.071.614a7.775 7.775 0 01-3.036-.607 8.047 8.047 0 01-2.6-1.757A7.846 7.846 0 010 8c0-1.057.202-2.074.607-3.05A8.033 8.033 0 012.371 2.33C3.895.777 5.766 0 7.985 0zm.03 1.443c-1.83 0-3.367.638-4.615 1.914a6.878 6.878 0 00-1.45 2.15A6.301 6.301 0 001.443 8c0 .858.168 1.684.507 2.479a6.627 6.627 0 001.45 2.129 6.593 6.593 0 002.129 1.428c.79.329 1.619.493 2.485.493.857 0 1.688-.166 2.494-.5a6.91 6.91 0 002.178-1.442c1.247-1.22 1.871-2.748 1.871-4.586a6.57 6.57 0 00-.486-2.515 6.397 6.397 0 00-1.413-2.114C11.37 2.086 9.824 1.443 8.014 1.443zm-.1 5.229l-1.073.557c-.114-.238-.254-.405-.42-.5a.95.95 0 00-.465-.143c-.714 0-1.072.472-1.072 1.415 0 .428.09.77.271 1.028.181.257.448.386.8.386.467 0 .796-.229.987-.686l.985.5a2.35 2.35 0 01-2.1 1.257c-.714 0-1.29-.218-1.729-.657-.438-.438-.657-1.047-.657-1.828 0-.762.222-1.367.665-1.814.442-.448 1.002-.672 1.678-.672.991 0 1.7.385 2.13 1.157zm4.613 0l-1.057.557c-.114-.238-.255-.405-.421-.5a.972.972 0 00-.479-.143c-.714 0-1.072.472-1.072 1.415 0 .428.091.77.272 1.028.18.257.447.386.8.386.466 0 .795-.229.985-.686l1 .5c-.218.39-.514.698-.885.922a2.308 2.308 0 01-1.214.335c-.724 0-1.302-.218-1.735-.657-.434-.438-.65-1.047-.65-1.828 0-.762.22-1.367.664-1.814.442-.448 1.002-.672 1.678-.672.99 0 1.696.385 2.114 1.157z"></path></g></svg>\n'},{}],37:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cc-zero"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M7.983 0c2.238 0 4.148.78 5.72 2.342a7.662 7.662 0 011.715 2.582c.39.962.582 1.99.582 3.076a8.13 8.13 0 01-.583 3.087 7.262 7.262 0 01-1.703 2.526 8.213 8.213 0 01-2.655 1.77c-.99.41-2.018.617-3.076.617a7.902 7.902 0 01-3.042-.6 8.301 8.301 0 01-2.6-1.759A8.087 8.087 0 01.6 11.042 7.84 7.84 0 010 8c0-1.057.2-2.07.6-3.042a8.12 8.12 0 011.77-2.633C3.893.772 5.764 0 7.983 0zm.034 1.44c-1.829 0-3.369.64-4.616 1.915a6.962 6.962 0 00-1.457 2.157 6.388 6.388 0 000 4.969 6.83 6.83 0 003.585 3.558c.79.324 1.62.487 2.488.487.857 0 1.681-.165 2.482-.498a6.88 6.88 0 002.184-1.446C13.931 11.364 14.56 9.838 14.56 8a6.57 6.57 0 00-.487-2.515 6.418 6.418 0 00-1.418-2.118C11.37 2.081 9.826 1.44 8.017 1.44zM8 3.395c2.641 0 3.305 2.492 3.305 4.605 0 2.113-.664 4.605-3.305 4.605S4.694 10.113 4.694 8l.007-.355c.073-2.027.804-4.25 3.299-4.25zm1.316 3.227L7.35 10.017c-.274.412-.083.645.219.774l.135.044c.091.022.19.034.297.034 1.357 0 1.422-1.938 1.422-2.869l-.007-.409a7.282 7.282 0 00-.06-.72l-.04-.25zM8 5.132c-1.258 0-1.406 1.66-1.421 2.646L6.577 8c0 .24.005.544.035.865l.027.244 1.759-3.232c.182-.316.09-.542-.101-.706A1.222 1.222 0 008 5.13z"></path></g></svg>\n'},{}],38:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M7.456 4.212a.804.804 0 0 1 1.088 0l6.23 5.867c.301.283.301.742 0 1.025l-.726.684a.804.804 0 0 1-1.087.001L8 7.139l-4.961 4.65a.804.804 0 0 1-1.087-.001l-.727-.684a.695.695 0 0 1 0-1.025l6.23-5.867z"/>\n</svg>'},{}],39:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--copy"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 15H1V5h3m11-4v10H7V1h8z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>'},{}],40:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="10px" height="30px" viewBox="0 0 10 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    \x3c!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --\x3e\n    <title>Shape</title>\n    <desc>Created with Sketch.</desc>\n    <defs></defs>\n    <g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="Start-annotating---eLife" transform="translate(-239.000000, -73.000000)" fill-rule="nonzero" fill="#000000">\n            <g id="Group-10" transform="translate(1.000000, 1.000000)">\n                <path d="M243.3125,75.186875 C243.3125,73.535 243.3125,72.625 246.434687,72.625 L248,72.625 L248,72 L246.434687,72 C244.324375,72 243.402813,72.4684375 243,73.183125 C242.597187,72.4684375 241.675625,72 239.565313,72 L238,72 L238,72.625 L239.565313,72.625 C242.6875,72.6246875 242.6875,73.5346875 242.6875,75.186875 L242.6875,82 L242.6875,86.6875 L240.929375,86.6875 L240.929375,87.3125 L242.6875,87.3125 L242.6875,92 L242.6875,98.5434375 C242.6875,100.187188 242.6875,101.375 239.565313,101.375 L238,101.375 L238,102 L239.565313,102 C241.675625,102 242.5975,101.442813 243,100.6525 C243.402813,101.442813 244.324375,102 246.434687,102 L248,102 L248,101.375 L246.434687,101.375 C243.3125,101.374688 243.3125,100.187188 243.3125,98.5434375 L243.3125,91.9996875 L243.3125,87.3121875 L245.070312,87.3121875 L245.070312,86.6871875 L243.3125,86.6871875 L243.3125,81.9996875 L243.3125,75.186875 Z" id="Shape"></path>\n            </g>\n        </g>\n    </g>\n</svg>'},{}],41:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--edit"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4l1 1-9 9-2 1 1-2 9-9zm3-3l1 1-1 1-1-1 1-1z"></path></g></svg>\n'},{}],42:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--email"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 3v10h14V3H1zm0 0l7 6 7-6H1z"></path></g></svg>\n'},{}],43:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M7.456 11.788L1.226 5.92a.695.695 0 0 1 0-1.025l.726-.684a.804.804 0 0 1 1.087-.001L8 8.861l4.961-4.65a.804.804 0 0 1 1.087.001l.727.684c.3.283.3.742 0 1.025l-6.23 5.867a.804.804 0 0 1-1.09 0z"/>\n</svg>'},{}],44:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--external"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 3h6v6m-1-5l-9 9 9-9z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>'},{}],45:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--social-facebook"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M15.999 8.049c0-4.445-3.582-8.049-8-8.049S0 3.604 0 8.049C0 12.066 2.925 15.396 6.75 16v-5.624H4.717V8.049H6.75V6.276c0-2.018 1.195-3.132 3.022-3.132.875 0 1.79.157 1.79.157v1.981h-1.008c-.994 0-1.304.62-1.304 1.257v1.51h2.219l-.355 2.327H9.25V16c3.825-.604 6.75-3.934 6.75-7.951z"></path></g></svg>\n'},{}],46:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--flag-filled"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M2 1a1 1 0 01.883-.993L3 0h12c.852 0 1.297.986.783 1.623l-.076.084L12.415 5l3.292 3.293c.575.575.253 1.523-.485 1.684l-.108.017L15 10H4v5a1 1 0 01-1.993.117L2 15V1z"></path></g></svg>\n'},{}],47:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--flag"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9v6V1h12l-4 4 4 4H3z"></path></g></svg>\n'},{}],48:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-type-bold"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M8.661 16c.805 0 1.536-.117 2.193-.351a4.953 4.953 0 001.69-.993c.47-.428.831-.947 1.081-1.557s.375-1.287.375-2.03c0-.29-.038-.588-.114-.893a4.123 4.123 0 00-.325-.87 3.937 3.937 0 00-.495-.754 4.412 4.412 0 00-.604-.597c-.17-.126-.17-.264 0-.412.381-.335.699-.772.953-1.311.254-.54.382-1.062.382-1.568 0-.64-.132-1.244-.394-1.813a4.628 4.628 0 00-1.081-1.484c-.458-.42-1-.753-1.627-.999A5.531 5.531 0 008.66 0h-6.14a.534.534 0 00-.362.14A.415.415 0 002 .456v15.086c0 .119.053.225.159.318.106.093.227.139.362.139h6.14zm-.127-9.852H5.826c-.17 0-.254-.075-.254-.223V3.437c0-.157.085-.235.254-.235h2.708c.45 0 .847.145 1.195.435.347.29.521.633.521 1.027 0 .394-.174.74-.521 1.038a1.784 1.784 0 01-1.195.446zm0 6.65H5.826c-.17 0-.254-.075-.254-.223v-2.99c0-.157.085-.235.254-.235h2.708c.56 0 1.004.177 1.335.53.33.353.495.75.495 1.188 0 .454-.165.856-.495 1.205-.33.35-.776.525-1.335.525z"></path></g></svg>\n'},{}],49:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-latex"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M13.392 16c.158 0 .299-.036.423-.108.123-.073.185-.155.185-.248v-1.778c0-.099-.062-.183-.185-.252a.848.848 0 00-.423-.104H6.85c-.138 0-.227-.028-.267-.083-.04-.055-.04-.105 0-.152l5.533-5.101c.158-.14.223-.265.193-.378a.755.755 0 00-.193-.325L6.88 2.707c-.04-.046-.042-.094-.007-.143.034-.05.13-.074.289-.074h6.17a.782.782 0 00.416-.108c.119-.073.178-.155.178-.248V.356c0-.093-.06-.175-.178-.248A.782.782 0 0013.333 0H2.905c-.158 0-.3.036-.423.108-.124.073-.185.155-.185.248v1.943c0 .128.037.236.11.326l.171.204 5.31 4.815c.04.047.065.106.075.178a.221.221 0 01-.074.195l-5.622 5.154c-.04.047-.094.113-.163.2A.512.512 0 002 13.7v1.943c0 .093.062.175.185.248a.822.822 0 00.423.108h10.784z"></path></g></svg>\n'},{}],50:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-type-italic"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M10.61 16c.12 0 .23-.046.329-.14a.633.633 0 00.191-.317l.457-2.176a.348.348 0 00-.064-.313.336.336 0 00-.276-.133H8.845c-.142-.008-.198-.086-.17-.235l1.892-9.372c.035-.149.124-.223.266-.223H13a.49.49 0 00.335-.14.62.62 0 00.196-.318L13.99.457a.542.542 0 00.011-.1.337.337 0 00-.085-.223.336.336 0 00-.276-.134H5.805a.49.49 0 00-.335.14.62.62 0 00-.196.317l-.457 2.176a.353.353 0 00.069.318c.074.093.168.14.281.14h2.18c.141 0 .198.074.17.223l-1.893 9.372c-.028.156-.113.235-.255.235H2.967a.489.489 0 00-.324.133.59.59 0 00-.197.313l-.435 2.176a.542.542 0 00-.011.1c0 .082.025.156.074.223.071.09.16.134.266.134h8.27z"></path></g></svg>\n'},{}],51:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--list-ordered"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M2.748 11.5c.227 0 .443.034.646.103.203.069.381.164.534.286.155.123.276.267.364.432.089.168.134.35.134.543 0 .17-.042.333-.124.484a1.384 1.384 0 01-.19.269l-.062.061.047.035c.047.041.09.086.13.134l.058.075.075.122c.093.172.14.352.14.538 0 .201-.048.39-.143.566a1.44 1.44 0 01-.384.45c-.16.125-.344.223-.554.294-.21.072-.434.108-.67.108-.237 0-.461-.036-.671-.108a1.871 1.871 0 01-.555-.295 1.42 1.42 0 01-.382-.45 1.178 1.178 0 01-.132-.417L1 14.582l.002-.078.01-.05a.249.249 0 01.077-.111.283.283 0 01.121-.06l.07-.008h.708l.05.007c.044.01.084.028.12.056a.24.24 0 01.089.133l.006.054v.047l.005.077a.279.279 0 00.112.186c.088.066.213.101.378.101a.615.615 0 00.376-.102.29.29 0 00.12-.252.29.29 0 00-.12-.252.538.538 0 00-.262-.096l-.114-.007h-.1l-.051-.007a.292.292 0 01-.12-.059.244.244 0 01-.087-.13l-.006-.053.001-.57.01-.05a.249.249 0 01.078-.112.283.283 0 01.121-.06l.07-.008h.076l.112-.006a.454.454 0 00.224-.086.26.26 0 00.104-.222.246.246 0 00-.103-.213.533.533 0 00-.329-.09.527.527 0 00-.324.09.24.24 0 00-.098.148l-.006.065-.002.11-.01.05a.249.249 0 01-.081.112.292.292 0 01-.12.059l-.066.007h-.712l-.052-.007a.292.292 0 01-.12-.059.244.244 0 01-.087-.13l-.006-.054v-.096l.008-.135c.018-.141.062-.275.132-.402.091-.164.213-.307.366-.43.152-.122.33-.217.533-.286.203-.069.418-.103.645-.103zM15 13a1 1 0 01.117 1.993L15 15H7a1 1 0 01-.117-1.993L7 13h8zM2.777 5.5c.234 0 .454.034.66.101.207.068.389.164.544.288.156.124.28.27.372.437.093.17.14.355.14.551 0 .19-.049.37-.145.542-.07.123-.156.237-.258.34l-.108.1L2.71 8.932l1.52.001.053.006c.044.01.084.029.12.056.047.036.078.08.091.132l.007.054-.002.59-.01.05a.25.25 0 01-.083.113.298.298 0 01-.121.059L4.216 10H1.27l-.053-.007a.298.298 0 01-.122-.059.246.246 0 01-.089-.132L1 9.748v-.711l.004-.05a.26.26 0 01.04-.115l.034-.043.035-.033L3.04 7.167l.036-.036a.98.98 0 00.08-.114.295.295 0 00.055-.145.27.27 0 00-.099-.21c-.068-.062-.167-.094-.303-.094-.163 0-.285.032-.369.093a.244.244 0 00-.103.147l-.006.064-.002.123-.01.052a.25.25 0 01-.084.112.298.298 0 01-.12.058l-.069.008h-.726l-.053-.007a.298.298 0 01-.121-.059.246.246 0 01-.09-.132l-.006-.054V6.87l.01-.137c.017-.143.063-.28.135-.407.094-.167.22-.313.379-.437.157-.123.339-.219.544-.287.206-.067.425-.101.658-.101zM15 7a1 1 0 01.117 1.993L15 9H7a1 1 0 01-.117-1.993L7 7h8zM3.237 0l.052.008c.044.01.084.031.12.061a.248.248 0 01.083.132l.006.052-.004 3.167.744.001.051.007c.044.01.084.03.119.058.044.036.074.08.086.132l.006.053-.001.595-.01.05a.278.278 0 01-.197.176l-.07.008H1.29l-.051-.008a.287.287 0 01-.12-.061.248.248 0 01-.084-.132l-.006-.052.001-.596.01-.05a.247.247 0 01.077-.113.28.28 0 01.12-.06l.069-.008.932.002.003-1.959-.796.629-.068.037a.295.295 0 01-.196-.002.25.25 0 01-.172-.179L1 1.881v-.587l.007-.089.015-.075a.345.345 0 01.073-.132l.06-.059.83-.758.04-.036A.994.994 0 012.139.07a.498.498 0 01.183-.062L2.428 0h.809zM15 1a1 1 0 01.117 1.993L15 3H7a1 1 0 01-.117-1.993L7 1h8z"></path></g></svg>\n'},{}],52:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--list-unordered"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M15 1a1 1 0 01.117 1.993L15 3H7a1 1 0 01-.117-1.993L7 1h8zm0 6a1 1 0 01.117 1.993L15 9H7a1 1 0 01-.117-1.993L7 7h8zM2 12a2 2 0 110 4 2 2 0 010-4zm13 1a1 1 0 01.117 1.993L15 15H7a1 1 0 01-.117-1.993L7 13h8zM2 6a2 2 0 110 4 2 2 0 010-4zm0-6a2 2 0 110 4 2 2 0 010-4z"></path></g></svg>\n'},{}],53:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--editor-quote"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M2.701 14c.38 0 .659-.085.837-.255.177-.17.328-.343.45-.52l2.408-3.25c.246-.328.445-.725.598-1.19a4.69 4.69 0 00.23-1.475V2.775a.752.752 0 00-.23-.539A.713.713 0 006.47 2H1.947a.713.713 0 00-.524.236.752.752 0 00-.23.539v4.649c0 .214.077.396.23.548a.726.726 0 00.524.226h.901c.123 0 .23.054.322.161.092.107.101.224.028.35l-2.041 3.817c-.196.365-.208.702-.037 1.011.172.309.447.463.827.463h.754zm7.795 0c.367 0 .64-.085.818-.255.178-.17.328-.343.45-.52l2.409-3.25c.257-.328.46-.725.606-1.19A4.87 4.87 0 0015 7.31V2.775a.752.752 0 00-.23-.539.713.713 0 00-.524-.236H9.742a.703.703 0 00-.533.236.767.767 0 00-.22.539v4.649c0 .214.076.396.23.548a.726.726 0 00.523.226h.9c.123 0 .228.054.313.161.086.107.092.224.019.35L8.95 12.526c-.208.365-.223.702-.045 1.011.177.309.456.463.836.463h.754z"></path></g></svg>\n'},{}],54:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--groups"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 15a3 3 0 0 1 6 0m2-4a3 3 0 0 1 6 0M4 9a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm8-4a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>\n'},{}],55:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--help"><g fill-rule="evenodd"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4c0-1.657 1.79-3 4-3s4 1.343 4 3-1.79 3-4 3m0 0v2-2zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"></path><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect></g></svg>\n'},{}],56:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M16 13.344V16H0v-2.656h16zM9.328 2.172l2.5 2.5-6.656 6.672h-2.5v-2.5l6.656-6.672zM11.773 0c.146 0 .277.043.393.13l.084.073 1.547 1.563a.603.603 0 01.203.46.639.639 0 01-.13.393l-.073.084L12.5 4 10 1.5 11.297.203A.652.652 0 0111.773 0z"/>\n</svg>\n'},{}],57:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--image"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 1v14H1V1h14zM1 15l3-8 4 6 3-4 4 6m-4-9a1 1 0 110-2 1 1 0 010 2z"></path></g></svg>\n'},{}],58:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M8 0c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm0 14.452A6.45 6.45 0 0 0 14.452 8 6.45 6.45 0 0 0 8 1.548 6.45 6.45 0 0 0 1.548 8 6.45 6.45 0 0 0 8 14.452zm3.284-8.458L9.277 8l2.007 2.006a.387.387 0 0 1 0 .549l-.73.729a.387.387 0 0 1-.548 0L8 9.277l-2.006 2.007a.387.387 0 0 1-.549 0l-.729-.73a.387.387 0 0 1 0-.548L6.723 8 4.716 5.994a.387.387 0 0 1 0-.549l.73-.729a.387.387 0 0 1 .548 0L8 6.723l2.006-2.007a.387.387 0 0 1 .549 0l.729.73a.387.387 0 0 1 0 .548z"/>\n</svg>'},{}],59:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--link"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.069 3.042l1.057-1.274c1.193-1.106 3.035-.938 4.046 0 1.012.94 1.193 2.649 0 3.755L11.046 9.17m0 0c-1.193 1.107-2.853 1.107-4.046 0m-.069 3.788l-1.057 1.274c-1.193 1.106-3.035.938-4.046 0-1.012-.94-1.193-2.649 0-3.755L4.954 6.83m0 0C6.147 5.723 7.807 5.723 9 6.8"></path></g></svg>\n'},{}],60:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="48px" height="56px" viewBox="0 0 48 56" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    \x3c!-- Generator: Sketch 3.6.1 (26313) - http://www.bohemiancoding.com/sketch --\x3e\n    <title>Only me</title>\n    <desc>Created with Sketch.</desc>\n    <defs></defs>\n    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="Group-4-Copy-3" fill="currentColor">\n            <rect id="Rectangle-34" x="0" y="24" width="48" height="32"></rect>\n            <path d="M24,0 C24,0 8,0 8,16 L8,32 L16,32 L16,16.0000004 C16,8 24,8 24,8 C24,8 32,8 32,16 L32,32 L40,32 L40,16 C40,0 24,0 24,0 Z" id="Path-52"></path>\n        </g>\n    </g>\n</svg>\n'},{}],61:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="24px" height="28px" viewBox="0 0 24 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <rect fill="#ffffff" stroke="none" width="17.14407" height="16.046612" x="3.8855932" y="3.9449153" />\n    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <path d="M0,2.00494659 C0,0.897645164 0.897026226,0 2.00494659,0 L21.9950534,0 C23.1023548,0 24,0.897026226 24,2.00494659 L24,21.9950534 C24,23.1023548 23.1029738,24 21.9950534,24 L2.00494659,24 C0.897645164,24 0,23.1029738 0,21.9950534 L0,2.00494659 Z M9,24 L12,28 L15,24 L9,24 Z M7.00811294,4 L4,4 L4,20 L7.00811294,20 L7.00811294,15.0028975 C7.00811294,12.004636 8.16824717,12.0097227 9,12 C10,12.0072451 11.0189302,12.0606714 11.0189302,14.003477 L11.0189302,20 L14.0270431,20 L14.0270431,13.1087862 C14.0270433,10 12,9.00309038 10,9.00309064 C8.01081726,9.00309091 8,9.00309086 7.00811294,11.0019317 L7.00811294,4 Z M19,19.9869002 C20.1045695,19.9869002 21,19.0944022 21,17.9934501 C21,16.892498 20.1045695,16 19,16 C17.8954305,16 17,16.892498 17,17.9934501 C17,19.0944022 17.8954305,19.9869002 19,19.9869002 Z" id="Rectangle-2-Copy-17" fill="currentColor"></path>\n    </g>\n</svg>\n'},{}],62:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="15" height="8" viewBox="0 0 15 8" aria-hidden="true" focusable="false"><path d="M0 8 L7 0 L15 8" stroke="currentColor" strokeWidth="2" /></svg>\n'},{}],63:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--profile"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 15c0-2.761 3.134-5 7-5s7 2.239 7 5M8 7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"></path></g></svg>\n'},{}],64:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm2.655 11.535c.244-.242.442-.719.442-1.063a1.13 1.13 0 0 0-.288-.696l-.442-.442a1.033 1.033 0 0 0-.73-.302H7.484C7.181 8.88 6.791 8 6.452 8c-.34 0-.674-.08-.978-.231l-.357-.179a.386.386 0 0 1-.213-.345c0-.153.118-.317.263-.366l1.006-.335a.618.618 0 0 1 .163-.026c.106 0 .258.056.338.126l.3.26c.046.04.106.063.169.063h.182a.258.258 0 0 0 .23-.373l-.503-1.006a.306.306 0 0 1-.027-.116c0-.06.035-.143.078-.185l.32-.31a.258.258 0 0 1 .18-.074h.29c.06 0 .141-.034.183-.076l.258-.258c.1-.1.1-.264 0-.364l-.151-.152c-.101-.1-.101-.264 0-.365l.333-.333.151-.151a.516.516 0 0 0 0-.73l-.912-.913a6.45 6.45 0 0 0-.787.078v.365a.516.516 0 0 1-.747.461l-.775-.387a6.487 6.487 0 0 0-3.329 3.287c.32.474.813 1.205 1.116 1.65.138.203.4.503.582.668l.026.023c.308.278.65.516 1.021.702.452.227 1.111.586 1.575.842.328.182.53.527.53.903v1.032c0 .274.11.537.303.73.484.484.785 1.246.73 1.653v.884c.473 0 .932-.055 1.376-.152l.56-1.511c.067-.177.106-.362.155-.544a.771.771 0 0 1 .199-.346l.365-.364zm2.797-2.946l.94.235c.036-.27.06-.544.06-.824a6.4 6.4 0 0 0-.688-2.882l-.419.21a.773.773 0 0 0-.298.263l-.632.947a.908.908 0 0 0-.13.43c0 .13.058.321.13.43l.58.87c.107.16.27.274.457.32z"/>\n</svg>\n'},{}],65:[function(e,t,n){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    \x3c!-- Generator: Sketch 39.1 (31720) - http://www.bohemiancoding.com/sketch --\x3e\n    <defs/>\n    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="Artboard" fill="currentColor">\n            <g id="Group">\n                <path d="M0,8 C0,12.418278 3.581722,16 8,16 C12.418278,16 16,12.418278 16,8 C16,4.89580324 14.2154684,2.11256098 11.4682644,0.789110134 L10.6002482,2.59092808 C12.661769,3.58405472 14,5.6712248 14,8 C14,11.3137085 11.3137085,14 8,14 C4.6862915,14 2,11.3137085 2,8 C2,5.65296151 3.35941993,3.55225774 5.44569583,2.56903563 L4.59307587,0.759881355 C1.81273067,2.07020511 0,4.87140735 0,8 Z" id="Oval"/>\n                <polygon id="Combined-Shape" points="7 8.58578644 7 0 9 0 9 8.58578644 10.2928932 7.29289322 11 6.58578644 12.4142136 8 11.7071068 8.70710678 8.70710678 11.7071068 8 12.4142136 7.64644661 12.0606602 7.29289322 11.7071068 4.29289322 8.70710678 3.58578644 8 5 6.58578644 5.70710678 7.29289322"/>\n            </g>\n        </g>\n    </g>\n</svg>\n'},{}],66:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M6.422 5.422c2 0 3.542.417 4.625 1.25 1.083.833 1.875 1.75 2.375 2.75s.792 1.917.875 2.75l.125 1.25h-2l-.094-.938c-.062-.625-.281-1.312-.656-2.062-.375-.75-.969-1.438-1.781-2.063-.813-.625-1.97-.937-3.47-.937H4.829l2 2-1.406 1.422L1 6.422 5.422 2l1.406 1.422-2 2h1.594z"/>\n</svg>\n'},{}],67:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--search"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.536 9.536a5 5 0 1 1-7.071-7.071 5 5 0 0 1 7.07 7.07L15 15 9.536 9.536z"></path></g></svg>\n'},{}],68:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--share"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 11V2m7 8v5H1v-5m3-5l4-4 4 4"></path></g></svg>\n'},{}],69:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--sort"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 9V2v7zM1 5l4-4 4 4m2 2v7-7zm-4 4l4 4 4-4"></path></g></svg>\n'},{}],70:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--trash"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2 4h12l-2 11H4L2 4zM1 1h14H1z"></path></g></svg>\n'},{}],71:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--social-twitter"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="currentColor" stroke="none" d="M15.969 3.049c-.59.259-1.22.436-1.884.516a3.305 3.305 0 0 0 1.442-1.815c-.634.37-1.336.64-2.084.79a3.28 3.28 0 0 0-5.59 2.988 9.29 9.29 0 0 1-6.76-3.418A3.214 3.214 0 0 0 .65 3.76c0 1.14.58 2.142 1.459 2.73a3.27 3.27 0 0 1-1.485-.41v.04a3.282 3.282 0 0 0 2.63 3.218 3.33 3.33 0 0 1-1.474.057 3.291 3.291 0 0 0 3.069 2.278A6.578 6.578 0 0 1 .78 13.076c-.26 0-.52-.015-.78-.044a9.33 9.33 0 0 0 5.038 1.472c6.036 0 9.332-4.997 9.332-9.323 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7l-.031-.012z"></path></g></svg>\n'},{}],72:[function(e,t,n){"use strict";t.exports={FEATURE_FLAGS_UPDATED:"featureFlagsUpdated",HELP_REQUESTED:"helpRequested",LOGIN_REQUESTED:"loginRequested",LOGOUT_REQUESTED:"logoutRequested",PROFILE_REQUESTED:"profileRequested",PUBLIC_ANNOTATION_COUNT_CHANGED:"publicAnnotationCountChanged",SIGNUP_REQUESTED:"signupRequested"}},{}],73:[function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("extend"),a=e("./frame-rpc"),s=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.links=[],this.channelListeners={},this.onConnectListeners=[]}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"destroy",value:function(){Array.from(this.links).map((function(e){return e.channel.destroy()}))}},{key:"createChannel",value:function(e,t,n){var r=this,o=null,s=!1,c=function(){s||(s=!0,Array.from(r.onConnectListeners).forEach((function(t){return t.call(null,o,e)})))},u=i({connect:function(e,t){e===n&&(t(),c())}},this.channelListeners);return(o=new a(window,e,t,u)).call("connect",n,c),this.links.push({channel:o,window:e}),o}},{key:"call",value:function(e){for(var t,n=this,o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];"function"==typeof i[i.length-1]&&(t=i[i.length-1],i=i.slice(0,-1));var s=function(e){return function(t){throw e.destroy(),n.links=Array.from(n.links).filter((function(t){return t.channel!==e})).map((function(e){return e})),t}},c=this.links.map((function(t){return new Promise((function(n,o){var a=setTimeout((function(){return n(null)}),1e3);try{var s;return(s=t.channel).call.apply(s,[e].concat(r(Array.from(i)),[function(e,t){return clearTimeout(a),e?o(e):n(t)}]))}catch(e){return o(e)}})).catch(s(t.channel))})),u=Promise.all(c);return t&&(u=u.then((function(e){return t(null,e)})).catch((function(e){return t(e)}))),u}},{key:"on",value:function(e,t){if(this.channelListeners[e])throw new Error("Listener '".concat(e,"' already bound in Bridge"));return this.channelListeners[e]=t,this}},{key:"off",value:function(e){return delete this.channelListeners[e],this}},{key:"onConnect",value:function(e){return this.onConnectListeners.push(e),this}}]),e}();t.exports=s},{"./frame-rpc":75,extend:6}],74:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.target=t,this.server=!1,this.origin="*",this.requestInProgress=!1,this.onDiscovery=null,void 0!==n.server&&(this.server=n.server),void 0!==n.origin&&(this.origin=n.origin),this._onMessage=this._onMessage.bind(this)}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"startDiscovery",value:function(e){if(this.onDiscovery)throw new Error("Discovery is already in progress. Call stopDiscovery() first");this.onDiscovery=e,this.target.addEventListener("message",this._onMessage,!1),this._beacon()}},{key:"stopDiscovery",value:function(){this.onDiscovery=null,this.target.removeEventListener("message",this._onMessage)}},{key:"_beacon",value:function(){var e;e=this.server?"__cross_frame_dhcp_offer":"__cross_frame_dhcp_discovery";for(var t=[this.target.top];t.length>0;){var n=t.shift();n!==this.target&&n.postMessage(e,this.origin);for(var r=0;r<n.frames.length;r++)t.push(n.frames[r])}}},{key:"_onMessage",value:function(e){var t=e.source,n=e.data,o=e.origin;("null"===o||o.match("moz-extension:")||"moz-extension:"===window.location.protocol)&&(o="*");var i="string"==typeof n&&n.match(/^__cross_frame_dhcp_(discovery|offer|request|ack)(?::(\d+))?$/);if(i){var a=r(i,3),s=a[1],c=a[2],u=this._processMessage(s,c,o),l=u.reply,f=u.discovered,d=u.token;l&&t.postMessage("__cross_frame_dhcp_"+l,o),f&&this.onDiscovery.call(null,t,o,d)}}},{key:"_processMessage",value:function(e,t,n){var r=null,o=!1;if(this.server){if("discovery"===e)r="offer";else if("request"===e)t=this.generateToken(),r="ack:".concat(t),o=!0;else if("offer"===e||"ack"===e)throw new Error("A second Discovery server has been detected at ".concat(n,".\n This is unsupported and will cause unexpected behaviour."))}else"offer"===e?this.requestInProgress||(this.requestInProgress=!0,r="request"):"ack"===e&&(this.requestInProgress=!1,o=!0);return{reply:r,discovered:o,token:t}}},{key:"generateToken",value:function(){return Math.random().toString().replace(/\D/g,"")}}]),e}();t.exports=i},{}],75:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n,i){if(!(this instanceof o))return new o(e,t,n,i);var a=this;if(this.src=e,this.dst=t,"*"===n)this.origin="*";else{var s=new URL(n);this.origin=s.protocol+"//"+s.host}this._sequence=0,this._callbacks={},this._onmessage=function(e){a._destroyed||a.dst===e.source&&("*"!==a.origin&&e.origin!==a.origin||e.data&&"object"===r(e.data)&&"frame-rpc"===e.data.protocol&&Array.isArray(e.data.arguments)&&a._handle(e.data))},this.src.addEventListener("message",this._onmessage),this._methods=("function"==typeof i?i(this):i)||{}}t.exports=o,o.prototype.destroy=function(){this._destroyed=!0,this.src.removeEventListener("message",this._onmessage)},o.prototype.call=function(e){var t=[].slice.call(arguments,1);return this.apply(e,t)},o.prototype.apply=function(e,t){if(!this._destroyed){var n=this._sequence++;"function"==typeof t[t.length-1]&&(this._callbacks[n]=t[t.length-1],t=t.slice(0,-1)),this.dst.postMessage({protocol:"frame-rpc",version:"1.0.0",sequence:n,method:e,arguments:t},this.origin)}},o.prototype._handle=function(e){var t=this;if(!t._destroyed)if(e.hasOwnProperty("method")){if(!this._methods.hasOwnProperty(e.method))return;var n=e.arguments.concat((function(){t.dst.postMessage({protocol:"frame-rpc",version:"1.0.0",response:e.sequence,arguments:[].slice.call(arguments)},t.origin)}));this._methods[e.method].apply(this._methods,n)}else if(e.hasOwnProperty("response")){var r=this._callbacks[e.response];delete this._callbacks[e.response],r&&r.apply(null,e.arguments)}}},{}],76:[function(e,t,n){"use strict";function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}t.exports={jsonConfigsFrom:function(e){for(var t={},n=e.querySelectorAll("script.js-hypothesis-config"),o=0;o<n.length;o++){var i=void 0;try{i=JSON.parse(n[o].textContent)}catch(e){console.warn("Could not parse settings from js-hypothesis-config tags",e),i={}}r(t,i)}return t}}},{}],77:[function(e,t,n){"use strict";var r={};function o(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var i=n.join();i in r||((e=console).warn.apply(e,n),r[i]=!0)}o.reset=function(){r={}},t.exports=o},{}],78:[function(e,t,n){"use strict";var r={id:void 0,annotation:void 0,parent:void 0,collapsed:!1,visible:!0,children:[],totalChildren:0,highlightState:void 0};function o(e){return e.id||e.$tag}function i(e){var t={};e.forEach((function(e){t[o(e)]=Object.assign({},r,{id:o(e),annotation:e,children:[]})})),e.forEach((function(e){e.references&&function e(t,n,o){if(!t[n].parent&&o.length){var i=o[o.length-1];t[i]||(t[i]=Object.assign({},r,{id:i,children:[]}),e(t,i,o.slice(0,-1)));for(var a=t[i].parent;a;){if(a===n)return;a=t[a].parent}t[n].parent=i,t[i].children.push(t[n])}}(t,o(e),e.references)}));var n=[];return Object.keys(t).forEach((function(e){t[e].parent||(t[e].collapsed=!0,n.push(t[e]))})),{annotation:void 0,children:n,visible:!0,collapsed:!1,totalChildren:n.length}}function a(e,t){return Object.assign({},t(e),{children:e.children.map((function(e){return a(e,t)}))})}function s(e,t){return e.slice().sort((function(e,n){return e.annotation&&n.annotation?t(e.annotation,n.annotation)?-1:t(n.annotation,e.annotation)?1:0:e.annotation||n.annotation?e.annotation?1:-1:0}))}function c(e){return e.children.some((function(e){return e.visible||c(e)}))}var u={selected:[],forceVisible:void 0,filterFn:void 0,threadFilterFn:void 0,expanded:{},highlighted:[],sortCompareFn:function(e,t){return e.id<t.id},replySortCompareFn:function(e,t){return e.created<t.created}};t.exports=function(e,t){t=Object.assign({},u,t);var n=i(e);return t.selected.length>0&&(n=Object.assign({},n,{children:n.children.filter((function(e){return-1!==t.selected.indexOf(e.id)}))})),n=a(n,(function(e){var n,r;return t.highlighted.length>0&&(n=e.annotation&&-1!==t.highlighted.indexOf(e.id)?"highlight":"dim"),Object.assign({},e,{highlightState:n,visible:e.visible&&e.annotation&&(r=e.annotation,!(!t.forceVisible||-1===t.forceVisible.indexOf(o(r)))||!(t.filterFn&&!t.filterFn(r)))})})),(n=a(n,(function(e){var n=e.id;if(t.expanded.hasOwnProperty(n))return Object.assign({},e,{collapsed:!t.expanded[n]});var r=t.filterFn&&c(e);return Object.assign({},e,{collapsed:e.collapsed&&!r})}))).children=n.children.filter((function(e){return e.visible||c(e)})),t.threadFilterFn&&(n.children=n.children.filter(t.threadFilterFn)),function e(t,n){var r=t.children.map((function(t){return e(t,n+1)}));return Object.assign({},t,{children:r,depth:n,replyCount:r.reduce((function(e,t){return e+1+t.replyCount}),0)})}(n=function e(t,n,r){var o=t.children.map((function(t){return e(t,r,r)}));return Object.assign({},t,{children:s(o,n)})}(n,t.sortCompareFn,t.replySortCompareFn),-1)}},{}],79:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("../util/service-context").withServices,a=e("../util/annotation-sharing"),s=a.isShareable,c=a.shareURI,u=e("./annotation-share-control"),l=e("./button");function f(e){var t=e.annotation,n=e.isPrivate,r=e.onDelete,i=e.onEdit,a=e.onFlag,f=e.onReply,d=e.groups,p=e.permissions,h=e.session,m=e.settings,g=function(e){return p.permits(t.permissions,e,h.state.userid)},v=g("delete"),y=g("update"),b=h.state.userid!==t.user,_=s(t,m),w=d.get(t.group);return o("div",{className:"annotation-action-bar"},y&&o(l,{icon:"edit",title:"Edit",onClick:i}),v&&o(l,{icon:"trash",title:"Delete",onClick:r}),o(l,{icon:"reply",title:"Reply",onClick:f}),_&&o(u,{group:w,isPrivate:n,shareUri:c(t)}),b&&!t.flagged&&o(l,{icon:"flag",title:"Report this annotation to moderators",onClick:a}),b&&t.flagged&&o(l,{isActive:!0,icon:"flag--active",title:"Annotation has been reported to the moderators"}))}f.propTypes={annotation:r.object.isRequired,isPrivate:r.bool.isRequired,onEdit:r.func.isRequired,onDelete:r.func.isRequired,onFlag:r.func.isRequired,onReply:r.func.isRequired,groups:r.object.isRequired,permissions:r.object.isRequired,session:r.object.isRequired,settings:r.object.isRequired},f.injectedProps=["groups","permissions","session","settings"],t.exports=i(f)},{"../util/annotation-sharing":197,"../util/service-context":218,"./annotation-share-control":86,"./button":92,preact:12,"prop-types":15}],80:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("prop-types"),i=e("./excerpt"),a=e("./markdown-editor"),s=e("./markdown-view");function c(e){var t=e.collapse,n=e.isEditing,o=e.isHiddenByModerator,c=e.onCollapsibleChanged,u=e.onEditText,l=e.onToggleCollapsed,f=e.text;return r("section",{className:"annotation-body"},!n&&r(i,{collapse:t,collapsedHeight:400,inlineControls:!1,onCollapsibleChanged:c,onToggleCollapsed:function(e){return l({collapsed:e})},overflowThreshold:20},r(s,{markdown:f,textClass:{"annotation-body__text":!0,"is-hidden":o,"has-content":f.length>0}})),n&&r(a,{text:f,onEditText:u}))}c.propTypes={collapse:o.bool,isEditing:o.bool,isHiddenByModerator:o.bool,onCollapsibleChanged:o.func,onEditText:o.func,onToggleCollapsed:o.func,text:o.string},t.exports=c},{"./excerpt":93,"./markdown-editor":102,"./markdown-view":103,preact:12,"prop-types":15}],81:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("../util/annotation-metadata");function a(e){var t=e.annotation,n=i.domainAndTitle(t);return n.titleText?o("div",{className:"annotation-document-info"},o("div",{className:"annotation-document-info__title"},'on "',n.titleLink?o("a",{href:n.titleLink},n.titleText):o("span",null,n.titleText),'"'),n.domain&&o("div",{className:"annotation-document-info__domain"},"(",n.domain,")")):null}a.propTypes={annotation:r.object.isRequired},t.exports=a},{"../util/annotation-metadata":196,preact:12,"prop-types":15}],82:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("./annotation-document-info"),a=e("./annotation-share-info"),s=e("./annotation-user"),c=e("./timestamp");function u(e){var t=e.annotation,n=e.isEditing,r=e.isHighlight,u=e.isPrivate,l=e.onReplyCountClick,f=e.replyCount,d=e.showDocumentInfo,p=t.links?t.links.html:"",h=!f||f>1?"replies":"reply",m=t.updated&&t.created!==t.updated;return o("header",{className:"annotation-header"},o("div",{className:"annotation-header__row"},o(s,{annotation:t}),o("div",{className:"annotation-collapsed-replies"},o("a",{className:"annotation-link",onClick:l},f," ",h)),!n&&t.created&&o("div",{className:"annotation-header__timestamp"},m&&o("span",{className:"annotation-header__timestamp-edited"},"(edited"," ",o(c,{className:"annotation-header__timestamp-edited-link",timestamp:t.updated}),")"," "),o("span",{className:"annotation-header__timestamp-created"},o(c,{className:"annotation-header__timestamp-created-link",href:p,timestamp:t.created})))),o("div",{className:"annotation-header__row"},o(a,{annotation:t,isPrivate:u}),!n&&r&&o("div",{className:"annotation-header__highlight"},o("i",{className:"h-icon-border-color",title:"This is a highlight. Click 'edit' to add a note or tag."})),d&&o(i,{annotation:t})))}u.propTypes={annotation:r.object.isRequired,isEditing:r.bool,isHighlight:r.bool,isPrivate:r.bool,onReplyCountClick:r.func.isRequired,replyCount:r.number,showDocumentInfo:r.bool},t.exports=u},{"./annotation-document-info":81,"./annotation-share-info":87,"./annotation-user":89,"./timestamp":126,preact:12,"prop-types":15}],83:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("./svg-icon");function i(){return r("div",{className:"annotation-license"},r("a",{className:"annotation-license__link",href:"http://creativecommons.org/publicdomain/zero/1.0/",title:"View more information about the Creative Commons Public Domain dedication",target:"_blank",rel:"noopener noreferrer"},r(o,{name:"cc-std",inline:!0,className:"annotation-license__icon"}),r(o,{name:"cc-zero",inline:!0,className:"annotation-license__icon"}),r("span",{className:"annotation-license__details"},"Annotations can be freely reused by anyone for any purpose.")))}i.propTypes={},t.exports=i},{"./svg-icon":122,preact:12}],84:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("../util/theme").applyTheme,a=e("../util/service-context").withServices,s=e("./button"),c=e("./menu"),u=e("./menu-item");function l(e){var t=e.group,n=e.isDisabled,r=e.isShared,a=e.onCancel,l=e.onSave,f=e.onSetPrivacy,d=e.settings,p=r?t.name:"Only Me",h=["ctaTextColor","ctaBackgroundColor"],m=o("div",{className:"annotation-publish-control__btn-dropdown-arrow"},o("div",{className:"annotation-publish-control__btn-dropdown-arrow-separator"}),o("div",{className:"annotation-publish-control__btn-dropdown-arrow-indicator",style:i(h,d)},o("div",null,"")));return o("div",{className:"annotation-publish-control"},o("div",{className:"annotation-publish-control__btn"},o("button",{className:"annotation-publish-control__btn-primary",style:i(h,d),onClick:l,disabled:n,title:"Publish this annotation to ".concat(p)},"Post to ",p),o(c,{arrowClass:"annotation-publish-control__btn-menu-arrow",containerPositioned:!1,contentClass:"annotation-publish-control__btn-menu-content",label:m,menuIndicator:!1,title:"Change annotation sharing setting",align:"left"},o(u,{icon:"open"===t.type?"public":"groups",label:t.name,isSelected:r,onClick:function(){return f({level:"shared"})}}),o(u,{icon:"lock",label:"Only Me",isSelected:!r,onClick:function(){return f({level:"private"})}}))),o(s,{icon:"cancel",buttonText:"Cancel",onClick:a,useCompactStyle:!0}))}l.propTypes={group:r.object.isRequired,isDisabled:r.bool,isShared:r.bool,onCancel:r.func.isRequired,onSave:r.func.isRequired,onSetPrivacy:r.func.isRequired,settings:r.object.isRequired},l.injectedProps=["settings"],t.exports=a(l)},{"../util/service-context":218,"../util/theme":222,"./button":92,"./menu":106,"./menu-item":104,preact:12,"prop-types":15}],85:[function(e,t,n){"use strict";var r=e("classnames"),o=e("preact").createElement,i=e("prop-types"),a=e("../util/service-context").withServices,s=e("../util/theme").applyTheme,c=e("./excerpt");function u(e){var t=e.isOrphan,n=e.quote,i=e.settings,a=void 0===i?{}:i;return o("section",{className:r("annotation-quote",t&&"is-orphan")},o(c,{collapsedHeight:35,inlineControls:!0,overflowThreshold:20},o("blockquote",{className:"annotation-quote__quote",style:s(["selectionFontFamily"],a)},n)))}u.propTypes={isOrphan:i.bool,quote:i.string,settings:i.object},u.injectedProps=["settings"],t.exports=a(u)},{"../util/service-context":218,"../util/theme":222,"./excerpt":93,classnames:2,preact:12,"prop-types":15}],86:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("prop-types"),i=e("preact").createElement,a=e("preact/hooks"),s=a.useEffect,c=a.useRef,u=a.useState,l=e("./hooks/use-element-should-close"),f=e("../util/copy-to-clipboard").copyText,d=e("../util/service-context").withServices,p=e("./button"),h=e("./share-links"),m=e("./svg-icon");function g(e){var t=e.analytics,n=e.flash,o=e.group,a=e.isPrivate,d=e.shareUri,g=c(),v=c(),y=r(u(!1),2),b=y[0],_=y[1],w=c(b);if(l(g,b,(function(){return _(!1)})),s((function(){w.current!==b&&(w.current=b,b&&(v.current.focus(),v.current.select()))}),[b]),!o)return null;var A="private"===o.type?i("span",null,"Only members of the group ",i("em",null,o.name)," may view this annotation."):i("span",null,"Anyone using this link may view this annotation."),T=a?i("span",null,"Only you may view this annotation."):A;return i("div",{className:"annotation-share-control",ref:g},i(p,{icon:"share",title:"Share",onClick:function(){return _(!b)}}),b&&i("div",{className:"annotation-share-panel"},i("div",{className:"annotation-share-panel__header"},i("div",{className:"annotation-share-panel__title"},"Share this annotation")),i("div",{className:"annotation-share-panel__content"},i("div",{className:"annotation-share-panel__input"},i("input",{"aria-label":"Use this URL to share this annotation",className:"form-input",type:"text",value:d,readOnly:!0,ref:v}),i(p,{icon:"copy",title:"Copy share link to clipboard",onClick:function(){try{f(d),n.info("Copied share link to clipboard")}catch(e){n.error("Unable to copy link")}},useInputStyle:!0,useCompactStyle:!0})),i("div",{className:"annotation-share-panel__permissions"},T),i(h,{shareURI:d,analyticsEventName:t.events.ANNOTATION_SHARED,className:"annotation-share-control__links"})),i(m,{name:"pointer",className:"annotation-share-panel__arrow"})))}g.propTypes={group:o.object,isPrivate:o.bool.isRequired,shareUri:o.string.isRequired,analytics:o.object.isRequired,flash:o.object.isRequired},g.injectedProps=["analytics","flash"],t.exports=d(g)},{"../util/copy-to-clipboard":199,"../util/service-context":218,"./button":92,"./hooks/use-element-should-close":99,"./share-links":113,"./svg-icon":122,preact:12,"preact/hooks":13,"prop-types":15}],87:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("./svg-icon"),a=e("../store/use-store");function s(e){var t=e.annotation,n=e.isPrivate,r=a((function(e){return e.getGroup(t.group)})),s=!!r&&r.links&&r.links.html;return o("div",{className:"annotation-share-info"},s&&o("a",{className:"annotation-share-info__group",href:r.links.html,target:"_blank",rel:"noopener noreferrer"},"open"===r.type?o(i,{className:"annotation-share-info__icon",name:"public"}):o(i,{className:"annotation-share-info__icon",name:"groups"}),o("span",{className:"annotation-share-info__group-info"},r.name)),n&&o("span",{className:"annotation-share-info__private",title:"This annotation is visible only to you."},o(i,{className:"annotation-share-info__icon",name:"lock"}),!s&&o("span",{className:"annotation-share-info__private-info"},"Only me")))}s.propTypes={annotation:r.object.isRequired,isPrivate:r.bool.isRequired},t.exports=s},{"../store/use-store":185,"./svg-icon":122,preact:12,"prop-types":15}],88:[function(e,t,n){"use strict";function r(e){this.annotationHovered=!1,this.toggleCollapsed=function(){this.onChangeCollapsed({id:this.thread.id,collapsed:!this.thread.collapsed})},this.threadClasses=function(){return{"annotation-thread":!0,"annotation-thread--reply":this.thread.depth>0,"annotation-thread--top-reply":1===this.thread.depth}},this.threadToggleClasses=function(){return{"annotation-thread__collapse-toggle":!0,"is-open":!this.thread.collapsed,"is-hovered":this.annotationHovered}},this.annotationClasses=function(){return{annotation:!0,"annotation--reply":this.thread.depth>0,"is-collapsed":this.thread.collapsed,"is-highlighted":"highlight"===this.thread.highlightState,"is-dimmed":"dim"===this.thread.highlightState}},this.showThreadAndReplies=function(){(function(e,t){for(;e.parent&&e.parent.annotation;)t(e.parent),e=e.parent})(this.thread,this.onForceVisible),this.onForceVisible(this.thread),function e(t,n){t.children.forEach((function(t){n(t),e(t,n)}))}(this.thread,this.onForceVisible)},this.isTopLevelThread=function(){return!this.thread.parent},this.hiddenCount=function(){return function e(t){var n=t.annotation&&!t.visible;return t.children.reduce((function(t,n){return t+e(n)}),n?1:0)}(this.thread)},this.shouldShowReply=function(e){return function e(t){var n=t.annotation&&t.visible;return t.children.reduce((function(t,n){return t+e(n)}),n?1:0)}(e)>0},this.onForceVisible=function(t){e.setForceVisible(t.id,!0),t.parent&&e.setCollapsed(t.parent.id,!1)}}r.$inject=["store"],t.exports={controllerAs:"vm",controller:r,bindings:{thread:"<",showDocumentInfo:"<",onChangeCollapsed:"&"},template:e("../templates/annotation-thread.html")}},{"../templates/annotation-thread.html":187}],89:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("../util/account-id"),a=i.isThirdPartyUser,s=i.username,c=e("../util/service-context").withServices;function u(e){var t=e.annotation,n=e.features,r=e.serviceUrl,i=e.settings,c=t.user,u=!a(c,i.authDomain),l=s(c),f=u&&!n.flagEnabled("client_display_names")?l:t.user_info&&t.user_info.display_name?t.user_info.display_name:l,d=u||i.usernameUrl;return o("div",{className:"annotation-user"},d?o("a",{className:"annotation-user__link",href:u?r("user",{user:c}):"".concat(i.usernameUrl).concat(l),target:"_blank",rel:"noopener noreferrer"},o("span",{className:"annotation-user__user-name"},f)):o("span",{className:"annotation-user__user-name"},f))}u.propTypes={annotation:r.object.isRequired,features:r.object.isRequired,serviceUrl:r.func.isRequired,settings:r.object.isRequired},u.injectedProps=["features","serviceUrl","settings"],t.exports=c(u)},{"../util/account-id":195,"../util/service-context":218,preact:12,"prop-types":15}],90:[function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){t.setAppIsSidebar(!1);var s=e.id;this.rootThread=function(){return r.thread(t.getState())},this.setCollapsed=function(e,n){t.setCollapsed(e,n)},this.ready=function(e,t){var n;return e.annotation.get({id:t}).then((function(t){return t.references&&t.references.length?e.annotation.get({id:t.references[0]}):t})).then((function(t){return n=t,e.search({references:n.id})})).then((function(e){return[n].concat(e.rows)}))}(n,s).then((function(e){a.loadAnnotations(e);var n=e.filter((function(e){return 0===(e.references||[]).length}))[0];n&&(i.addClause("/references","one_of",n.id,!0).addClause("/id","equals",n.id,!0),o.setConfig("filter",{filter:i.getFilter()}),o.connect(),e.forEach((function(e){t.setCollapsed(e.id,!1)})),n.id!==s&&t.highlightAnnotations([s]))}))}r.$inject=["$routeParams","store","api","rootThread","streamer","streamFilter","annotationMapper"],t.exports={controller:r,controllerAs:"vm",bindings:{},template:e("../templates/annotation-viewer-content.html")}},{"../templates/annotation-viewer-content.html":188}],91:[function(e,t,n){"use strict";f.$inject=["$document","$rootScope","$scope","$timeout","$window","store","annotationMapper","api","bridge","flash","groups","permissions","serviceUrl","session","settings"];var r=e("../util/annotation-metadata"),o=r.isNew,i=r.isReply,a=r.isPageNote,s=r.quote,c=e("../events"),u=e("../util/account-id").isThirdPartyUser;function l(e,t,n){var r=e.user;return Object.assign({},e,{tags:t.tags,text:t.text,permissions:t.isPrivate?n.private(r):n.shared(r,e.group)})}function f(e,t,n,r,f,d,p,h,m,g,v,y,b,_,w){var A,T=this;function E(e){return(e.id?h.annotation.update({id:e.id},e):h.annotation.create({},e)).then((function(t){return t.$tag=e.$tag,Object.keys(e).forEach((function(n){"$"===n[0]&&(t[n]=e[n])})),t}))}this.$onInit=function(){T.canCollapseBody=!1,T.collapseBody=!0,T.isSaving=!1,A=T.annotation.$highlight||!1,T.annotation.user=T.annotation.user||_.state.userid,T.annotation.user_info=T.annotation.user_info||_.state.user_info,T.annotation.group=T.annotation.group||v.focused().id,T.annotation.permissions||(T.annotation.permissions=y.default(T.annotation.user,T.annotation.group)),T.annotation.text=T.annotation.text||"",Array.isArray(T.annotation.tags)||(T.annotation.tags=[]),o(T.annotation)&&(T.annotation.user||m.call("showSidebar"),T.isHighlight()&&(T.annotation.user?(T.annotation.permissions=y.private(T.annotation.user),E(T.annotation).then((function(e){e.$tag=T.annotation.$tag,t.$broadcast(c.ANNOTATION_CREATED,e)}))):d.createDraft(T.annotation,T.state()))),A||(o(T.annotation)||d.getDraft(T.annotation))&&T.edit()},this.flag=function(){_.state.userid?p.flagAnnotation(T.annotation).then((function(){d.updateFlagStatus(T.annotation.id,!0)}),(function(e){g.error(e.message,"Flagging annotation failed")})):g.error("You must be logged in to report an annotation to the moderators.","Login to flag annotations")},this.delete=function(){return r((function(){f.confirm("Are you sure you want to delete this annotation?")&&n.$apply((function(){p.deleteAnnotation(T.annotation).catch((function(e){return g.error(e.message,"Deleting annotation failed")}))}))}),!0)},this.edit=function(){d.getDraft(T.annotation)||d.createDraft(T.annotation,T.state())},this.editing=function(){return d.getDraft(T.annotation)&&!T.isSaving},this.group=function(){return v.get(T.annotation.group)},this.hasContent=function(){return T.state().text.length>0||T.state().tags.length>0},this.quote=function(){return s(T.annotation)},this.id=function(){return T.annotation.id},this.isHighlight=function(){return!(!A&&(o(T.annotation)||a(T.annotation)||i(T.annotation)||T.annotation.hidden||T.hasContent()))},this.isShared=function(){return!T.state().isPrivate},this.onKeydown=function(e){13===e.keyCode&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),T.save())},this.toggleCollapseBody=function(e){e.stopPropagation(),T.collapseBody=!T.collapseBody},this.reply=function(){var e,t=(T.annotation.references||[]).concat(T.annotation.id),n=T.annotation.group,r=_.state.userid;r&&(e=T.state().isPrivate?y.private(r):y.shared(r,n)),p.createAnnotation({group:n,references:t,permissions:e,target:[{source:T.annotation.target[0].source}],uri:T.annotation.uri})},this.revert=function(){d.removeDraft(T.annotation),o(T.annotation)&&t.$broadcast(c.ANNOTATION_DELETED,T.annotation)},this.save=function(){if(!T.annotation.user)return g.info("Please log in to save your annotations."),Promise.resolve();if(!T.hasContent()&&T.isShared())return g.info("Please add text or a tag before publishing."),Promise.resolve();var e=l(T.annotation,T.state(),y);return T.isSaving=!0,E(e).then((function(n){Object.assign(e,n),T.isSaving=!1;var r=o(T.annotation)?c.ANNOTATION_CREATED:c.ANNOTATION_UPDATED;d.removeDraft(T.annotation),t.$broadcast(r,e)})).catch((function(e){T.isSaving=!1,T.edit(),g.error(e.message,"Saving annotation failed")}))},this.setPrivacy=function(e){i(T.annotation)||y.setDefault(e),d.createDraft(T.annotation,{tags:T.state().tags,text:T.state().text,isPrivate:"private"===e})},this.isOrphan=function(){return void 0===T.annotation.$orphan?T.annotation.$anchorTimeout:T.annotation.$orphan},this.user=function(){return T.annotation.user},this.isThirdPartyUser=function(){return u(T.annotation.user,w.authDomain)},this.isDeleted=function(){return d.hasPendingDeletion(T.annotation.id)},this.isHiddenByModerator=function(){return T.annotation.hidden},this.isReply=function(){return i(T.annotation)},this.setBodyCollapsible=function(e){e!==T.canCollapseBody&&(T.canCollapseBody=e)},this.setText=function(e){d.createDraft(T.annotation,{isPrivate:T.state().isPrivate,tags:T.state().tags,text:e})},this.setTags=function(e){d.createDraft(T.annotation,{isPrivate:T.state().isPrivate,tags:e,text:T.state().text})},this.state=function(){return d.getDraft(T.annotation)||{tags:T.annotation.tags,text:T.annotation.text,isPrivate:!y.isShared(T.annotation.permissions,T.annotation.user)}},this.shouldShowLicense=function(){return!(!T.editing()||!T.isShared())&&"private"!==T.group().type}}t.exports={controller:f,controllerAs:"vm",bindings:{annotation:"<",showDocumentInfo:"<",onReplyCountClick:"&",replyCount:"<",isCollapsed:"<"},template:e("../templates/annotation.html"),updateModel:l}},{"../events":137,"../templates/annotation.html":189,"../util/account-id":195,"../util/annotation-metadata":196}],92:[function(e,t,n){"use strict";var r=e("classnames"),o=e("prop-types"),i=e("preact").createElement,a=e("./svg-icon");function s(e){var t=e.buttonText,n=void 0===t?"":t,o=e.className,s=void 0===o?"":o,c=e.icon,u=void 0===c?"":c,l=e.isActive,f=void 0!==l&&l,d=e.onClick,p=void 0===d?function(){return null}:d,h=e.title,m=e.useCompactStyle,g=void 0!==m&&m,v=e.useInputStyle,y=void 0!==v&&v,b=e.usePrimaryStyle;return h=h||n,i("button",{className:r("button",n?"button--labeled":"button--icon-only",{"button--compact":g,"button--input":y,"button--primary":void 0!==b&&b,"is-active":f},s),onClick:p,"aria-pressed":f,title:h},u&&i(a,{name:u,className:"button__icon"}),n)}function c(e,t,n){if("string"!=typeof e.buttonText&&"string"!=typeof e[t])return new Error("string property '".concat(t,"' must be supplied to component '").concat(n,"'if string property 'buttonText' omitted"))}s.propTypes={buttonText:o.string,className:o.string,icon:c,isActive:o.bool,onClick:o.func,title:c,useCompactStyle:o.bool,useInputStyle:o.bool,usePrimaryStyle:o.bool},t.exports=s},{"./svg-icon":122,classnames:2,preact:12,"prop-types":15}],93:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("classnames"),i=e("prop-types"),a=e("preact").createElement,s=e("preact/hooks"),c=s.useCallback,u=s.useLayoutEffect,l=s.useRef,f=s.useState,d=e("../util/theme").applyTheme,p=e("../util/service-context").withServices,h=e("../util/observe-element-size");function m(e){var t=e.isCollapsed,n=e.setCollapsed,r=e.linkStyle;return a("div",{className:"excerpt__inline-controls"},a("span",{className:"excerpt__toggle-link"},a("a",{href:"#",onClick:function(){return n(!t)},title:t?"Show the full excerpt":"Show the first few lines only",style:void 0===r?{}:r},t?"More":"Less")))}m.propTypes={isCollapsed:i.bool,setCollapsed:i.func,linkStyle:i.object};var g=function(){};function v(e){var t=e.children,n=e.collapse,i=void 0!==n&&n,s=e.collapsedHeight,p=e.inlineControls,v=void 0===p||p,y=e.onCollapsibleChanged,b=void 0===y?g:y,_=e.onToggleCollapsed,w=void 0===_?g:_,A=e.overflowThreshold,T=void 0===A?0:A,E=e.settings,S=void 0===E?{}:E,O=r(f(!0),2),k=O[0],x=O[1],N=l(null),C=r(f(0),2),j=C[0],D=C[1],I=c((function(){var e=N.current.clientHeight;D(e),b({collapsible:e>s+T})}),[s,b,T]);u((function(){var e=h(N.current,I);return I(),e}),[I]);var L=j>s+T,P=L&&(v?k:i),R={};0!==j&&(R["max-height"]=P?s:j);var F=function(e){return v?x(e):w(e)};return a("div",{className:"excerpt",style:R},a("div",{className:"excerpt__content",ref:N},t),a("div",{onClick:function(){return F(!1)},className:o({excerpt__shadow:!0,"excerpt__shadow--transparent":v,"is-hidden":!P}),title:"Show the full excerpt"}),L&&v&&a(m,{isCollapsed:k,setCollapsed:F,linkStyle:d(["selectionFontFamily"],S)}))}v.propTypes={children:i.object,inlineControls:i.bool,collapse:i.bool,collapsedHeight:i.number,overflowThreshold:i.number,onCollapsibleChanged:i.func,onToggleCollapsed:i.func,settings:i.object},v.injectedProps=["settings"],t.exports=p(v)},{"../util/observe-element-size":211,"../util/service-context":218,"../util/theme":222,classnames:2,preact:12,"preact/hooks":13,"prop-types":15}],94:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("../store/use-store");function i(){var e=o((function(e){return{setFocusModeFocused:e.setFocusModeFocused}})),t=o((function(e){return{focusModeFocused:e.focusModeFocused(),focusModeHasUser:e.focusModeHasUser(),focusModeUserPrettyName:e.focusModeUserPrettyName()}}));if(!t.focusModeHasUser)return null;var n=r("div",{className:"focused-mode-header__filter-status"},t.focusModeFocused?r("span",null,"Showing ",r("strong",null,t.focusModeUserPrettyName)," only"):r("span",null,"Showing ",r("strong",null,"all"))),i=t.focusModeFocused?"Show all":"Show only ".concat(t.focusModeUserPrettyName);return r("div",{className:"focused-mode-header sheet sheet--short"},n,r("button",{onClick:function(){e.setFocusModeFocused(!t.focusModeFocused)},className:"focused-mode-header__btn"},i))}i.propTypes={},t.exports=i},{"../store/use-store":185,preact:12}],95:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact"),i=o.Fragment,a=o.createElement,s=e("../store/use-store"),c=e("../util/group-list-item-common").orgName,u=e("../util/service-context").withServices,l=e("../util/copy-to-clipboard").copyText,f=e("./menu-item");function d(e){var t=e.analytics,n=e.isExpanded,r=e.flash,o=e.group,u=e.groups,d=e.onExpand,p="private"===o.type,h=o.links.html,m=h||p,g=!o.scopes.enforced||o.isScopedToUri,v=s((function(e){return e.focusedGroupId()})),y=o.id===v,b=s((function(e){return{clearDirectLinkedGroupFetchFailed:e.clearDirectLinkedGroupFetchFailed,clearDirectLinkedIds:e.clearDirectLinkedIds,focusGroup:e.focusGroup}})),_=function(e){e.stopPropagation(),e.preventDefault(),d(!n)},w="private"===o.type?"Copy invite link":"Copy activity link";return a(f,{icon:o.logo||"blank",iconAlt:c(o),isDisabled:!g,isExpanded:!!m&&n,isSelected:y,isSubmenuVisible:n,label:o.name,onClick:g?function(){t.track(t.events.GROUP_SWITCH),b.clearDirectLinkedGroupFetchFailed(),b.clearDirectLinkedIds(),b.focusGroup(o.id)}:_,onToggleSubmenu:_,submenu:a(i,null,a("ul",{onClick:function(){return d(!1)}},h&&a("li",null,a(f,{href:h,icon:"external",isSubmenuItem:!0,label:"View group activity"})),h&&a("li",null,a(f,{onClick:function(){try{l(h),r.info('Copied link for "'.concat(o.name,'"'))}catch(e){r.error("Unable to copy link")}},icon:"copy",isSubmenuItem:!0,label:w})),p&&a("li",null,a(f,{icon:"leave",isSubmenuItem:!0,label:"Leave group",onClick:function(){var e='Are you sure you want to leave the group "'.concat(o.name,'"?');window.confirm(e)&&(t.track(t.events.GROUP_LEAVE),u.leave(o.id))}}))),!g&&a("p",{className:"group-list-item__footer"},"This group is restricted to specific URLs."))})}d.propTypes={group:r.object.isRequired,isExpanded:r.bool,onExpand:r.func,analytics:r.object.isRequired,flash:r.object.isRequired,groups:r.object.isRequired},d.injectedProps=["analytics","flash","groups"],t.exports=u(d)},{"../store/use-store":185,"../util/copy-to-clipboard":199,"../util/group-list-item-common":204,"../util/service-context":218,"./menu-item":104,preact:12,"prop-types":15}],96:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("prop-types"),i=e("./group-list-item"),a=e("./menu-section");function s(e){var t=e.expandedGroup,n=e.onExpandGroup,o=e.groups,s=e.heading;return r(a,{heading:s},o.map((function(e){return r(i,{key:e.id,isExpanded:e===t,onExpand:function(t){return n(t?e:null)},group:e})})))}s.propTypes={expandedGroup:o.object,groups:o.arrayOf(o.object),heading:o.string,onExpandGroup:o.func},t.exports=s},{"./group-list-item":95,"./menu-section":105,preact:12,"prop-types":15}],97:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("preact").createElement,i=e("preact/hooks"),a=i.useMemo,s=i.useState,c=e("prop-types"),u=e("../util/is-third-party-service"),l=e("../util/account-id").isThirdPartyUser,f=e("../util/group-organizations"),d=e("../store/use-store"),p=e("../util/service-context").withServices,h=e("../service-config"),m=e("./menu"),g=e("./menu-item"),v=e("./group-list-section");function y(e){var t=h(e);return t&&t.icon?t.icon:null}function b(e){var t,n=e.serviceUrl,i=e.settings,c=d((function(e){return e.getCurrentlyViewingGroups()})),p=d((function(e){return e.getFeaturedGroups()})),h=d((function(e){return e.getMyGroups()})),b=d((function(e){return e.focusedGroup()})),_=d((function(e){return e.profile().userid})),w=a((function(){return f(h)}),[h]),A=a((function(){return f(p)}),[p]),T=a((function(){return f(c)}),[c]),E=i.authDomain,S=_&&!l(_,E),O=n("groups.new"),k=r(s(null),2),x=k[0],N=k[1];if(b){var C=b.organization.logo;t=o("span",{className:"group-list__menu-label"},o("img",{className:"group-list__menu-icon",src:C||y(i)}),b.name)}else t=o("span",null,"");return u(i)&&c.length+p.length+h.length<2?t:o(m,{align:"left",contentClass:"group-list__content",label:t,onOpenChanged:function(){return N(null)},title:"Select group"},T.length>0&&o(v,{expandedGroup:x,onExpandGroup:N,heading:"Currently Viewing",groups:T}),A.length>0&&o(v,{expandedGroup:x,onExpandGroup:N,heading:"Featured Groups",groups:A}),w.length>0&&o(v,{expandedGroup:x,onExpandGroup:N,heading:"My Groups",groups:w}),S&&o(g,{icon:"add",href:O,label:"New private group",style:"shaded"}))}b.propTypes={serviceUrl:c.func,settings:c.object},b.injectedProps=["serviceUrl","settings"],t.exports=p(b)},{"../service-config":148,"../store/use-store":185,"../util/account-id":195,"../util/group-organizations":205,"../util/is-third-party-service":208,"../util/service-context":218,"./group-list-section":96,"./menu":106,"./menu-item":104,preact:12,"preact/hooks":13,"prop-types":15}],98:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("preact").createElement,i=e("preact/hooks"),a=i.useCallback,s=i.useMemo,c=i.useState,u=e("prop-types"),l=e("../ui-constants"),f=e("../store/use-store"),d=e("../util/version-data"),p=e("../util/service-context").withServices,h=e("./sidebar-panel"),m=e("./svg-icon"),g=e("./tutorial"),v=e("./version-info");function y(e){var t=e.linkText,n=e.url;return o("div",{className:"help-panel-tabs__tab"},o("a",{href:n,className:"help-panel-tabs__link",target:"_blank",rel:"noopener noreferrer"},t," ",o(m,{name:"external",className:"help-panel-tabs__icon",inline:!0})))}function b(e){var t=e.auth,n=e.session,i=f((function(e){return e.mainFrame()})),u=f((function(e){return!!e.getState().session.preferences.show_sidebar_tutorial})),p=r(c("tutorial"),2),b=p[0],_=p[1],w=s((function(){return new d(t||{},i||{})}),[t,i]),A="https://web.hypothes.is/get-help/?sys_info=".concat(w.asEncodedURLString()),T=function(e,t){e.preventDefault(),_(t)},E=n.dismissSidebarTutorial,S=a((function(e){!e&&u&&E()}),[E,u]);return o(h,{title:"Help",panelName:l.PANEL_HELP,onActiveChanged:S},o("div",{className:"u-layout-row"},o("h3",{className:"help-panel__sub-panel-title"},{tutorial:"Getting started",versionInfo:"About this version"}[b]),o("div",{className:"help-panel__footer"},"versionInfo"===b&&o("a",{href:"#",className:"help-panel__sub-panel-link",onClick:function(e){return T(e,"tutorial")}},o("div",null,"Getting started"),o(m,{name:"arrow-right",className:"help-panel__sub-panel-link-icon"})),"tutorial"===b&&o("a",{href:"#",className:"help-panel__sub-panel-link",onClick:function(e){return T(e,"versionInfo")}},o("div",null,"About this version"),o(m,{name:"arrow-right",className:"help-panel__sub-panel-link-icon"})))),o("div",{className:"help-panel__content"},"tutorial"===b&&o(g,null),"versionInfo"===b&&o(v,{versionData:w})),o("div",{className:"help-panel-tabs"},o(y,{linkText:"Help topics",url:"https://web.hypothes.is/help/"}),o(y,{linkText:"New support ticket",url:A})))}y.propTypes={linkText:u.string.isRequired,url:u.string.isRequired},b.propTypes={auth:u.object.isRequired,session:u.object.isRequired},b.injectedProps=["session"],t.exports=p(b)},{"../store/use-store":185,"../ui-constants":194,"../util/service-context":218,"../util/version-data":225,"./sidebar-panel":116,"./svg-icon":122,"./tutorial":128,"./version-info":130,preact:12,"preact/hooks":13,"prop-types":15}],99:[function(e,t,n){"use strict";var r=e("preact/hooks").useEffect,o=e("../../util/dom").listen;t.exports=function(e,t,n){r((function(){if(!t)return function(){};var r=o(document.body,["keypress"],(function(e){"Escape"===e.key&&n()})),i=o(document.body,"focus",(function(t){e.current.contains(t.target)||n()}),{useCapture:!0}),a=o(document.body,["mousedown","click"],(function(t){e.current.contains(t.target)||n()}),{useCapture:!0});return function(){r(),a(),i()}}),[e,t,n])}},{"../../util/dom":202,"preact/hooks":13}],100:[function(e,t,n){"use strict";l.$inject=["$document","$rootScope","$route","$scope","$window","analytics","store","auth","bridge","features","flash","frameSync","groups","serviceUrl","session","settings"];var r=e("../events"),o=e("../util/account-id").parseAccountID,i=e("../service-config"),a=e("../../shared/bridge-events"),s=e("../ui-constants"),c=e("../util/is-sidebar"),u=e("../util/session").shouldAutoDisplayTutorial;function l(e,t,n,l,f,d,p,h,m,g,v,y,b,_,w,A){var T=this,E=this;this.auth={status:"unknown"},this.isSidebar=c(),this.isSidebar&&y.connect(),this.onUserChange=function(e){E.auth=function(e){if(e.userid){var t=o(e.userid),n=t.username;return e.user_info&&e.user_info.display_name&&(n=e.user_info.display_name),{status:"logged-in",displayName:n,userid:e.userid,username:t.username,provider:t.provider}}return{status:"logged-out"}}(e),u(T.isSidebar,p.getState().session,A)&&p.openSidebarPanel(s.PANEL_HELP)},l.$on(r.USER_CHANGED,(function(e,t){E.onUserChange(t.profile)})),w.load().then((function(e){E.onUserChange(e)})),this.login=function(){return i(A)?(m.call(a.LOGIN_REQUESTED),Promise.resolve()):h.login().then((function(){p.clearGroups(),w.reload()})).catch((function(e){v.error(e.message)}))},this.signUp=function(){d.track(d.events.SIGN_UP_REQUESTED),i(A)?m.call(a.SIGNUP_REQUESTED):f.open(_("signup"))},this.logout=function(){var e,n;e="",1===(n=p.countDrafts())?e="You have an unsaved annotation.\nDo you really want to discard this draft?":n>1&&(e="You have "+n+" unsaved annotations.\nDo you really want to discard these drafts?"),(0===n||f.confirm(e))&&(p.clearGroups(),p.unsavedAnnotations().forEach((function(e){t.$emit(r.ANNOTATION_DELETED,e)})),p.discardAllDrafts(),i(A)?m.call(a.LOGOUT_REQUESTED):w.logout())}}t.exports={controller:l,controllerAs:"vm",template:e("../templates/hypothesis-app.html")}},{"../../shared/bridge-events":72,"../events":137,"../service-config":148,"../templates/hypothesis-app.html":190,"../ui-constants":194,"../util/account-id":195,"../util/is-sidebar":207,"../util/session":219}],101:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("../util/service-context").withServices,a=e("./svg-icon");function s(e){var t=e.onLogin,n=e.serviceUrl;return o("div",{className:"logged-out-message"},o("span",null,"This is a public annotation created with Hypothesis. ",o("br",null),"To reply or make your own annotations on this document,"," ",o("a",{className:"logged-out-message__link",href:n("signup"),target:"_blank",rel:"noopener noreferrer"},"create a free account")," ","or"," ",o("a",{className:"logged-out-message__link",href:"",onClick:t},"log in"),"."),o("div",{className:"logged-out-message__logo"},o("a",{href:"https://hypothes.is"},o(a,{name:"logo",className:"logged-out-message__logo-icon"}))))}s.propTypes={onLogin:r.func.isRequired,serviceUrl:r.func.isRequired},s.injectedProps=["serviceUrl"],t.exports=i(s)},{"../util/service-context":218,"./svg-icon":122,preact:12,"prop-types":15}],102:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("classnames"),i=e("preact").createElement,a=e("preact/hooks"),s=a.useEffect,c=a.useRef,u=a.useState,l=e("prop-types"),f=e("./markdown-view"),d=e("../markdown-commands"),p=d.LinkType,h=d.convertSelectionToLink,m=d.toggleBlockStyle,g=d.toggleSpanStyle,v=e("./svg-icon"),y={bold:"b",italic:"i",link:"l",quote:"q",image:"g",numlist:"o",list:"u"};function b(e){var t=e.disabled,n=void 0!==t&&t,r=e.iconName,a=e.label,s=void 0===a?null:a,c=e.onClick,u=e.shortcutKey,l=e.title;return u&&(l+=" (Ctrl+".concat(u.toUpperCase(),")")),i("button",{className:o("markdown-editor__toolbar-button",s&&"is-text"),disabled:n,onClick:c,title:l},r&&i(v,{name:r,className:"markdown-editor__toolbar-button-icon"}),s)}function _(e){var t=e.isPreviewing,n=e.onCommand,r=e.onTogglePreview;return i("div",{className:"markdown-editor__toolbar",role:"toolbar","aria-label":"Markdown editor toolbar"},i(b,{disabled:t,iconName:"format-bold",onClick:function(){return n("bold")},shortcutKey:y.bold,title:"Bold"}),i(b,{disabled:t,iconName:"format-italic",onClick:function(){return n("italic")},shortcutKey:y.italic,title:"Italic"}),i(b,{disabled:t,iconName:"format-quote",onClick:function(){return n("quote")},shortcutKey:y.quote,title:"Quote"}),i(b,{disabled:t,iconName:"link",onClick:function(){return n("link")},shortcutKey:y.link,title:"Insert link"}),i(b,{disabled:t,iconName:"image",onClick:function(){return n("image")},shortcutKey:y.image,title:"Insert image"}),i(b,{disabled:t,iconName:"format-functions",onClick:function(){return n("math")},title:"Insert math (LaTeX is supported)"}),i(b,{disabled:t,iconName:"format-list-numbered",onClick:function(){return n("numlist")},shortcutKey:y.numlist,title:"Numbered list"}),i(b,{disabled:t,iconName:"format-list-unordered",onClick:function(){return n("list")},shortcutKey:y.list,title:"Bulleted list"}),i("span",{className:"u-stretch"}),i("div",{className:"markdown-editor__toolbar-help-link"},i("a",{href:"https://web.hypothes.is/help/formatting-annotations-with-markdown/",target:"_blank",rel:"noopener noreferrer",className:"markdown-editor__toolbar-button",title:"Formatting help"},i(v,{name:"help",className:"markdown-editor__toolbar-button-icon"}))),i(b,{label:t?"Write":"Preview",onClick:r}))}function w(e){var t=e.onEditText,n=void 0===t?function(){}:t,o=e.text,a=void 0===o?"":o,l=r(u(!1),2),d=l[0],v=l[1],b=c(null);s((function(){d||b.current.focus()}),[d]);var w=function(e){var t=b.current;(function(e,t){var n=function(e){var n=e({text:t.value,selectionStart:t.selectionStart,selectionEnd:t.selectionEnd});t.value=n.text,t.selectionStart=n.selectionStart,t.selectionEnd=n.selectionEnd,t.focus()};switch(e){case"bold":n((function(e){return g(e,"**","**","Bold")}));break;case"italic":n((function(e){return g(e,"*","*","Italic")}));break;case"quote":n((function(e){return m(e,"> ")}));break;case"link":n((function(e){return h(e)}));break;case"image":n((function(e){return h(e,p.IMAGE_LINK)}));break;case"math":n((function(e){var t=e.text.slice(0,e.selectionStart);return 0===t.length||"\n"===t.slice(-1)||"$$"===t.slice(-2)?g(e,"$$","$$","Insert LaTeX"):g(e,"\\(","\\)","Insert LaTeX")}));break;case"numlist":n((function(e){return m(e,"1. ")}));break;case"list":n((function(e){return m(e,"* ")}));break;default:throw new Error('Unknown toolbar command "'.concat(e,'"'))}})(e,t),n({text:t.value})};return i("div",null,i(_,{onCommand:w,isPreviewing:d,onTogglePreview:function(){return v(!d)}}),d?i(f,{textClass:{"markdown-editor__preview":!0},markdown:a}):i("textarea",{className:"markdown-editor__input form-input form-textarea",ref:b,onClick:function(e){return e.stopPropagation()},onKeydown:function(e){if(e.ctrlKey)for(var t=0,n=Object.entries(y);t<n.length;t++){var o=r(n[t],2),i=o[0];o[1]===e.key&&(e.stopPropagation(),e.preventDefault(),w(i))}},onInput:function(e){return n({text:e.target.value})},value:a}))}b.propTypes={disabled:l.bool,iconName:l.string,label:l.string,onClick:l.func,shortcutKey:l.string,title:l.string},_.propTypes={isPreviewing:l.bool,onCommand:l.func,onTogglePreview:l.func},w.propTypes={text:l.string,onEditText:l.func},t.exports=w},{"../markdown-commands":144,"./markdown-view":103,"./svg-icon":122,classnames:2,preact:12,"preact/hooks":13,"prop-types":15}],103:[function(e,t,n){"use strict";var r=e("classnames"),o=e("preact").createElement,i=e("preact/hooks"),a=i.useEffect,s=i.useMemo,c=i.useRef,u=e("prop-types"),l=e("../media-embedder").replaceLinksWithEmbeds,f=e("../render-markdown");function d(e){var t=e.markdown,n=void 0===t?"":t,i=e.textClass,u=void 0===i?{}:i,d=s((function(){return n?f(n):""}),[n]),p=c(null);return a((function(){l(p.current)}),[n]),o("div",{className:r("markdown-view",u),ref:p,dangerouslySetInnerHTML:{__html:d}})}d.propTypes={markdown:u.string,textClass:u.object},t.exports=d},{"../media-embedder":145,"../render-markdown":146,classnames:2,preact:12,"preact/hooks":13,"prop-types":15}],104:[function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var o=e("classnames"),i=e("preact").createElement,a=e("prop-types"),s=e("../util/on-activate").onActivate,c=e("./slider"),u=e("./svg-icon");function l(e){var t=e.href,n=e.icon,a=e.iconAlt,l=e.isDisabled,f=e.isExpanded,d=e.isSelected,p=e.isSubmenuItem,h=e.isSubmenuVisible,m=e.label,g=e.onClick,v=e.onToggleSubmenu,y=e.submenu,b=n&&-1!==n.indexOf("/"),_=o("menu-item__label",{"menu-item__label--submenu":p}),w=n||p,A=n&&p,T=null;"blank"!==n&&(T=b?i("img",{className:"menu-item__icon",alt:a,src:n}):i(u,{name:n,className:"menu-item__icon"}));var E=p?null:T,S=p?T:null;return i("div",null,i("div",r({"aria-checked":d,className:o("menu-item",{"menu-item--submenu":p,"is-disabled":l,"is-expanded":f,"is-selected":d}),role:"menuitem"},g&&s("menuitem",g)),i("div",{className:"menu-item__action"},w&&i("div",{className:"menu-item__icon-container"},E),t&&i("a",{className:_,href:t,target:"_blank",rel:"noopener noreferrer"},m),!t&&i("span",{className:_},m),A&&i("div",{className:"menu-item__icon-container"},S)),"boolean"==typeof h&&i("div",r({className:"menu-item__toggle","aria-expanded":h?"true":"false","aria-label":"Show actions for ".concat(m)},s("button",v)),i(u,{name:h?"collapse-menu":"expand-menu",className:"menu-item__toggle-icon"}))),"boolean"==typeof h&&i(c,{visible:h},i("div",{className:"menu-item__submenu"},y)))}l.propTypes={href:a.string,iconAlt:a.string,icon:a.string,isDisabled:a.bool,isExpanded:a.bool,isSelected:a.bool,isSubmenuItem:a.bool,isSubmenuVisible:a.bool,label:a.string.isRequired,onClick:a.func,onToggleSubmenu:a.func,submenu:a.any},t.exports=l},{"../util/on-activate":212,"./slider":117,"./svg-icon":122,classnames:2,preact:12,"prop-types":15}],105:[function(e,t,n){"use strict";var r=e("preact"),o=r.Fragment,i=r.createElement,a=r.toChildArray,s=e("prop-types");function c(e){var t=e.heading,n=e.children;return i(o,null,t&&i("h2",{className:"menu-section__heading"},t),i("ul",{className:"menu-section__content"},a(n).map((function(e){return i("li",{key:e.key},e)}))))}c.propTypes={heading:s.string,children:s.oneOfType([s.object,s.arrayOf(s.object)]).isRequired},t.exports=c},{preact:12,"prop-types":15}],106:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("classnames"),i=e("preact"),a=i.Fragment,s=i.createElement,c=e("preact/hooks"),u=c.useCallback,l=c.useEffect,f=c.useRef,d=c.useState,p=e("prop-types"),h=e("./hooks/use-element-should-close"),m=e("./svg-icon"),g=function(e){return s("svg",{className:o("menu__arrow",e),width:15,height:8},s("path",{d:"M0 8 L7 0 L15 8",stroke:"currentColor",strokeWidth:"2"}))},v=!1;function y(e){var t=e.align,n=void 0===t?"left":t,i=e.arrowClass,c=void 0===i?"":i,p=e.children,y=e.containerPositioned,b=void 0===y||y,_=e.contentClass,w=e.defaultOpen,A=void 0!==w&&w,T=e.label,E=e.onOpenChanged,S=e.menuIndicator,O=void 0===S||S,k=e.title,x=r(d(A),2),N=x[0],C=x[1],j=f(N);l((function(){"function"==typeof E&&j.current!==N&&(j.current=N,E(N))}),[N,E]);var D=function(e){if("mousedown"===e.type)v=!0;else if("click"===e.type&&v)return v=!1,e.stopPropagation(),void e.preventDefault();C(!N)},I=u((function(){return C(!1)}),[C]),L=f();h(L,N,I);var P=function(e){return e.stopPropagation()};return s("div",{className:"menu",ref:L,style:{position:b?"relative":"static"},onClick:P,onMouseDown:P},s("button",{"aria-expanded":N?"true":"false","aria-haspopup":!0,className:"menu__toggle",onMouseDown:D,onClick:D,title:k},T,O&&s("span",{className:o("menu__toggle-arrow",N&&"is-open")},s(m,{name:"expand-menu",className:"menu__toggle-icon"}))),N&&s(a,null,g(c),s("div",{className:o("menu__content","menu__content--align-".concat(n),_),role:"menu",onClick:I,onKeyPress:function(e){"Enter"!==e.key&&" "!==e.key||I()}},p)))}y.propTypes={align:p.oneOf(["left","right"]),arrowClass:p.string,label:p.oneOfType([p.object.isRequired,p.string.isRequired]),children:p.any,containerPositioned:p.bool,contentClass:p.string,defaultOpen:p.bool,onOpenChanged:p.func,title:p.string.isRequired,menuIndicator:p.bool},t.exports=y},{"./hooks/use-element-should-close":99,"./svg-icon":122,classnames:2,preact:12,"preact/hooks":13,"prop-types":15}],107:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("classnames"),i=e("prop-types"),a=e("../util/annotation-metadata"),s=e("../store/use-store"),c=e("../util/service-context").withServices;function u(e){var t,n=e.annotation,i=e.api,c=e.flash,u=s((function(e){return{hide:e.hideAnnotation,unhide:e.unhideAnnotation}})),l=a.flagCount(n),f=null!==l&&(l>0||n.hidden),d=(t={},n.hidden?(t.onClick=function(){i.annotation.unhide({id:n.id}).then((function(){u.unhide(n.id)})).catch((function(){c.error("Failed to unhide annotation")}))},t.title="Make this annotation visible to everyone"):(t.onClick=function(){i.annotation.hide({id:n.id}).then((function(){u.hide(n.id)})).catch((function(){c.error("Failed to hide annotation")}))},t.title="Hide this annotation from non-moderators"),t),p=o("moderation-banner",{"is-flagged":l>0,"is-hidden":n.hidden,"is-reply":a.isReply(n)});return f?r("div",{className:p},!!l&&!n.hidden&&r("span",null,"Flagged for review x",l),n.hidden&&r("span",null,"Hidden from users. Flagged x",l),r("span",{className:"u-stretch"}),r("button",d,n.hidden?"Unhide":"Hide")):null}u.propTypes={annotation:i.object.isRequired,api:i.object.isRequired,flash:i.object.isRequired},u.injectedProps=["api","flash"],t.exports=c(u)},{"../store/use-store":185,"../util/annotation-metadata":196,"../util/service-context":218,classnames:2,preact:12,"prop-types":15}],108:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("prop-types"),i=e("../events"),a=e("../store/use-store"),s=e("../util/theme").applyTheme,c=e("../util/service-context").withServices;function u(e){var t=e.$rootScope,n=e.settings,o=a((function(e){return{frames:e.frames()}}));return r("button",{style:s(["ctaBackgroundColor"],n),className:"new-note__create",onClick:function(){var e={target:[],uri:o.frames.find((function(e){return!e.id})).uri};t.$broadcast(i.BEFORE_ANNOTATION_CREATED,e)}},"+ New note")}u.propTypes={$rootScope:o.object.isRequired,settings:o.object.isRequired},u.injectedProps=["$rootScope","settings"],t.exports=c(u)},{"../events":137,"../store/use-store":185,"../util/service-context":218,"../util/theme":222,preact:12,"prop-types":15}],109:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("classnames"),i=e("preact").createElement,a=e("preact/hooks"),s=a.useRef,c=a.useState,u=e("prop-types"),l=e("../store/use-store"),f=e("./button"),d=e("./spinner");function p(e){var t=e.alwaysExpanded,n=e.query,a=e.onSearch,u=l((function(e){return e.isLoading()})),p=s(),h=r(c(n),2),m=h[0],g=h[1],v=r(c(n),2),y=v[0],b=v[1];return n!==m&&(b(n),g(n)),i("form",{action:"#",className:"search-input__form",name:"searchForm",onSubmit:function(e){e.preventDefault(),a(p.current.value)}},i("input",{className:o("search-input__input",{"is-expanded":t||n}),type:"text",name:"query",placeholder:u?"Loading":"Search",disabled:u,ref:p,value:y,onInput:function(e){return b(e.target.value)}}),!u&&i(f,{className:"search-input__icon-button top-bar__icon-button",icon:"search",onClick:function(){return p.current.focus()},title:"Search annotations",useCompactStyle:!0}),u&&i(d,{className:"top-bar__btn",title:"Loading"}))}p.propTypes={alwaysExpanded:u.bool,query:u.string,onSearch:u.func},t.exports=p},{"../store/use-store":185,"./button":92,"./spinner":119,classnames:2,preact:12,"preact/hooks":13,"prop-types":15}],110:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("prop-types"),i=e("preact/hooks").useMemo,a=e("../util/service-context").withServices,s=e("../ui-constants"),c=e("../store/use-store"),u=e("./button"),l=function e(t){return t.children.reduce((function(t,n){return t+e(n)}),t.visible?1:0)};function f(e){var t=e.rootThread,n=c((function(e){return t.thread(e.getState())})),o=c((function(e){return{clearSelection:e.clearSelection}})),a=c((function(e){return{annotations:e.annotationCount(),notes:e.noteCount()}})),f=c((function(e){return{directLinkedGroupFetchFailed:e.getState().directLinked.directLinkedGroupFetchFailed,filterQuery:e.getState().selection.filterQuery,focusModeFocused:e.focusModeFocused(),focusModeUserPrettyName:e.focusModeUserPrettyName(),selectionMap:e.getState().selection.selectedAnnotationMap,selectedTab:e.getState().selection.selectedTab}})),d=f.directLinkedGroupFetchFailed,p=f.filterQuery,h=f.focusModeFocused,m=f.focusModeUserPrettyName,g=f.selectionMap,v=f.selectedTab,y={filtered:!!p,focused:h&&!p,selected:!!d||!!g&&Object.keys(g).length>0&&!p},b=i((function(){return l(n)}),[n]),_={filtered:function(){switch(b){case 0:return'No results for "'.concat(p,'"');case 1:return"1 search result";default:return"".concat(b," search results")}}(),focused:function(){switch(b){case 0:return"No annotations for ".concat(m);case 1:return"Showing 1 annotation";default:return"Showing ".concat(b," annotations")}}(),selected:function(){var e;switch(v){case s.TAB_ORPHANS:e="Show all annotations and notes";break;case s.TAB_NOTES:e="Show all notes",a.notes>1&&!y.focused?e+=" (".concat(a.notes,")"):y.focused&&(e+=" by ".concat(m));break;case s.TAB_ANNOTATIONS:e="Show all annotations",a.annotations>1&&!y.focused?e+=" (".concat(a.annotations,")"):y.focused&&(e="Show all annotations by ".concat(m))}return e}()};return r("div",null,y.filtered&&r("div",{className:"search-status-bar"},r(u,{icon:"cancel",buttonText:"Clear search",onClick:o.clearSelection,useCompactStyle:!0,usePrimaryStyle:!0}),r("span",{className:"search-status-bar__filtered-text"},_.filtered)),y.focused&&r("div",{className:"search-status-bar"},r("span",{className:"search-status-bar__focused-text"},r("strong",null,_.focused))),y.selected&&r("div",{className:"search-status-bar"},r(u,{buttonText:_.selected,onClick:o.clearSelection,useCompactStyle:!0,usePrimaryStyle:!0})))}f.propTypes={rootThread:o.object.isRequired},f.injectedProps=["rootThread"],t.exports=a(f)},{"../store/use-store":185,"../ui-constants":194,"../util/service-context":218,"./button":92,preact:12,"preact/hooks":13,"prop-types":15}],111:[function(e,t,n){"use strict";var r=e("classnames"),o=e("prop-types"),i=e("preact").createElement,a=e("preact").Fragment,s=e("./new-note-btn"),c=e("../util/session"),u=e("../ui-constants"),l=e("../store/use-store"),f=e("../util/service-context").withServices;function d(e){var t=e.children,n=e.count,o=e.isWaitingToAnchor,a=e.onChangeTab,s=e.selected,c=e.type;return i("a",{className:r("selection-tabs__type",{"is-selected":s}),onMouseDown:a.bind(this,c),onTouchStart:a.bind(this,c),role:"tab",tabIndex:"0","aria-selected":s},t,n>0&&!o&&i("span",{className:"selection-tabs__count"}," ",n))}function p(e){var t=e.isLoading,n=e.settings,o=e.session,f=l((function(e){return e.getState().selection.selectedTab})),p=l((function(e){return e.noteCount()})),h=l((function(e){return e.annotationCount()})),m=l((function(e){return e.orphanCount()})),g=l((function(e){return e.isWaitingToAnchorAnnotations()})),v=l((function(e){return{clearSelectedAnnotations:e.clearSelectedAnnotations,selectTab:e.selectTab}})),y="clean"===n.theme,b=function(e){v.clearSelectedAnnotations(),v.selectTab(e)},_=f===u.TAB_ANNOTATIONS&&0===h&&!g,w=f===u.TAB_NOTES&&0===p,A=c.shouldShowSidebarTutorial(o.state);return i(a,null,i("div",{className:r("selection-tabs",{"selection-tabs--theme-clean":y}),role:"tablist"},i(d,{count:h,isWaitingToAnchor:g,selected:f===u.TAB_ANNOTATIONS,type:u.TAB_ANNOTATIONS,onChangeTab:b},"Annotations"),i(d,{count:p,isWaitingToAnchor:g,selected:f===u.TAB_NOTES,type:u.TAB_NOTES,onChangeTab:b},"Page Notes"),m>0&&i(d,{count:m,isWaitingToAnchor:g,selected:f===u.TAB_ORPHANS,type:u.TAB_ORPHANS,onChangeTab:b},"Orphans")),f===u.TAB_NOTES&&n.enableExperimentalNewNoteButton&&i(s,null),!t&&i("div",{className:"selection-tabs__empty-message"},w&&i("div",{className:"annotation-unavailable-message"},i("p",{className:"annotation-unavailable-message__label"},"There are no page notes in this group.",n.enableExperimentalNewNoteButton&&!A&&i("div",{className:"annotation-unavailable-message__tutorial"},"Create one by clicking the"," ",i("i",{className:"help-icon h-icon-note"})," button."))),_&&i("div",{className:"annotation-unavailable-message"},i("p",{className:"annotation-unavailable-message__label"},"There are no annotations in this group.",!A&&i("div",{className:"annotation-unavailable-message__tutorial"},"Create one by selecting some text and clicking the"," ",i("i",{className:"help-icon h-icon-annotate"})," button.")))))}d.propTypes={children:o.node.isRequired,count:o.number.isRequired,isWaitingToAnchor:o.bool.isRequired,onChangeTab:o.func.isRequired,selected:o.bool.isRequired,type:o.oneOf(["annotation","note","orphan"]).isRequired},p.propTypes={isLoading:o.bool.isRequired,settings:o.object.isRequired,session:o.object.isRequired},p.injectedProps=["session","settings"],t.exports=f(p)},{"../store/use-store":185,"../ui-constants":194,"../util/service-context":218,"../util/session":219,"./new-note-btn":108,classnames:2,preact:12,"prop-types":15}],112:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("../store/use-store"),a=e("../util/copy-to-clipboard").copyText,s=e("../util/service-context").withServices,c=e("../ui-constants"),u=e("./button"),l=e("./share-links"),f=e("./sidebar-panel"),d=e("./svg-icon");function p(e){var t,n=e.analytics,r=e.flash,s=i((function(e){return e.mainFrame()})),p=i((function(e){return e.focusedGroup()})),h=p&&s,m=p&&p.name||"...",g="Share Annotations in ".concat(m),v=(t=p,h?"https://hyp.is/go?url=".concat(encodeURIComponent(s.uri),"&group=").concat(t.id):"");return o(f,{title:g,panelName:c.PANEL_SHARE_ANNOTATIONS},h&&o("div",{className:"share-annotations-panel"},o("div",{className:"share-annotations-panel__intro"},"private"===p.type?o("p",null,"Use this link to share these annotations with other group members:"):o("p",null,"Use this link to share these annotations with anyone:")),o("div",{className:"share-annotations-panel__input"},o("input",{"aria-label":"Use this URL to share these annotations",className:"form-input share-annotations-panel__form-input",type:"text",value:v,readOnly:!0}),o(u,{icon:"copy",onClick:function(){try{a(v),r.info("Copied share link to clipboard")}catch(e){r.error("Unable to copy link")}},title:"Copy share link",useInputStyle:!0})),o("p",null,"private"===p.type?o("span",null,"Annotations in the private group ",o("em",null,p.name)," ","are only visible to group members."):o("span",null,"Anyone using this link may view the annotations in the group"," ",o("em",null,p.name),".")," ",o("span",null,"Private (",o(d,{name:"lock",inline:!0,className:"share-annotations-panel__icon--inline"})," ",o("em",null,"Only Me"),") annotations are only visible to you.")),o(l,{shareURI:v,analyticsEventName:n.events.DOCUMENT_SHARED})))}p.propTypes={analytics:r.object.isRequired,flash:r.object.isRequired},p.injectedProps=["analytics","flash"],t.exports=s(p)},{"../store/use-store":185,"../ui-constants":194,"../util/copy-to-clipboard":199,"../util/service-context":218,"./button":92,"./share-links":113,"./sidebar-panel":116,"./svg-icon":122,preact:12,"prop-types":15}],113:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("../util/service-context").withServices,a=e("./svg-icon");function s(e){var t=e.iconName,n=e.title,r=e.uri,i=e.onClick;return o("li",{className:"share-links__link"},o("a",{href:r,title:n,onClick:i,target:"_blank",rel:"noopener noreferrer"},o(a,{name:t,className:"share-links__icon"})))}function c(e){var t=e.analytics,n=e.analyticsEventName,r=e.shareURI,i=function(e){return function(){t.track(n,e)}},a=encodeURIComponent(r);return o("ul",{className:"share-links"},o(s,{iconName:"twitter",title:"Tweet share link",uri:"https://twitter.com/intent/tweet?url=".concat(a,"&hashtags=annotated"),onClick:i("twitter")}),o(s,{iconName:"facebook",title:"Share on Facebook",uri:"https://www.facebook.com/sharer/sharer.php?u=".concat(a),onClick:i("facebook")}),o(s,{iconName:"email",title:"Share via email",uri:"mailto:?subject=".concat(encodeURIComponent("Let's Annotate"),"&body=").concat(a),onClick:i("email")}))}s.propTypes={iconName:r.string.isRequired,title:r.string.isRequired,uri:r.string.isRequired,onClick:r.func.isRequired},c.propTypes={analyticsEventName:r.string.isRequired,shareURI:r.string.isRequired,analytics:r.object.isRequired},c.injectedProps=["analytics"],t.exports=i(c)},{"../util/service-context":218,"./svg-icon":122,preact:12,"prop-types":15}],114:[function(e,t,n){"use strict";var r=e("preact"),o=r.Fragment,i=r.createElement,a=e("prop-types");function s(e){var t=e.loggedOutErrorMessage,n=e.loggedInErrorMessage,r=e.onLoginRequest,a=e.isLoggedIn;return i("div",{className:"annotation-unavailable-message"},i("div",{className:"annotation-unavailable-message__icon"}),i("p",{className:"annotation-unavailable-message__label"},a?i("span",null,n):i(o,null,t,i("br",null),"You may need to"," ",i("a",{className:"loggedout-message__link",href:"",onClick:r},"log in")," ","to see it.")))}s.propTypes={loggedOutErrorMessage:a.string,loggedInErrorMessage:a.string,onLoginRequest:a.func.isRequired,isLoggedIn:a.bool},t.exports=s},{preact:12,"prop-types":15}],115:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}c.$inject=["$scope","analytics","annotations","store","frameSync","rootThread","settings","streamer"];var i=e("../events"),a=e("../util/is-third-party-service"),s=e("../util/tabs");function c(e,t,n,c,u,l,f,d){var p=this,h=this;function m(e){var t=[];e&&(t=[e.$tag]),u.focusAnnotations(t)}function g(e){e&&u.scrollToAnnotation(e.$tag)}this.rootThread=function(){return l.thread(c.getState())},this.isLoading=function(){return!c.frames().some((function(e){return e.uri}))||c.isFetchingAnnotations()},e.$on("sidebarOpened",(function(){t.track(t.events.SIDEBAR_OPENED),d.connect()})),this.$onInit=function(){"logged-in"===p.auth.status&&d.connect()},e.$on(i.USER_CHANGED,(function(){d.reconnect()})),e.$on(i.ANNOTATIONS_SYNCED,(function(e,t){var n=function(){if(c.getState().selection.selectedAnnotationMap){var e=Object.keys(c.getState().selection.selectedAnnotationMap)[0];return c.getState().annotations.annotations.find((function(t){return t.id===e}))}return null}();n&&t.some((function(e){return e===n.$tag}))&&(m(n),g(n),c.selectTab(s.tabForAnnotation(n)))})),e.$watch((function(){return[c.focusedGroupId(),c.profile().userid].concat(o(c.searchUris()))}),(function(e,t){var o=r(e,1)[0],i=r(t,1)[0];if(o){i&&o===i||c.clearSelectedAnnotations();var a=c.searchUris();n.load(a,o)}else c.clearSelectedAnnotations()}),!0),this.showFocusedHeader=function(){return c.focusModeEnabled()},this.showSelectedTabs=function(){return!(this.selectedAnnotationUnavailable()||this.selectedGroupUnavailable()||c.getState().selection.filterQuery||c.focusModeFocused())},this.setCollapsed=function(e,t){c.setCollapsed(e,t)},this.focus=m,this.scrollTo=g,this.selectedGroupUnavailable=function(){return c.getState().directLinked.directLinkedGroupFetchFailed},this.selectedAnnotationUnavailable=function(){var e=c.getFirstSelectedAnnotationId();return!this.isLoading()&&!!e&&!c.annotationExists(e)},this.shouldShowLoggedOutMessage=function(){if("logged-out"!==h.auth.status)return!1;if(!c.getState().directLinked.directLinkedAnnotationId)return!1;if(a(f))return!1;var e=c.getFirstSelectedAnnotationId();return!c.isFetchingAnnotations()&&!!e&&c.annotationExists(e)}}t.exports={controller:c,controllerAs:"vm",bindings:{auth:"<",onLogin:"&"},template:e("../templates/sidebar-content.html")}},{"../events":137,"../templates/sidebar-content.html":191,"../util/is-third-party-service":208,"../util/tabs":221}],116:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("preact/hooks"),a=i.useEffect,s=i.useRef,c=e("scroll-into-view"),u=e("../store/use-store"),l=e("./button"),f=e("./slider");function d(e){var t=e.children,n=e.panelName,r=e.title,i=e.onActiveChanged,d=u((function(e){return e.isSidebarPanelOpen(n)})),p=u((function(e){return e.toggleSidebarPanel})),h=s(),m=s(d);return a((function(){m.current!==d&&(m.current=d,d&&c(h.current),"function"==typeof i&&i(d))}),[d,i]),o(f,{visible:d},o("div",{className:"sidebar-panel",ref:h},o("div",{className:"sidebar-panel__header"},o("div",{className:"sidebar-panel__title u-stretch"},r),o("div",null,o(l,{icon:"cancel",buttonText:"Close",onClick:function(){p(n,!1)},useCompactStyle:!0}))),o("div",{className:"sidebar-panel__content"},t)))}d.propTypes={children:r.any,panelName:r.string.isRequired,title:r.string.isRequired,onActiveChanged:r.func},t.exports=d},{"../store/use-store":185,"./button":92,"./slider":117,preact:12,"preact/hooks":13,"prop-types":15,"scroll-into-view":24}],117:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("prop-types"),i=e("preact").createElement,a=e("preact/hooks"),s=a.useCallback,c=a.useEffect,u=a.useRef,l=a.useState;function f(e){var t=e.children,n=e.visible,o=u(null),a=r(l(n?"auto":0),2),f=a[0],d=a[1],p=r(l(n),2),h=p[0],m=p[1];c((function(){if(n!==(0!==f)){var e=o.current;n?(e.style.display="",m(!0),d(e.scrollHeight)):(e.style.height="".concat(e.scrollHeight,"px"),e.getBoundingClientRect(),d(0))}}),[f,n]);var g=s((function(){n?d("auto"):m(!1)}),[d,n]);return i("div",{ontransitionend:g,ref:o,style:{display:h?"":"none",height:f,overflow:"hidden",transition:"height 0.15s ease-in"}},t)}f.propTypes={children:o.any,visible:o.bool},t.exports=f},{preact:12,"preact/hooks":13,"prop-types":15}],118:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("../store/use-store"),i=e("./button"),a=e("./menu"),s=e("./menu-item");function c(){var e=o((function(e){return{setSortKey:e.setSortKey}})),t=o((function(e){return e.getState().selection.sortKey})),n=o((function(e){return e.getState().selection.sortKeysAvailable})).map((function(n){return r(s,{key:n,label:n,onClick:function(){return e.setSortKey(n)},isSelected:n===t},n)})),c=r(i,{className:"top-bar__icon-button",icon:"sort",title:"Sort annotations",useCompactStyle:!0});return r("div",{className:"sort-menu"},r(a,{label:c,title:"Sort by ".concat(t),align:"right",menuIndicator:!1},n))}c.propTypes={},t.exports=c},{"../store/use-store":185,"./button":92,"./menu":106,"./menu-item":104,preact:12}],119:[function(e,t,n){"use strict";var r=e("preact").createElement;function o(){return r("div",{className:"spinner__container"},r("span",{className:"spinner"},r("span",null,r("span",null))))}o.propTypes={},t.exports=o},{preact:12}],120:[function(e,t,n){"use strict";function r(e,t,n,r,o,i,a,s){o.setAppIsSidebar(!1);var c=0,u=function(e){c+=e.rows.length,r.loadAnnotations(e.rows,e.replies)},l=function(e){var t=Object.assign({_separate_replies:!0,offset:c,limit:e},s.toObject(n.q));i.search(t).then(u).catch((function(e){console.error(e)}))},f=n.q;e.$on("$routeUpdate",(function(){n.q!==f&&(o.clearAnnotations(),t.reload())})),o.clearAnnotations(),l(20),this.setCollapsed=o.setCollapsed,this.rootThread=function(){return a.thread(o.getState())},o.setSortKey("Newest"),this.loadMore=l}r.$inject=["$scope","$route","$routeParams","annotationMapper","store","api","rootThread","searchFilter"],t.exports={controller:r,controllerAs:"vm",bindings:{},template:e("../templates/stream-content.html")}},{"../templates/stream-content.html":192}],121:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("preact").createElement,i=e("preact/hooks"),a=i.useEffect,s=i.useState,c=e("prop-types"),u=e("../util/service-context").withServices,l=e("./search-input");function f(e){var t=e.$location,n=e.$rootScope,i=r(s(t.search().q),2),c=i[0],u=i[1];return a((function(){n.$on("$locationChangeSuccess",(function(){u(t.search().q)}))})),o(l,{query:c,onSearch:function(e){n.$apply((function(){t.path("/stream").search({q:e})}))},alwaysExpanded:!0})}f.propTypes={$location:c.object,$rootScope:c.object},f.injectedProps=["$location","$rootScope"],t.exports=u(f)},{"../util/service-context":218,"./search-input":109,preact:12,"preact/hooks":13,"prop-types":15}],122:[function(e,t,n){"use strict";var r=e("classnames"),o=e("preact").createElement,i=e("preact/hooks"),a=i.useLayoutEffect,s=i.useRef,c=e("prop-types"),u={add:e("../../images/icons/add.svg"),annotate:e("../../images/icons/annotate.svg"),"arrow-left":e("../../images/icons/arrow-left.svg"),"arrow-right":e("../../images/icons/arrow-right.svg"),cancel:e("../../images/icons/cancel.svg"),"cc-std":e("../../images/icons/cc-std.svg"),"cc-zero":e("../../images/icons/cc-zero.svg"),"collapse-menu":e("../../images/icons/collapse-menu.svg"),copy:e("../../images/icons/copy.svg"),cursor:e("../../images/icons/cursor.svg"),edit:e("../../images/icons/edit.svg"),email:e("../../images/icons/email.svg"),"expand-menu":e("../../images/icons/expand-menu.svg"),external:e("../../images/icons/external.svg"),facebook:e("../../images/icons/facebook.svg"),flag:e("../../images/icons/flag.svg"),"flag--active":e("../../images/icons/flag--active.svg"),"format-bold":e("../../images/icons/format-bold.svg"),"format-functions":e("../../images/icons/format-functions.svg"),"format-italic":e("../../images/icons/format-italic.svg"),"format-list-numbered":e("../../images/icons/format-list-numbered.svg"),"format-list-unordered":e("../../images/icons/format-list-unordered.svg"),"format-quote":e("../../images/icons/format-quote.svg"),groups:e("../../images/icons/groups.svg"),help:e("../../images/icons/help.svg"),highlight:e("../../images/icons/highlight.svg"),image:e("../../images/icons/image.svg"),leave:e("../../images/icons/leave.svg"),link:e("../../images/icons/link.svg"),lock:e("../../images/icons/lock.svg"),logo:e("../../images/icons/logo.svg"),pointer:e("../../images/icons/pointer.svg"),profile:e("../../images/icons/profile.svg"),public:e("../../images/icons/public.svg"),refresh:e("../../images/icons/refresh.svg"),reply:e("../../images/icons/reply.svg"),search:e("../../images/icons/search.svg"),share:e("../../images/icons/share.svg"),sort:e("../../images/icons/sort.svg"),trash:e("../../images/icons/trash.svg"),twitter:e("../../images/icons/twitter.svg")};function l(e){var t=e.name,n=e.className,i=void 0===n?"":n,c=e.inline,l=void 0!==c&&c;if(!u[t])throw new Error("Unknown icon ".concat(t));var f={__html:u[t]},d=s();return a((function(){d.current.querySelector("svg").setAttribute("class",i)}),[i,f]),o("span",{className:r("svg-icon",{"svg-icon--inline":l}),dangerouslySetInnerHTML:f,ref:d})}l.propTypes={name:c.string,className:c.string,inline:c.bool},t.exports=l},{"../../images/icons/add.svg":31,"../../images/icons/annotate.svg":32,"../../images/icons/arrow-left.svg":33,"../../images/icons/arrow-right.svg":34,"../../images/icons/cancel.svg":35,"../../images/icons/cc-std.svg":36,"../../images/icons/cc-zero.svg":37,"../../images/icons/collapse-menu.svg":38,"../../images/icons/copy.svg":39,"../../images/icons/cursor.svg":40,"../../images/icons/edit.svg":41,"../../images/icons/email.svg":42,"../../images/icons/expand-menu.svg":43,"../../images/icons/external.svg":44,"../../images/icons/facebook.svg":45,"../../images/icons/flag--active.svg":46,"../../images/icons/flag.svg":47,"../../images/icons/format-bold.svg":48,"../../images/icons/format-functions.svg":49,"../../images/icons/format-italic.svg":50,"../../images/icons/format-list-numbered.svg":51,"../../images/icons/format-list-unordered.svg":52,"../../images/icons/format-quote.svg":53,"../../images/icons/groups.svg":54,"../../images/icons/help.svg":55,"../../images/icons/highlight.svg":56,"../../images/icons/image.svg":57,"../../images/icons/leave.svg":58,"../../images/icons/link.svg":59,"../../images/icons/lock.svg":60,"../../images/icons/logo.svg":61,"../../images/icons/pointer.svg":62,"../../images/icons/profile.svg":63,"../../images/icons/public.svg":64,"../../images/icons/refresh.svg":65,"../../images/icons/reply.svg":66,"../../images/icons/search.svg":67,"../../images/icons/share.svg":68,"../../images/icons/sort.svg":69,"../../images/icons/trash.svg":70,"../../images/icons/twitter.svg":71,classnames:2,preact:12,"preact/hooks":13,"prop-types":15}],123:[function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=e("preact").createElement,a=e("prop-types"),s=e("preact/hooks"),c=s.useMemo,u=s.useRef,l=s.useState,f=e("../util/service-context").withServices,d=e("./svg-icon"),p=0;function h(e){var t=e.onEditTags,n=e.tags,a=e.tagList,s=u(null),f=o(l(!1),2),h=f[0],m=f[1],g=o(l((function(){return++p,"tag-editor-datalist-".concat(p)})),1)[0],v=c((function(){return function(e,t){var n=[];return e.forEach((function(e){t.indexOf(e)<0&&n.push(e)})),n.sort()}(n.filter(""),a)}),[n,a]),y=function(e){n.store(e.map((function(e){return{text:e}}))),t({tags:e})},b=function(){var e=s.current.value.trim();0!==e.length&&(a.indexOf(e)>=0||(y([].concat(r(a),[e])),m(!1),s.current.value="",s.current.focus()))};return i("section",{className:"tag-editor"},i("ul",{className:"tag-editor__tag-list","aria-label":"Suggested tags for annotation"},a.map((function(e){return i("li",{key:"".concat(e),className:"tag-editor__tag-item","aria-label":"Tag: ".concat(e)},i("span",{className:"tag-editor__edit"},e),i("button",{onClick:function(){!function(e){var t=r(a),n=t.indexOf(e);t.splice(n,1),y(t)}(e)},title:"Remove Tag: ".concat(e),className:"tag-editor__delete"},i(d,{name:"cancel"})))}))),i("input",{list:g,onInput:function(e){"insertText"===e.inputType?m(!0):void 0===e.inputType||"insertReplacementText"===e.inputType?b():0===s.current.value.length&&m(!1)},onKeyPress:function(e){"Enter"!==e.key&&","!==e.key||(b(),e.preventDefault())},onKeyUp:function(e){"Enter"===e.key&&b()},ref:s,placeholder:"Add tags...",className:"tag-editor__input",type:"text"}),i("datalist",{id:g,className:"tag-editor__suggestions","aria-label":"Annotation suggestions"},h&&v.map((function(e){return i("option",{key:e,value:e})}))))}h.propTypes={onEditTags:a.func.isRequired,tagList:a.array.isRequired,tags:a.object.isRequired,serviceUrl:a.func.isRequired},h.injectedProps=["serviceUrl","tags"],t.exports=f(h)},{"../util/service-context":218,"./svg-icon":122,preact:12,"preact/hooks":13,"prop-types":15}],124:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("prop-types"),i=e("preact/hooks").useMemo,a=e("../util/account-id").isThirdPartyUser,s=e("../util/service-context").withServices;function c(e){var t=e.annotation,n=e.serviceUrl,o=e.settings,s=e.tags,c=i((function(){return!a(t.user,o.authDomain)}),[t,o]),u=function(e){return n("search.tag",{tag:e})};return r("ul",{className:"tag-list","aria-label":"Annotation tags"},s.map((function(e){return r("li",{key:e,className:"tag-list__item"},c&&r("a",{className:"tag-list__link",href:u(e),target:"_blank",rel:"noopener noreferrer","aria-label":"Tag: ".concat(e),title:"View annotations with tag: ".concat(e)},e),!c&&r("span",{className:"tag-list__text","aria-label":"Tag: ".concat(e)},e))})))}c.propTypes={annotation:o.object.isRequired,tags:o.array.isRequired,serviceUrl:o.func,settings:o.object},c.injectedProps=["serviceUrl","settings"],t.exports=s(c)},{"../util/account-id":195,"../util/service-context":218,preact:12,"preact/hooks":13,"prop-types":15}],125:[function(e,t,n){"use strict";s.$inject=["$element","$scope","settings","store","VirtualThreadList"];var r=e("../events"),o=e("../util/annotation-metadata"),i=e("../util/scope-timeout");var a={invisibleThreadFilter:function(e){return e.annotation.$highlight&&o.isNew(e.annotation)}};function s(e,t,n,s,c){var u=this,l=this;this.scrollRoot=document.querySelector(".js-thread-list-scroll-root"),this.isThemeClean="clean"===n.theme;var f,d=Object.assign({scrollRoot:this.scrollRoot},a);function p(e){l.virtualThreadList={visibleThreads:e.visibleThreads,invisibleThreads:e.invisibleThreads,offscreenUpperHeight:e.offscreenUpperHeight+"px",offscreenLowerHeight:e.offscreenLowerHeight+"px"},i(t,(function(){e.visibleThreads.forEach((function(e){var t=function(e){var t=document.getElementById(e);if(!t)return null;var n=window.getComputedStyle(t);return n?t.getBoundingClientRect().height+(parseFloat(n.marginTop)+parseFloat(n.marginBottom)):null}(e.id);t&&f.setThreadHeight(e.id,t)}))}),50)}function h(e){var t=l.scrollRoot.scrollHeight-l.scrollRoot.clientHeight;return Math.min(t,f.yOffsetOf(e))}this.$onInit=function(){p((f=new c(t,window,u.thread,d)).calculateVisibleThreads()),f.on("changed",p)},t.$on(r.BEFORE_ANNOTATION_CREATED,(function(e,n){n.$highlight||o.isReply(n)||(s.clearSelection(),function e(n){var r=h(n);l.scrollRoot.scrollTop=r,i(t,(function(){h(n)!==r&&e(n)}),200)}(n.$tag))})),this.$onChanges=function(e){e.thread&&f&&f.setRootThread(e.thread.currentValue)},this.$onDestroy=function(){f.detach()}}t.exports={controller:s,controllerAs:"vm",bindings:{thread:"<",showDocumentInfo:"<",onFocus:"&",onSelect:"&",onChangeCollapsed:"&"},template:e("../templates/thread-list.html")}},{"../events":137,"../templates/thread-list.html":193,"../util/annotation-metadata":196,"../util/scope-timeout":216}],126:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("prop-types"),i=e("preact").createElement,a=e("preact/hooks"),s=a.useEffect,c=a.useMemo,u=a.useState,l=e("../util/date").format,f=e("../util/time"),d=f.decayingInterval,p=f.toFuzzyString;function h(e){var t=e.className,n=e.href,o=e.timestamp,a=r(u(new Date),2),f=a[0],h=a[1],m=c((function(){return p(o?new Date(o):null,f)}),[o,f]),g=c((function(){return l(new Date(o))}),[o]);return s((function(){return d(o,(function(){return h(new Date)}))}),[o]),n?i("a",{className:t,target:"_blank",rel:"noopener noreferrer",title:g,href:n},m):i("span",{className:t,title:g},m)}h.propTypes={className:o.string,href:o.string,timestamp:o.string.isRequired},t.exports=h},{"../util/date":200,"../util/time":223,preact:12,"preact/hooks":13,"prop-types":15}],127:[function(e,t,n){"use strict";var r=e("preact"),o=r.Fragment,i=r.createElement,a=e("classnames"),s=e("prop-types"),c=e("../../shared/bridge-events"),u=e("../store/use-store"),l=e("../util/theme").applyTheme,f=e("../util/is-third-party-service"),d=e("../service-config"),p=e("../util/service-context").withServices,h=e("../ui-constants"),m=e("./button"),g=e("./group-list"),v=e("./search-input"),y=e("./stream-search-input"),b=e("./sort-menu"),_=e("./user-menu");function w(e){var t=e.auth,n=e.bridge,r=e.isSidebar,s=e.onLogin,p=e.onLogout,w=e.onSignUp,A=e.settings,T=e.streamer,E="clean"===A.theme,S=!f(A),O=l(["accentColor"],A),k=u((function(e){return e.filterQuery()})),x=u((function(e){return e.setFilterQuery})),N=u((function(e){return e.pendingUpdateCount()})),C=u((function(e){return e.toggleSidebarPanel})),j=u((function(e){return e.getState().sidebarPanels.activePanelName})),D=function(){(d(A)||{}).onHelpRequestProvided?n.call(c.HELP_REQUESTED):C(h.PANEL_HELP)},I=i(o,null,"unknown"===t.status&&i("span",{className:"top-bar__login-links"},""),"logged-out"===t.status&&i("span",{className:"top-bar__login-links"},i("a",{href:"#",onClick:w,target:"_blank",style:O},"Sign up")," ","/"," ",i("a",{href:"#",onClick:s,style:O},"Log in")),"logged-in"===t.status&&i(_,{auth:t,onLogout:p}));return i("div",{className:a("top-bar",E&&"top-bar--theme-clean")},!r&&i("div",{className:"top-bar__inner content"},i(y,null),i("div",{className:"top-bar__expander"}),i(m,{className:"top-bar__icon-button",icon:"help",isActive:j===h.PANEL_HELP,onClick:D,title:"Help",useCompactStyle:!0}),I),r&&i("div",{className:"top-bar__inner content"},i(g,{className:"GroupList",auth:t}),i("div",{className:"top-bar__expander"}),N>0&&i(m,{className:"top-bar__icon-button top-bar__icon-button--refresh",icon:"refresh",onClick:function(){return T.applyPendingUpdates()},title:"Show ".concat(N," new/updated ").concat(1===N?"annotation":"annotations"),useCompactStyle:!0}),i(v,{query:k,onSearch:x}),i(b,null),S&&i(m,{className:"top-bar__icon-button",icon:"share",isActive:j===h.PANEL_SHARE_ANNOTATIONS,onClick:function(){C(h.PANEL_SHARE_ANNOTATIONS)},title:"Share annotations on this page",useCompactStyle:!0}),i(m,{className:"top-bar__icon-button",icon:"help",isActive:j===h.PANEL_HELP,onClick:D,title:"Help",useCompactStyle:!0}),I))}w.propTypes={auth:s.shape({status:s.string.isRequired,displayName:s.string,userid:s.string,username:s.string}),bridge:s.object.isRequired,isSidebar:s.bool,onLogin:s.func,onLogout:s.func,onSignUp:s.func,settings:s.object,streamer:s.object},w.injectedProps=["bridge","settings","streamer"],t.exports=p(w)},{"../../shared/bridge-events":72,"../service-config":148,"../store/use-store":185,"../ui-constants":194,"../util/is-third-party-service":208,"../util/service-context":218,"../util/theme":222,"./button":92,"./group-list":97,"./search-input":109,"./sort-menu":118,"./stream-search-input":121,"./user-menu":129,classnames:2,preact:12,"prop-types":15}],128:[function(e,t,n){"use strict";var r=e("preact").createElement,o=e("prop-types"),i=e("../util/service-context").withServices,a=e("../util/is-third-party-service"),s=e("./svg-icon");function c(e){var t=e.commandName,n=e.iconName;return r("span",{className:"tutorial__instruction"},r(s,{name:n,inline:!0,className:"tutorial__icon"}),r("em",null,t))}function u(e){var t=e.settings,n=!a(t);return r("ol",{className:"tutorial__list"},r("li",{className:"tutorial__item"},"To create an annotation, select text and click the"," ",r(c,{iconName:"annotate",commandName:"Annotate"})," ","button."),r("li",{className:"tutorial__item"},"To create a highlight (",r("a",{href:"https://web.hypothes.is/help/why-are-highlights-private-by-default/",target:"_blank",rel:"noopener noreferrer"},"visible only to you"),"), select text and click the"," ",r(c,{iconName:"highlight",commandName:"Highlight"})," ","button."),n&&r("li",{className:"tutorial__item"},"To annotate in a private group, select the group from the groups dropdown. Don't see your group? Ask the group creator to send a"," ",r("a",{href:"https://web.hypothes.is/help/how-to-join-a-private-group/",target:"_blank",rel:"noopener noreferrer"},"join link"),")."),r("li",{className:"tutorial__item"},"To reply to an annotation, click the"," ",r(c,{iconName:"reply",commandName:"Reply"})," button."))}c.propTypes={commandName:o.string.isRequired,iconName:o.string.isRequired},u.propTypes={settings:o.object.isRequired},u.injectedProps=["settings"],t.exports=i(u)},{"../util/is-third-party-service":208,"../util/service-context":218,"./svg-icon":122,preact:12,"prop-types":15}],129:[function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var o=e("preact").createElement,i=e("prop-types"),a=e("../../shared/bridge-events"),s=e("../util/account-id").isThirdPartyUser,c=e("../service-config"),u=e("../util/service-context").withServices,l=e("./button"),f=e("./menu"),d=e("./menu-section"),p=e("./menu-item");function h(e){var t,n=e.auth,i=e.bridge,u=e.onLogout,h=e.serviceUrl,m=e.settings,g=s(n.userid,m.authDomain),v=c(m),y=function(e){return v&&!!v[e]},b=!g||y("onProfileRequestProvided"),_=!g||y("onLogoutRequestProvided"),w=(t={},b&&(g||(t.href=h("user",{user:n.username})),t.onClick=function(){return g&&i.call(a.PROFILE_REQUESTED)}),t),A=o(l,{className:"top-bar__icon-button",icon:"profile",title:"User menu",useCompactStyle:!0});return o("div",{className:"user-menu"},o(f,{label:A,title:n.displayName,align:"right"},o(d,null,o(p,r({label:n.displayName,isDisabled:!b},w)),!g&&o(p,{label:"Account settings",href:h("account.settings")})),_&&o(d,null,o(p,{label:"Log out",onClick:u}))))}h.propTypes={auth:i.object.isRequired,onLogout:i.func.isRequired,bridge:i.object.isRequired,serviceUrl:i.func.isRequired,settings:i.object.isRequired},h.injectedProps=["bridge","serviceUrl","settings"],t.exports=u(h)},{"../../shared/bridge-events":72,"../service-config":148,"../util/account-id":195,"../util/service-context":218,"./button":92,"./menu":106,"./menu-item":104,"./menu-section":105,preact:12,"prop-types":15}],130:[function(e,t,n){"use strict";var r=e("prop-types"),o=e("preact").createElement,i=e("../util/copy-to-clipboard").copyText,a=e("../util/service-context").withServices,s=e("./button");function c(e){var t=e.flash,n=e.versionData;return o("div",null,o("dl",{className:"version-info"},o("dt",{className:"version-info__key"},"Version"),o("dd",{className:"version-info__value"},n.version),o("dt",{className:"version-info__key"},"User Agent"),o("dd",{className:"version-info__value"},n.userAgent),o("dt",{className:"version-info__key"},"URL"),o("dd",{className:"version-info__value"},n.url),o("dt",{className:"version-info__key"},"Fingerprint"),o("dd",{className:"version-info__value"},n.fingerprint),o("dt",{className:"version-info__key"},"Account"),o("dd",{className:"version-info__value"},n.account),o("dt",{className:"version-info__key"},"Date"),o("dd",{className:"version-info__value"},n.timestamp)),o("div",{className:"version-info__actions"},o(s,{buttonText:"Copy version details",onClick:function(){try{i(n.asFormattedString()),t.info("Copied version info to clipboard")}catch(e){t.error("Unable to copy version info")}},icon:"copy"})))}c.propTypes={versionData:r.object.isRequired,flash:r.object.isRequired},c.injectedProps=["flash"],t.exports=a(c)},{"../util/copy-to-clipboard":199,"../util/service-context":218,"./button":92,preact:12,"prop-types":15}],131:[function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}s.$inject=["store","settings","$window"];var i=e("../shared/warn-once"),a=function(e){return{changeFocusModeUser:e.changeFocusModeUser}};function s(e,t,n){var s=a(e);n.addEventListener("message",(function(e){var n=t.rpcAllowedOrigins||[];if(function(e){return null!=e&&"object"===o(e)&&"2.0"===e.jsonrpc}(e.data))if(n.includes(e.origin)){var a=e.data;e.source.postMessage(function(e){var t=s[e.method];return void 0===t?{jsonrpc:"2.0",id:e.id,error:{code:-32601,message:"Method not found"}}:(e.params?t.apply(void 0,r(e.params)):t(),{jsonrpc:"2.0",result:"ok",id:e.id})}(a),e.origin)}else i("Ignoring JSON-RPC request from non-whitelisted origin ".concat(e.origin))}))}t.exports={server:{start:s}}},{"../shared/warn-once":77}],132:[function(e,t,n){"use strict";t.exports=function(){return{restrict:"A",link:function(e,t){t[0].focus()}}}},{}],133:[function(e,t,n){"use strict";function r(e){var t=!!e.branding,n={accentColor:"color",appBackgroundColor:"backgroundColor",ctaBackgroundColor:"backgroundColor",ctaTextColor:"color",selectionFontFamily:"fontFamily",annotationFontFamily:"fontFamily"};return{restrict:"A",link:function(r,o,i){var a;t&&(a=i.hBranding,a.split(",").map((function(e){return e.trim()})).filter((function(e){return e in n}))).forEach((function(t){var r=e.branding[t];r&&(o[0].style[n[t]]=r)}))}}}r.$inject=["settings"],t.exports=r},{}],134:[function(e,t,n){"use strict";t.exports=function(e){return{restrict:"A",link:function(t,n,r){var o=e(r.hOnTouch,null);!function(e,t,n,r){var o=function(t){e.$apply((function(){r(e,{$event:t})}))};n.forEach((function(e){t.addEventListener(e,o)}))}(t,n[0],["click","mousedown","touchstart"],o)}}},t.exports.$inject=["$parse"]},{}],135:[function(e,t,n){"use strict";var r;function o(e){this.setState=function(e){this.state=Object.freeze(Object.assign({},this.state,e)),this.render()},this.render=function(){if(this.state.target){var e=this.state.target,t=e.getAttribute("aria-label");this._labelEl.textContent=t;var n,r=this._el.getBoundingClientRect(),o=e.getBoundingClientRect();n="up"===this.state.direction?o.bottom+7:o.top-r.height-7;var i=o.right-r.width;this._el.classList.toggle("tooltip--up","up"===this.state.direction),this._el.classList.toggle("tooltip--down","down"===this.state.direction),Object.assign(this._el.style,{visibility:"",top:n+"px",left:i+"px"})}else this._el.style.visibility="hidden"},this._el=e.ownerDocument.createElement("div"),this._el.innerHTML='<span class="tooltip-label js-tooltip-label"></span>',this._el.className="tooltip",e.appendChild(this._el),this._labelEl=this._el.querySelector(".js-tooltip-label"),this.setState({direction:"down"})}t.exports=function(){return r||(r=new o(document.body)),{restrict:"A",link:function(e,t){var n=t[0];n.addEventListener("mouseover",(function(){var e=n.getAttribute("tooltip-direction")||"down";r.setState({direction:e,target:n})})),n.addEventListener("mouseout",(function(){r.setState({target:null})})),e.$on("$destroy",(function(){r.state.target===n&&r.setState({target:null})}))}}}},{}],136:[function(e,t,n){"use strict";t.exports=function(){return{link:function(e,t,n){var r=!0,o=t.prop("ownerDocument").documentElement,i=t.prop("ownerDocument").defaultView;function a(){var t=o.clientHeight,a=o.scrollHeight;i.scrollY+t>=a-t?r&&(r=!1,e.$apply(n.windowScroll)):r=!0}i.addEventListener("scroll",a,!1),e.$on("$destroy",(function(){i.removeEventListener("scroll",a)}))}}}},{}],137:[function(e,t,n){"use strict";t.exports={FRAME_CONNECTED:"frameConnected",USER_CHANGED:"userChanged",OAUTH_TOKENS_CHANGED:"oauthTokensChanged",GROUP_FOCUSED:"groupFocused",BEFORE_ANNOTATION_CREATED:"beforeAnnotationCreated",ANNOTATIONS_SYNCED:"sync",ANNOTATION_CREATED:"annotationCreated",ANNOTATION_DELETED:"annotationDeleted",ANNOTATION_FLAGGED:"annotationFlagged",ANNOTATION_UPDATED:"annotationUpdated",ANNOTATIONS_LOADED:"annotationsLoaded",ANNOTATIONS_UNLOADED:"annotationsUnloaded"}},{}],138:[function(e,t,n){"use strict";t.exports={encode:function(e){return e?window.encodeURIComponent(e):""}}},{}],139:[function(e,t,n){"use strict";var r=!1;t.exports=function(e){var t,n,o,i,a;r||(r=!0,t=window,n=document,o="script","ga",t.GoogleAnalyticsObject="ga",t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,i=n.createElement(o),a=n.getElementsByTagName(o)[0],i.async=1,i.src="https://www.google-analytics.com/analytics.js",a.parentNode.insertBefore(i,a),ga("create",e,"auto"),ga("set","checkProtocolTask",null),ga("set","anonymizeIp",!0))}},{}],140:[function(e,t,n){"use strict";var r=e("./service-config");t.exports=function(e){var t=r(e);if(t){if(t.apiUrl)return t.apiUrl;throw new Error("Service should contain an apiUrl value.")}return e.apiUrl}},{"./service-config":148}],141:[function(e,t,n){"use strict";var r=e("query-string");t.exports=function(e){var t=e.location.hash.slice(1),n=r.parse(t).config,o=JSON.parse(n||"{}"),i=["annotations","group","query","appType","openSidebar","showHighlights","services","branding","enableExperimentalNewNoteButton","focus","requestConfigFromFrame","theme","usernameUrl"];return Object.keys(o).reduce((function(e,t){return-1!==i.indexOf(t)&&null!==o[t]&&(e[t]=o[t]),e}),{})}},{"query-string":17}],142:[function(e,t,n){"use strict";v.$inject=["analytics"],g.$inject=["api","streamer"],m.$inject=["toastrConfig"],h.$inject=["$routeProvider"],p.$inject=["$locationProvider"];var r=e("./ga"),o=e("./util/disable-opener-for-external-links"),i=e("./util/fetch-config").fetchConfig,a=e("./service-config"),s=e("./cross-origin-rpc.js"),c=e("../shared/settings").jsonConfigsFrom(document);c.sentry&&e("./util/sentry").init(c.sentry),document.body.setAttribute("ng-csp",""),o(document.body);var u=e("angular");e("autofill-event"),e("focus-visible"),e("preact/debug");var l=e("./util/wrap-react-component");c.googleAnalytics&&r(c.googleAnalytics);var f={state:["groups","session",function(e,t){return Promise.all([e.load(),t.load()])}]},d=!(window.location.pathname.startsWith("/stream")||window.location.pathname.startsWith("/a/"));function p(e){return e.html5Mode(!0)}function h(e){e.when("/a/:id",{template:"<annotation-viewer-content></annotation-viewer-content>",reloadOnSearch:!1,resolve:f}),e.when("/stream",{template:"<stream-content></stream-content>",reloadOnSearch:!1,resolve:f}),e.otherwise({template:'<sidebar-content auth="vm.auth" on-login="vm.login()"></sidebar-content>',reloadOnSearch:!1,resolve:f})}function m(e){u.extend(e,{preventOpenDuplicates:!0})}function g(e,t){e.setClientId(t.clientId)}function v(e){e.sendPageView()}i(c).then((function(t){!function(t){u.module("h",[e("angular-route"),e("angular-toastr"),["ngTagsInput",e("ng-tags-input")][0]]).component("hypothesisApp",e("./components/hypothesis-app")).component("annotation",e("./components/annotation")).component("annotationBody",l(e("./components/annotation-body"))).component("annotationHeader",l(e("./components/annotation-header"))).component("annotationActionBar",l(e("./components/annotation-action-bar"))).component("annotationLicense",l(e("./components/annotation-license"))).component("annotationPublishControl",l(e("./components/annotation-publish-control"))).component("annotationQuote",l(e("./components/annotation-quote"))).component("annotationThread",e("./components/annotation-thread")).component("annotationViewerContent",e("./components/annotation-viewer-content")).component("helpPanel",l(e("./components/help-panel"))).component("loggedOutMessage",l(e("./components/logged-out-message"))).component("moderationBanner",l(e("./components/moderation-banner"))).component("searchStatusBar",l(e("./components/search-status-bar"))).component("focusedModeHeader",l(e("./components/focused-mode-header"))).component("selectionTabs",l(e("./components/selection-tabs"))).component("sidebarContent",e("./components/sidebar-content")).component("sidebarContentError",l(e("./components/sidebar-content-error"))).component("shareAnnotationsPanel",l(e("./components/share-annotations-panel"))).component("streamContent",e("./components/stream-content")).component("svgIcon",l(e("./components/svg-icon"))).component("tagEditor",l(e("./components/tag-editor"))).component("tagList",l(e("./components/tag-list"))).component("threadList",e("./components/thread-list")).component("topBar",l(e("./components/top-bar"))).directive("hAutofocus",e("./directive/h-autofocus")).directive("hBranding",e("./directive/h-branding")).directive("hOnTouch",e("./directive/h-on-touch")).directive("hTooltip",e("./directive/h-tooltip")).directive("windowScroll",e("./directive/window-scroll")).service("analytics",e("./services/analytics")).service("annotationMapper",e("./services/annotation-mapper")).service("annotations",e("./services/annotations")).service("api",e("./services/api")).service("apiRoutes",e("./services/api-routes")).service("auth",e("./services/oauth-auth")).service("bridge",e("../shared/bridge")).service("features",e("./services/features")).service("flash",e("./services/flash")).service("frameSync",e("./services/frame-sync").default).service("groups",e("./services/groups")).service("localStorage",e("./services/local-storage")).service("permissions",e("./services/permissions")).service("rootThread",e("./services/root-thread")).service("searchFilter",e("./services/search-filter")).service("serviceUrl",e("./services/service-url")).service("session",e("./services/session")).service("streamer",e("./services/streamer")).service("streamFilter",e("./services/stream-filter")).service("tags",e("./services/tags")).service("unicode",e("./services/unicode")).service("viewFilter",e("./services/view-filter")).service("store",e("./store")).value("Discovery",e("../shared/discovery")).value("OAuthClient",e("./util/oauth-client")).value("VirtualThreadList",e("./virtual-thread-list")).value("isSidebar",d).value("random",e("./util/random")).value("serviceConfig",a).value("settings",t).value("time",e("./util/time")).value("urlEncodeFilter",e("./filter/url").encode).config(p).config(h).config(m).run(v).run(g).run(s.server.start),t.liveReloadServer&&e("./live-reload-client").connect(t.liveReloadServer),window.chrome&&!window.chrome.app&&(window.chrome.app={dummyAddedByHypothesisClient:!0});var n=document.querySelector("hypothesis-app");u.bootstrap(n,["h"],{strictDi:!0})}(t)})).catch((function(e){console.error("Failed to start Hypothesis client: ",e)}))},{"../shared/bridge":73,"../shared/discovery":74,"../shared/settings":76,"./components/annotation":91,"./components/annotation-action-bar":79,"./components/annotation-body":80,"./components/annotation-header":82,"./components/annotation-license":83,"./components/annotation-publish-control":84,"./components/annotation-quote":85,"./components/annotation-thread":88,"./components/annotation-viewer-content":90,"./components/focused-mode-header":94,"./components/help-panel":98,"./components/hypothesis-app":100,"./components/logged-out-message":101,"./components/moderation-banner":107,"./components/search-status-bar":110,"./components/selection-tabs":111,"./components/share-annotations-panel":112,"./components/sidebar-content":115,"./components/sidebar-content-error":114,"./components/stream-content":120,"./components/svg-icon":122,"./components/tag-editor":123,"./components/tag-list":124,"./components/thread-list":125,"./components/top-bar":127,"./cross-origin-rpc.js":131,"./directive/h-autofocus":132,"./directive/h-branding":133,"./directive/h-on-touch":134,"./directive/h-tooltip":135,"./directive/window-scroll":136,"./filter/url":138,"./ga":139,"./live-reload-client":143,"./service-config":148,"./services/analytics":149,"./services/annotation-mapper":150,"./services/annotations":151,"./services/api":153,"./services/api-routes":152,"./services/features":154,"./services/flash":155,"./services/frame-sync":156,"./services/groups":157,"./services/local-storage":158,"./services/oauth-auth":159,"./services/permissions":160,"./services/root-thread":161,"./services/search-filter":162,"./services/service-url":163,"./services/session":164,"./services/stream-filter":165,"./services/streamer":166,"./services/tags":167,"./services/unicode":168,"./services/view-filter":169,"./store":172,"./util/disable-opener-for-external-links":201,"./util/fetch-config":203,"./util/oauth-client":210,"./util/random":214,"./util/sentry":217,"./util/time":223,"./util/wrap-react-component":226,"./virtual-thread-list":227,angular:"angular","angular-route":"angular-route","angular-toastr":"angular-toastr","autofill-event":1,"focus-visible":7,"ng-tags-input":"ng-tags-input","preact/debug":11}],143:[function(e,t,n){"use strict";var r=e("query-string"),o=e("./websocket");function i(e,t){var n=e.parentNode,o=e.cloneNode();["href","src"].forEach((function(n){n in e&&function(e,t){return t.some((function(t){return-1!==e.indexOf(t)}))}(e[n],t)&&(o[n]=function(e){var t=e,n=r.parse({timestamp:Date.now()});return-1!==e.indexOf("?")?t+="&"+n:t+="?"+n,t}(e[n]))})),n.replaceChild(o,e)}t.exports={connect:function(e){var t=new o(e);t.on("open",(function(){console.log("Live reload client listening")})),t.on("message",(function(e){var t=JSON.parse(e.data);if("assets-changed"===t.type){var n=t.changed.some((function(e){return e.match(/\.(html|js)$/)})),r=t.changed.some((function(e){return e.match(/\.css$/)}));if(n)return void window.top.postMessage({type:"reloadrequest"},"*");r&&function(e){[].slice.apply(document.querySelectorAll("link")).forEach((function(t){i(t,e)}))}(t.changed)}})),t.on("error",(function(e){console.error("Error connecting to live reload server:",e)}))}}},{"./websocket":228,"query-string":17}],144:[function(e,t,n){"use strict";var r={ANCHOR_LINK:0,IMAGE_LINK:1};function o(e,t,n,r){var o=e.selectionStart,i=e.selectionEnd;return o>=t+n?(o+=r.length-n,i+=r.length-n):i<=t||(o<=t&&i>=t+n?i+=r.length-n:o<t&&i<t+n?o=t:o<t+n&&i>t+n?i+=r.length-n:t<o&&t+n>i&&(o=t,i=t+n)),{text:e.text.slice(0,t)+r+e.text.slice(t+n),selectionStart:o,selectionEnd:i}}function i(e,t){var n=e.indexOf("\n",t);return n<0?e.length:n}function a(e,t,n,r){for(var o=function(e,t){var n=e.lastIndexOf("\n",t);return n<0?0:n+1}(e.text,t),a=i(e.text,t);a<=i(e.text,n);){var s=a===e.text.length,c=a-o,u=i((e=r(e,o,a)).text,o)-o;if(n+=u-c,s)break;o=o+u+1,a=i(e.text,o)}return e}t.exports={toggleSpanStyle:function(e,t,n,r){void 0===n&&(n=t);var i=e.text.slice(e.selectionStart-t.length,e.selectionStart),a=e.text.slice(e.selectionEnd,e.selectionEnd+t.length),s=e;return e.selectionStart===e.selectionEnd&&r&&((s=o(e,e.selectionStart,0,r)).selectionStart=s.selectionEnd-r.length),i===t&&a===n?(s=o(s,s.selectionStart-t.length,t.length,""),s=o(s,s.selectionEnd,n.length,"")):(s=o(s,s.selectionStart,0,t),s=o(s,s.selectionEnd,0,n)),s},toggleBlockStyle:function(e,t){var n=e.selectionStart,r=e.selectionEnd,i=!0;return a(e,n,r,(function(e,n){return e.text.slice(n,n+t.length)!==t&&(i=!1),e})),a(e,n,r,i?function(e,n){return o(e,n,t.length,"")}:function(e,n){return e.text.slice(n,n+t.length)===t?e:o(e,n,0,t)})},convertSelectionToLink:function(e,t){void 0===t&&(t=r.ANCHOR_LINK);var n,i=e.text.slice(e.selectionStart,e.selectionEnd),a="";if(t===r.IMAGE_LINK&&(a="!"),i.match(/[a-z]+:\/\/.*/))return(n=o(e,e.selectionStart,i.length,a+"[Description]("+i+")")).selectionStart=e.selectionStart+a.length+1,n.selectionEnd=n.selectionStart+"Description".length,n;var s=a+"["+i+"](",c="http://insert-your-link-here.com";return(n=o(e,e.selectionStart,i.length,s+c+")")).selectionStart=e.selectionStart+s.length,n.selectionEnd=n.selectionStart+c.length,n},LinkType:r}},{}],145:[function(e,t,n){"use strict";var r=e("query-string");function o(e){var t=document.createElement("iframe");return t.src=e,t.classList.add("annotation-media-embed"),t.setAttribute("frameborder","0"),t.setAttribute("allowfullscreen",""),t}function i(e,t){var n=function(e){var t,n=["end","start","t"],o=r.parse(e.search),i={};return Object.keys(o).filter((function(e){return n.includes(e)})).forEach((function(e){"t"===e?i.start=function(e){for(var t,n=/(\d+)([hms]?)/g,r={h:3600,m:60,s:1},o=0;null!==(t=n.exec(e));)t[2]?o+=t[1]*r[t[2]]:o+=+t[1];return o.toString()}(o[e]):i[e]=o[e]})),(t=r.stringify(i))&&(t="?".concat(t)),t}(t);return o("https://www.youtube.com/embed/".concat(e).concat(n))}function a(e){return o("https://player.vimeo.com/video/"+e)}var s=[function(e){if("www.youtube.com"!==e.hostname)return null;if(!/\/watch\/?/.test(e.pathname))return null;var t=/[&?]v=([^&#]+)/.exec(e.search);return t?i(t[1],e):null},function(e){if("youtu.be"!==e.hostname)return null;var t=/^\/([^/]+)\/?$/.exec(e.pathname);return t?i(t[1],e):null},function(e){if("vimeo.com"!==e.hostname)return null;var t=/^\/([^/?#]+)\/?$/.exec(e.pathname);return t?a(t[1]):null},function(e){if("vimeo.com"!==e.hostname)return null;var t=/^\/channels\/[^/]+\/([^/?#]+)\/?$/.exec(e.pathname);return t?a(t[1]):null},function(e){if("archive.org"!==e.hostname)return null;var t=/^\/(embed|details)\/(.+)/.exec(e.pathname);if(!t)return null;var n=t[2],i=r.parse(e.search),a=i.start,s=i.end;if(!a){var c=n.match(/\/start\/([^/]+)/);c&&(a=c[1],n=n.replace(c[0],""))}if(!s){var u=n.match(/\/end\/([^/]+)/);u&&(s=u[1],n=n.replace(u[0],""))}var l=new URL("https://archive.org/embed/".concat(n));return a&&l.searchParams.append("start",a),s&&l.searchParams.append("end",s),o(l.href)},function(e){return e.pathname.endsWith(".mp3")||e.pathname.endsWith(".ogg")||e.pathname.endsWith(".wav")?function(e){var t=document.createElement("audio");return t.controls=!0,t.src=e,t}(e.href):null}];function c(e){if(e.href===e.textContent||decodeURI(e.href)===e.textContent){var t=function(e){var t,n;for(n=0;n<s.length;n++)if(t=s[n](e))return t;return null}(e);t&&e.parentElement.replaceChild(t,e)}}t.exports={replaceLinksWithEmbeds:function(e){var t,n=e.getElementsByTagName("a");for(n=Array.prototype.slice.call(n,0),t=0;t<n.length;t++)c(n[t])}}},{"query-string":17}],146:[function(e,t,n){"use strict";var r,o=e("dompurify"),i=e("escape-html"),a=e("katex"),s=e("showdown"),c=o(window);function u(){return[{type:"output",filter:function(e){return e.replace(/<a href=/g,'<a target="_blank" href=')}}]}function l(e){return"{math:"+e.toString()+"}"}c.addHook("afterSanitizeAttributes",(function(e){"target"in e&&e.setAttribute("target","_blank")})),t.exports=function(e){var t=function(e){for(var t=[],n=0,r=e;;){var o=r.indexOf("$$",n),i=r.indexOf("\\(",n);if(-1===o&&-1===i)break;var a=void 0,s=void 0;if(-1!==o&&(-1===i||o<i)?(a=o,s=r.indexOf("$$",a+2)):(a=i,s=r.indexOf("\\)",a+2)),-1===s)break;s+=2;var c=t.length+1,u=l(c);t.push({id:c,expression:r.slice(a+2,s-2),inline:-1!==i});var f;f=-1!==i?u:"\n\n"+u+"\n\n",r=r.slice(0,a)+f+r.slice(s),n=a+f.length}return{mathBlocks:t,content:r}}(e);return function(e,t){return t.reduce((function(e,t){var n;try{n=t.inline?a.renderToString(t.expression):a.renderToString(t.expression,{displayMode:!0})}catch(e){n=i(t.expression)}return e.replace(l(t.id),n)}),e)}(c.sanitize(function(e){return r||(r=new s.Converter({extensions:[u],simplifiedAutoLink:!0,literalMidWordUnderscores:!0})),r.makeHtml(e)}(t.content)),t.mathBlocks)}},{dompurify:3,"escape-html":4,katex:"katex",showdown:"showdown"}],147:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}var c=e("tiny-emitter"),u=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=n||{},(r=i(this,a(t).call(this)))._searchFn=e,r._chunkSize=n.chunkSize||200,void 0!==n.incremental?r._incremental=n.incremental:r._incremental=!0,r._canceled=!1,r}return s(t,c),function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(t,[{key:"_getBatch",value:function(e,t){var n=Object.assign({limit:this._chunkSize,offset:t,sort:"created",order:"asc",_separate_replies:!0},e),r=this;this._searchFn(n).then((function(n){if(!r._canceled){var o=n.rows.concat(n.replies||[]);r._incremental?r.emit("results",o):r._results=r._results.concat(o);var i=t+n.rows.length;n.total>i&&o.length>0?r._getBatch(e,i):(r._incremental||r.emit("results",r._results),r.emit("end"))}})).catch((function(e){r._canceled||(r.emit("error",e),r.emit("end"))}))}},{key:"get",value:function(e){this._results=[],this._getBatch(e,0)}},{key:"cancel",value:function(){this._canceled=!0,this.emit("end")}}]),t}();t.exports=u},{"tiny-emitter":30}],148:[function(e,t,n){"use strict";t.exports=function(e){return Array.isArray(e.services)&&0!==e.services.length?e.services[0]:null}},{}],149:[function(e,t,n){"use strict";i.$inject=["$window","settings"];var r=/^https:\/\/(qa-)?via.hypothes.is\//,o={ANNOTATION_CREATED:"annotationCreated",ANNOTATION_DELETED:"annotationDeleted",ANNOTATION_FLAGGED:"annotationFlagged",ANNOTATION_SHARED:"annotationShared",ANNOTATION_UPDATED:"annotationUpdated",DOCUMENT_SHARED:"documentShared",GROUP_LEAVE:"groupLeave",GROUP_SWITCH:"groupSwitch",GROUP_VIEW_ACTIVITY:"groupViewActivity",HIGHLIGHT_CREATED:"highlightCreated",HIGHLIGHT_UPDATED:"highlightUpdated",HIGHLIGHT_DELETED:"highlightDeleted",LOGIN_FAILURE:"loginFailure",LOGIN_SUCCESS:"loginSuccessful",LOGOUT_FAILURE:"logoutFailure",LOGOUT_SUCCESS:"logoutSuccessful",PAGE_NOTE_CREATED:"pageNoteCreated",PAGE_NOTE_UPDATED:"pageNoteUpdated",PAGE_NOTE_DELETED:"pageNoteDeleted",REPLY_CREATED:"replyCreated",REPLY_UPDATED:"replyUpdated",REPLY_DELETED:"replyDeleted",SIDEBAR_OPENED:"sidebarOpened",SIGN_UP_REQUESTED:"signUpRequested"};function i(e,t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["chrome-extension","firefox-extension","embed","bookmarklet","via"].indexOf((t.appType||"").toLowerCase())>-1?t.appType.toLowerCase():"chrome-extension:"===e.location.protocol?"chrome-extension":r.test(e.document.referrer)?"via":"embed"}(e,t),i=function(){},a=function(){return e.ga||i};return{sendPageView:function(){a()("send","pageview")},track:function(e,t,r){a()("send","event",n,e,t,r)},events:o}}i.events=o,t.exports=i},{}],150:[function(e,t,n){"use strict";a.$inject=["$rootScope","store","api"];var r=e("angular"),o=e("../events");function i(e,t){return e.getState().annotations.annotations.find((function(e){return e.id===t}))}function a(e,t,n){return{loadAnnotations:function(n,r){n=n.concat(r||[]);var a=[];n.forEach((function(n){i(t,n.id)?e.$broadcast(o.ANNOTATION_UPDATED,n):a.push(n)})),e.$broadcast(o.ANNOTATIONS_LOADED,a)},unloadAnnotations:function(n){var a=n.map((function(e){var n=i(t,e.id);return n&&e!==n&&(e=r.copy(e,n)),e}));e.$broadcast(o.ANNOTATIONS_UNLOADED,a)},createAnnotation:function(t){return e.$broadcast(o.BEFORE_ANNOTATION_CREATED,t),t},deleteAnnotation:function(t){return n.annotation.delete({id:t.id}).then((function(){return e.$broadcast(o.ANNOTATION_DELETED,t),t}))},flagAnnotation:function(t){return n.annotation.flag({id:t.id}).then((function(){return e.$broadcast(o.ANNOTATION_FLAGGED,t),t}))}}}t.exports=a},{"../events":137,angular:"angular"}],151:[function(e,t,n){"use strict";o.$inject=["annotationMapper","api","store","streamer","streamFilter"];var r=e("../search-client");function o(e,t,n,o,i){var a=null;return{load:function(s,c){e.unloadAnnotations(n.savedAnnotations()),a&&a.cancel(),s.length>0&&(function(o,i){(a=new r(t.search,{incremental:!0})).on("results",(function(t){t.length&&e.loadAnnotations(t)})),a.on("error",(function(e){console.error(e)})),a.on("end",(function(){a=null,n.frames().forEach((function(e){0<=o.indexOf(e.uri)&&n.updateFrameAnnotationFetchStatus(e.uri,!0)})),n.annotationFetchFinished()})),n.annotationFetchStarted(),a.get({uri:o,group:i})}(s,c),i.resetFilter().addClause("/uri","one_of",s),o.setConfig("filter",{filter:i.getFilter()}))}}}t.exports=o},{"../search-client":147}],152:[function(e,t,n){"use strict";o.$inject=["settings"];var r=e("../util/retry").retryPromiseOperation;function o(e){var t,n;function o(e){return fetch(e).then((function(t){if(200!==t.status)throw new Error("Fetching ".concat(e," failed"));return t.json()}))}function i(){return t||(t=r((function(){return o(e.apiUrl)})).then((function(e){return e.links}))),t}return{routes:i,links:function(){return n||(n=i().then((function(e){return o(e.links.url)}))),n}}}t.exports=o},{"../util/retry":215}],153:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}l.$inject=["apiRoutes","auth","store"];var o=e("lodash.get"),i=e("query-string"),a=e("../util/url").replaceURLParams;function s(e,t){var n=e.status+" "+e.statusText;return t&&t.reason&&(n=n+": "+t.reason),new Error(n)}function c(e){var t={};for(var n in e)e.hasOwnProperty(n)&&"$"!==n[0]&&(t[n]=e[n]);return t}var u=function(){return null};function l(e,t,n){var l=e.routes(),f=null,d=function(){return f};function p(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=n.getAccessToken,f=void 0===l?u:l,d=n.getClientId,p=void 0===d?u:d,h=n.onRequestStarted,m=void 0===h?u:h,g=n.onRequestFinished,v=void 0===g?u:g;return function(n,u){var l,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return m(),Promise.all([e,f()]).then((function(e){var s=r(e,2),f=s[0],d=s[1],h=o(f,t),m={"Content-Type":"application/json","Hypothesis-Client-Version":"1.262.0"};l=d,d&&(m.Authorization="Bearer "+d);var g=p();g&&(m["X-Client-Id"]=g);var v=a(h.url,n),y=v.url,b=v.params,_=new URL(y);return _.search=i.stringify(b),fetch(_.toString(),{body:u?JSON.stringify(c(u)):null,headers:m,method:h.method})})).then((function(e){var t,n=e.status;return t=n>=200&&204!==n&&n<500?e.json():e.text(),Promise.all([e,t])})).then((function(e){var t=r(e,2),n=t[0],o=t[1];if(v(),n.status>=400)throw s(n,o);return d.includeMetadata?{data:o,token:l}:o}),(function(e){throw v(),e}))}}(l,e,{getAccessToken:t.tokenGetter,getClientId:d,onRequestStarted:n.apiRequestStarted,onRequestFinished:n.apiRequestFinished})}return{setClientId:function(e){f=e},search:p("search"),annotation:{create:p("annotation.create"),delete:p("annotation.delete"),get:p("annotation.read"),update:p("annotation.update"),flag:p("annotation.flag"),hide:p("annotation.hide"),unhide:p("annotation.unhide")},group:{member:{delete:p("group.member.delete")},read:p("group.read")},groups:{list:p("groups.read")},profile:{groups:{read:p("profile.groups.read")},read:p("profile.read"),update:p("profile.update")}}}t.exports=l},{"../util/url":224,"lodash.get":9,"query-string":17}],154:[function(e,t,n){"use strict";a.$inject=["$rootScope","bridge","session"];var r=e("../events"),o=e("../../shared/bridge-events"),i=e("../../shared/warn-once");function a(e,t,n){var a=function(){var e=n.state.features;t.call(o.FEATURE_FLAGS_UPDATED,e||{})};return e.$on(r.USER_CHANGED,a),e.$on(r.FRAME_CONNECTED,a),{flagEnabled:function(e){if(n.load(),!n.state.features)return!1;var t=n.state.features;return e in t?t[e]:(i("looked up unknown feature",e),!1)}}}t.exports=a},{"../../shared/bridge-events":72,"../../shared/warn-once":77,"../events":137}],155:[function(e,t,n){"use strict";function r(e){return{info:e.info.bind(e),success:e.success.bind(e),warning:e.warning.bind(e),error:e.error.bind(e)}}r.$inject=["toastr"],t.exports=r},{}],156:[function(e,t,n){"use strict";u.$inject=["$rootScope","$window","Discovery","store","bridge"];var r=e("lodash.debounce"),o=e("../events"),i=e("../../shared/bridge-events"),a=e("../util/annotation-metadata"),s=e("../ui-constants");function c(e){return{tag:e.$tag,msg:{document:e.document,target:e.target,uri:e.uri}}}function u(e,t,n,u,l){var f=new Set;function d(){l.on("beforeCreateAnnotation",(function(t){f.add(t.tag);var n=Object.assign({},t.msg,{$tag:t.tag});e.$broadcast(o.BEFORE_ANNOTATION_CREATED,n)})),l.on("destroyFrame",h.bind(this));var t={},n=r((function(){u.updateAnchorStatus(t),e.$broadcast(o.ANNOTATIONS_SYNCED,Object.keys(t)),t={}}),10);l.on("sync",(function(e){e.forEach((function(e){f.add(e.tag),t[e.tag]=e.msg.$orphan?"orphan":"anchored",n()}))})),l.on("showAnnotations",(function(e){u.selectAnnotations(u.findIDsForTags(e)),u.selectTab(s.TAB_ANNOTATIONS)})),l.on("focusAnnotations",(function(e){u.focusAnnotations(e||[])})),l.on("toggleAnnotationSelection",(function(e){u.toggleSelectedAnnotations(u.findIDsForTags(e))})),l.on("sidebarOpened",(function(){e.$broadcast("sidebarOpened")})),l.on("showSidebar",(function(){l.call("showSidebar")})),l.on("hideSidebar",(function(){l.call("hideSidebar")})),l.on("setVisibleHighlights",(function(e){l.call("setVisibleHighlights",e)}))}function p(t){t.call("getDocumentInfo",(function(n,r){n?t.destroy():(e.$broadcast(o.FRAME_CONNECTED),u.connectFrame({id:r.frameIdentifier,metadata:r.metadata,uri:r.uri}))}))}function h(e){var t=u.frames().find((function(t){return t.id===e}));t&&u.destroyFrame(t)}this.connect=function(){var e,t,r;new n(window,{server:!0}).startDiscovery(l.createChannel.bind(l)),l.onConnect(p),e=[],t=[],r=0,u.subscribe((function(){var n=u.getState();if(n.annotations.annotations!==e||n.frames!==t){var o=0,s=new Set,d=[];n.annotations.annotations.forEach((function(e){a.isReply(e)||(a.isPublic(e)&&++o,s.add(e.$tag),f.has(e.$tag)||d.push(e))}));var p=e.filter((function(e){return!s.has(e.$tag)}));e=n.annotations.annotations,t=n.frames,d.length>0&&(l.call("loadAnnotations",d.map(c)),d.forEach((function(e){f.add(e.$tag)}))),p.forEach((function(e){l.call("deleteAnnotation",c(e)),f.delete(e.$tag)}));var h=u.frames();h.length>0&&h.every((function(e){return e.isAnnotationFetchComplete}))&&(0!==o&&o===r||(l.call(i.PUBLIC_ANNOTATION_COUNT_CHANGED,o),r=o))}})),d()},this.focusAnnotations=function(e){l.call("focusAnnotations",e)},this.scrollToAnnotation=function(e){l.call("scrollToAnnotation",e)}}t.exports={default:u,formatAnnot:c}},{"../../shared/bridge-events":72,"../events":137,"../ui-constants":194,"../util/annotation-metadata":196,"lodash.debounce":8}],157:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function i(){}function a(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}h.$inject=["$rootScope","store","api","isSidebar","localStorage","serviceUrl","session","settings","auth"];var c="hypothesis.groups.focus",u={id:"__default__",logo:"data:image/svg+xml;utf8,"+encodeURIComponent(e("../../images/icons/logo.svg"))},l=e("../events"),f=e("../util/state").awaitStateChange,d=e("../util/groups").combineGroups,p=e("../service-config");function h(e,t,n,h,m,g,v,y,b){var _=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(){return a((function(){if(h)return function(e,t,n){if(n)return t?t(e()):e();try{var r=Promise.resolve(e());return t?r.then(t):r}catch(e){return Promise.reject(e)}}(T,(function(e){E=e}))}),(function(){var e={expand:["organization","scopes"]};A&&(e.authority=A),E&&(e.document_uri=E);var l=t.getState().directLinked.directLinkedAnnotationId,f=null;l&&(f=n.annotation.get({id:l}).catch((function(){return null})));var p=t.getState().directLinked.directLinkedGroupId,h=null;return p&&(h=S({id:p,expand:e.expand}).then((function(e){return null===e?t.setDirectLinkedGroupFetchFailed():t.clearDirectLinkedGroupFetchFailed(),e}))),o(Promise.all([n.profile.groups.read({expand:e.expand}),n.groups.list(e),b.tokenGetter(),f,h]),(function(n){var l=r(n,5),f=l[0],h=l[1],g=l[2],v=l[3],y=l[4];y&&!h.some((function(e){return e.id===y.id}))&&h.push(y);var b=null;return a((function(){if(v){b=v.group;var t=f.concat(h).find((function(e){return e.id===v.group}));return function(e){var t=e();if(t&&t.then)return t.then(i)}((function(){if(!t)return o(S({id:v.group,expand:e.expand}),(function(e){e&&h.push(e)}))}))}}),(function(){var e=null!==g,n=function(e,n,r,o){if(o){var i=e.find((function(e){return e.id===o}));i&&!i.isScopedToUri&&i.scopes.enforced&&(e=e.filter((function(e){return e.id!==o})),t.setDirectLinkedGroupFetchFailed(),o=null)}return w&&w.groups?e.filter((function(e){return w.groups.includes(e.id)||w.groups.includes(e.groupid)})):n?e:e.some((function(e){return"__world__"!==e.id&&e.isScopedToUri}))?"__world__"===o||"__world__"===r?e:e.filter((function(e){return"__world__"!==e.id})):e}(d(f,h,E),e,b,p);!function(e){e.forEach((function(e){e.organization&&"object"===s(e.organization)||(e.organization=u)}))}(n);var r=0===t.allGroups().length,o=m.getItem(c);return t.loadGroups(n),r&&(n.some((function(e){return e.id===b}))?t.focusGroup(b):n.some((function(e){return e.id===p}))?t.focusGroup(p):n.some((function(e){return e.id===o}))&&t.focusGroup(o)),n}))}))}))})),w=p(y),A=w?w.authority:null;function T(){return f(t,(function(){var e=t.mainFrame();return e?e.uri:null}))}var E=null;function S(e){return n.group.read(e).catch((function(){return null}))}var O=t.focusedGroupId();return t.subscribe((function(){var n=t.focusedGroupId();null!==n&&n!==O&&(O=n,m.setItem(c,n),e.$broadcast(l.GROUP_FOCUSED,n))})),e.$on(l.USER_CHANGED,(function(){return _()})),e.$on(l.FRAME_CONNECTED,(function(){return T().then((function(e){E!==e&&(E=e,_())}))})),{all:function(){return t.allGroups()},get:function(e){return t.getGroup(e)},leave:function(e){return n.group.member.delete({pubid:e,userid:"me"})},load:_,focused:function(){return t.focusedGroup()},focus:function(e){t.focusGroup(e)}}}t.exports=h},{"../../images/icons/logo.svg":61,"../events":137,"../service-config":148,"../util/groups":206,"../util/state":220}],158:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}i.$inject=["$window"];var o=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._store={}}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"getItem",value:function(e){return e in this._store?this._store[e]:null}},{key:"setItem",value:function(e,t){this._store[e]=t}},{key:"removeItem",value:function(e){delete this._store[e]}}]),e}();function i(e){var t,n="hypothesis.testKey";try{t=e.localStorage,e.localStorage.setItem(n,n),e.localStorage.getItem(n),e.localStorage.removeItem(n)}catch(e){t=new o}return{getItem:function(e){return t.getItem(e)},getObject:function(e){var n=t.getItem(e);return n?JSON.parse(n):null},setItem:function(e,n){t.setItem(e,n)},setObject:function(e,n){var r=JSON.stringify(n);t.setItem(e,r)},removeItem:function(e){t.removeItem(e)}}}t.exports=i},{}],159:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}c.$inject=["$rootScope","$window","OAuthClient","apiRoutes","flash","localStorage","settings"];var i=e("../events");var a=e("../util/url").resolve,s=e("../service-config");function c(e,t,n,c,u,l,f){var d,p,h,m=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(){return o(Promise.all([p,b()]),(function(e){var t=r(e,2),n=t[0];return o(t[1].revokeToken(n.accessToken),(function(){p=Promise.resolve(null),l.removeItem(v())}))}))})),g=a("token",f.apiUrl);function v(){var e=new URL(f.apiUrl).hostname;return e=e.replace(/\./g,"%2E"),"hypothesis.oauth.".concat(e,".token")}function y(e){l.setObject(v(),e)}function b(){return h?Promise.resolve(h):c.links().then((function(e){return h=new n({clientId:f.oauthClientId,authorizationEndpoint:e["oauth.authorize"],revokeEndpoint:e["oauth.revoke"],tokenEndpoint:g})}))}return t.addEventListener("storage",(function(t){t.key===v()&&(p=null,e.$broadcast(i.OAUTH_TOKENS_CHANGED))})),{login:function(){var e=n.openAuthPopupWindow(t);return b().then((function(n){return n.authorize(t,e)})).then((function(e){d=e,p=null}))},logout:m,tokenGetter:function e(){if(!p){var t=s(f);if(t&&void 0!==t.grantToken)p=t.grantToken?b().then((function(e){return e.exchangeGrantToken(t.grantToken)})).catch((function(e){throw"You must reload the page to annotate.",u.error("You must reload the page to annotate.","Hypothesis login lost",{extendedTimeOut:0,tapToDismiss:!1,timeOut:0}),e})):Promise.resolve(null);else if(d){var n=d;d=null,p=b().then((function(e){return e.exchangeAuthCode(n)})).then((function(e){return y(e),e}))}else p=Promise.resolve((r=l.getObject(v()))&&"string"==typeof r.accessToken&&"string"==typeof r.refreshToken&&"number"==typeof r.expiresAt?{accessToken:r.accessToken,refreshToken:r.refreshToken,expiresAt:r.expiresAt}:null)}var r,o=p;return p.then((function(t){if(!t)return null;if(o!==p)return e();if(Date.now()>t.expiresAt){var n=!0,r=s(f);return r&&void 0!==r.grantToken&&(n=!1),p=(i=t.refreshToken,a={persist:n},b().then((function(e){return e.refreshToken(i)})).then((function(e){return a.persist&&y(e),e}))).then((function(e){if(Date.now()>e.expiresAt)throw new Error("Refreshed token expired in the past");return e})).catch((function(){return null})),e()}return t.accessToken;var i,a}))}}}t.exports=c},{"../events":137,"../service-config":148,"../util/url":224}],160:[function(e,t,n){"use strict";o.$inject=["localStorage"];var r="hypothesis.privacy";function o(e){var t=this;this.private=function(e){return{read:[e],update:[e],delete:[e]}},this.shared=function(e,n){return Object.assign(t.private(e),{read:["group:"+n]})},this.default=function(n,o){return"private"===function(){var t=e.getItem(r);switch(t){case"private":case"shared":return t;default:return"shared"}}()&&n?t.private(n):t.shared(n,o)},this.setDefault=function(t){e.setItem(r,t)},this.isShared=function(e){return e.read.some((function(e){return 0===e.indexOf("group:")}))},this.permits=function(e,t,n){return-1!==e[t].indexOf(n)}}t.exports=o},{}],161:[function(e,t,n){"use strict";l.$inject=["$rootScope","store","searchFilter","viewFilter"];var r=e("../build-thread"),o=e("../events"),i=e("../util/memoize"),a=e("../util/annotation-metadata"),s=e("../util/tabs");function c(e){return Object.keys(e).filter((function(t){return!!e[t]}))}var u={Newest:function(e,t){return e.updated>t.updated},Oldest:function(e,t){return e.updated<t.updated},Location:function(e,t){return a.location(e)<a.location(t)}};function l(e,t,n,l){[o.ANNOTATION_CREATED,o.ANNOTATION_UPDATED,o.ANNOTATIONS_LOADED].forEach((function(n){e.$on(n,(function(e,n){t.addAnnotations([].concat(n))}))})),e.$on(o.BEFORE_ANNOTATION_CREATED,(function(e,n){t.createAnnotation(n)})),e.$on(o.ANNOTATION_DELETED,(function(e,n){t.removeAnnotations([n])})),e.$on(o.ANNOTATIONS_UNLOADED,(function(e,n){t.removeAnnotations(n)})),e.$on(o.GROUP_FOCUSED,(function(e,n){var r=t.getState().annotations.annotations.filter((function(e){return a.isNew(e)&&!a.isReply(e)})).map((function(e){return Object.assign(e,{group:n})}));r.length>0&&t.addAnnotations(r)})),this.thread=i((function(e){var o,i,a=u[e.selection.sortKey],f=function(){return e.selection.filterQuery||t.focusModeFocused()};if(f()){var d=n.generateFacetedFilter(e.selection.filterQuery,{user:t.focusModeFocused()&&t.focusModeUserId()});o=function(e){return l.filter([e],d).length>0}}return e.viewer.isSidebar&&!f()&&(i=function(t){return!!t.annotation&&s.shouldShowInTab(t.annotation,e.selection.selectedTab)}),r(e.annotations.annotations,{forceVisible:c(e.selection.forceVisible),expanded:e.selection.expanded,highlighted:e.selection.highlighted,selected:c(e.selection.selectedAnnotationMap||{}),sortCompareFn:a,filterFn:o,threadFilterFn:i})}))}t.exports=l},{"../build-thread":78,"../events":137,"../util/annotation-metadata":196,"../util/memoize":209,"../util/tabs":221}],162:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e){var t=e.slice(0,e.indexOf(":"));return t&&["group","quote","result","since","tag","text","uri","user"].includes(t)?[t,e.slice(t.length+1)]:[null,e]}function i(e){if(!e)return[];var t=function(e){var t=e.slice(0,1),n=e.slice(-1);return'"'!==t&&"'"!==t||t!==n||(e=e.slice(1,e.length-1)),e},n=e.match(/(?:[^\s"']+|"[^"]*"|'[^']*')+/g);n=n.map(t);for(var i=0;i<n.length;i++){var a=r(o(n[i]),2),s=a[0],c=a[1];s&&(n[i]=s+":"+t(c))}return n}function a(e){var t,n={},a=function(e,t){return n[e]?n[e].push(t):n[e]=[t]};if(e){var s=i(e),c=!0,u=!1,l=void 0;try{for(var f,d=s[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var p=f.value,h=r(o(p),2),m=h[0],g=h[1];m||(m="any",g=p),a("tag"===(t=m)?"tags":t,g)}}catch(e){u=!0,l=e}finally{try{c||null==d.return||d.return()}finally{if(u)throw l}}}return n}function s(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],o=[],a=[],s=[],c=[],u=[],l=[],f=n.user?[n.user]:[];if(e){t=i(e);var d=!0,p=!1,h=void 0;try{for(var m,g=t[Symbol.iterator]();!(d=(m=g.next()).done);d=!0){var v=m.value,y=void 0;switch(v.slice(0,v.indexOf(":"))){case"quote":o.push(v.slice(6));break;case"result":a.push(v.slice(7));break;case"since":var b=v.slice(6).toLowerCase();b.match(/^\d+$/)&&s.push(1*b),b.match(/^\d+sec$/)&&(y=/^(\d+)sec$/.exec(b)[1],s.push(1*y)),b.match(/^\d+min$/)&&(y=/^(\d+)min$/.exec(b)[1],s.push(60*y)),b.match(/^\d+hour$/)&&(y=/^(\d+)hour$/.exec(b)[1],s.push(60*y*60)),b.match(/^\d+day$/)&&(y=/^(\d+)day$/.exec(b)[1],s.push(60*y*60*24)),b.match(/^\d+week$/)&&(y=/^(\d+)week$/.exec(b)[1],s.push(60*y*60*24*7)),b.match(/^\d+month$/)&&(y=/^(\d+)month$/.exec(b)[1],s.push(60*y*60*24*30)),b.match(/^\d+year$/)&&(y=/^(\d+)year$/.exec(b)[1],s.push(60*y*60*24*365));break;case"tag":c.push(v.slice(4));break;case"text":u.push(v.slice(5));break;case"uri":l.push(v.slice(4));break;case"user":f.push(v.slice(5));break;default:r.push(v)}}}catch(e){p=!0,h=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw h}}}return{any:{terms:r,operator:"and"},quote:{terms:o,operator:"and"},result:{terms:a,operator:"min"},since:{terms:s,operator:"and"},tag:{terms:c,operator:"and"},text:{terms:u,operator:"and"},uri:{terms:l,operator:"or"},user:{terms:f,operator:"or"}}}t.exports=function(){return{toObject:a,generateFacetedFilter:s}}},{}],163:[function(e,t,n){"use strict";o.$inject=["store","apiRoutes"];var r=e("../util/url");function o(e,t){return t.links().then(e.updateLinks).catch((function(e){console.warn("The links API request was rejected: "+e.message)})),function(t,n){var o=e.getState().links;if(null===o)return"";var i=o[t];if(!i)throw new Error("Unknown link "+t);n=n||{};var a=r.replaceURLParams(i,n),s=Object.keys(a.params);if(s.length>0)throw new Error("Unknown link parameters: "+s.join(", "));return a.url}}t.exports=o},{"../util/url":224}],164:[function(e,t,n){"use strict";s.$inject=["$rootScope","analytics","store","api","auth","flash","settings","serviceConfig"];var r=e("../events"),o=e("../util/retry"),i=e("../util/sentry"),a=3e5;function s(e,t,n,s,c,u,l,f){var d,p,h={};function m(){return(!p||Date.now()-p>a)&&(p=Date.now(),d=o.retryPromiseOperation((function(){var e,t=null===(e=f(l))?null:e.authority,n={};return t&&(n.authority=t),s.profile.read(n)}),h).then((function(e){return g(e),p=Date.now(),e})).catch((function(e){throw p=null,e}))),d}function g(t){var o=n.getState().session,a=t.userid!==o.userid;return n.updateSession(t),d=Promise.resolve(t),p=Date.now(),a&&(e.$broadcast(r.USER_CHANGED,{profile:t}),t.userid?i.setUserInfo({id:t.userid}):i.setUserInfo(null)),t}function v(){return d=null,p=null,m()}return e.$on(r.OAUTH_TOKENS_CHANGED,(function(){v()})),{dismissSidebarTutorial:function(){return s.profile.update({},{preferences:{show_sidebar_tutorial:!1}}).then(g)},load:m,logout:function(){return c.logout().then((function(){return v()})).catch((function(e){throw u.error("Log out failed"),t.track(t.events.LOGOUT_FAILURE),new Error(e)})).then((function(){t.track(t.events.LOGOUT_SUCCESS)}))},reload:v,profileFetchRetryOpts:h,get state(){return n.getState().session},update:g}}t.exports=s},{"../events":137,"../util/retry":215,"../util/sentry":217}],165:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.resetFilter()}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"addClause",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.filter.clauses.push({field:e,operator:t,value:n,case_sensitive:r}),this}},{key:"getFilter",value:function(){return this.filter}},{key:"resetFilter",value:function(){return this.filter={match_policy:"include_any",clauses:[],actions:{create:!0,update:!0,delete:!0}},this}}]),e}();t.exports=o},{}],166:[function(e,t,n){"use strict";s.$inject=["$rootScope","annotationMapper","store","auth","groups","session","settings"];var r=e("query-string"),o=e("node-uuid"),i=e("../../shared/warn-once"),a=e("../websocket");function s(e,t,n,s,c,u,l){var f,d=o.v4(),p={};function h(e){i("Error connecting to H push notification service:",e);var t=new URL(l.websocketUrl).hostname;-1!==["localhost","127.0.0.1"].indexOf(t)&&i("Check that your H service is configured to allow WebSocket connections from "+window.location.origin)}function m(t){e.$apply((function(){var e=JSON.parse(t.data);if(e)if("annotation-notification"===e.type)!function(e){var t=e.options.action,r=e.payload;switch(t){case"create":case"update":case"past":n.receiveRealTimeUpdates({updatedAnnotations:r});break;case"delete":n.receiveRealTimeUpdates({deletedAnnotations:r})}n.isSidebar()||b()}(e);else if("session-change"===e.type)!function(e){u.update(e.model),c.load()}(e);else if("whoyouare"===e.type){var r=n.getState().session.userid;e.userid!==r&&console.warn('WebSocket user ID "%s" does not match logged-in ID "%s"',e.userid,r)}else i("received unsupported notification",e.type)}))}function g(){Object.keys(p).forEach((function(e){p[e]&&f.send(p[e])}))}function v(e,t){p[e]=t,f&&f.isConnected()&&f.send(t)}var y=function(){return l.websocketUrl?s.tokenGetter().then((function(e){var t;if(e){var n=new URL(l.websocketUrl),o=r.parse(n.search);o.access_token=e,n.search=r.stringify(o),t=n.toString()}else t=l.websocketUrl;(f=new a(t)).on("open",g),f.on("error",h),f.on("message",m),v("client-id",{messageType:"client_id",value:d}),v("auth-check",{type:"whoami",id:1})})).catch((function(e){console.error("Failed to fetch token for WebSocket authentication",e)})):Promise.resolve()};function b(){var e=Object.values(n.pendingUpdates());e.length&&t.loadAnnotations(e);var r=Object.keys(n.pendingDeletions()).map((function(e){return{id:e}}));r.length&&t.unloadAnnotations(r),n.clearPendingUpdates()}this.applyPendingUpdates=b,this.clientId=d,this.configMessages=p,this.connect=function(){return f?Promise.resolve():y()},this.reconnect=function(){return f&&f.close(),y()},this.setConfig=v}t.exports=s},{"../../shared/warn-once":77,"../websocket":228,"node-uuid":10,"query-string":17}],167:[function(e,t,n){"use strict";function r(e){var t="hypothesis.user.tags.list",n="hypothesis.user.tags.map";return{filter:function(n){return(e.getObject(t)||[]).filter((function(e){return-1!==e.toLowerCase().indexOf(n.toLowerCase())}))},store:function(r){var o=e.getObject(n)||{};r.forEach((function(e){o[e.text]?(o[e.text].count+=1,o[e.text].updated=Date.now()):o[e.text]={text:e.text,count:1,updated:Date.now()}})),e.setObject(n,o);var i=Object.keys(o).sort((function(e,t){return o[e].count!==o[t].count?o[t].count-o[e].count:e.localeCompare(t)}));e.setObject(t,i)}}}r.$inject=["localStorage"],t.exports=r},{}],168:[function(e,t,n){"use strict";var r=/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E4-\u08FE\u0900-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C01-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C82\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D02\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1DC0-\u1DE6\u1DFC-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE26]/g;t.exports=function(){return{normalize:function(e){return e.normalize("NFKD")},fold:function(e){return e.replace(r,"")}}}},{}],169:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}c.$inject=["unicode"];var s=e("../util/annotation-metadata").quote;function c(e){function t(t){return"string"!=typeof t?t:e.fold(e.normalize(t)).toLowerCase()}var n=function(){function e(t,n,r){o(this,e),this.field=t,this.term=n,this.checker=r}return a(e,[{key:"matches",value:function(e){var n=this.checker;if(n.autofalse&&n.autofalse(e))return!1;var r=n.value(e);return r=Array.isArray(r)?r.map(t):t(r),n.match(this.term,r)}}]),e}(),i=function(){function e(t,n){o(this,e),this.operator=t,this.filters=n}return a(e,[{key:"matches",value:function(e){return"and"===this.operator?this.filters.every((function(t){return t.matches(e)})):this.filters.some((function(t){return t.matches(e)}))}}]),e}(),c={quote:{autofalse:function(e){return(e.references||[]).length>0},value:function(e){return s(e)||""},match:function(e,t){return t.indexOf(e)>-1}},since:{autofalse:function(e){return"string"!=typeof e.updated},value:function(e){return new Date(e.updated)},match:function(e,t){return(Date.now()-t)/1e3<=e}},tag:{autofalse:function(e){return!Array.isArray(e.tags)},value:function(e){return e.tags},match:function(e,t){return t.includes(e)}},text:{autofalse:function(e){return"string"!=typeof e.text},value:function(e){return e.text},match:function(e,t){return t.indexOf(e)>-1}},uri:{autofalse:function(e){return"string"!=typeof e.uri},value:function(e){return e.uri},match:function(e,t){return t.indexOf(e)>-1}},user:{autofalse:function(e){return"string"!=typeof e.user},value:function(e){return e.user+" "+function(e){return e.user_info&&e.user_info.display_name||""}(e)},match:function(e,t){return t.indexOf(e)>-1}}};this.filter=function(e,o){var a=Object.entries(o).filter((function(e){return r(e,2)[1].terms.length>0})).map((function(e){var o,a=r(e,2),s=a[0],u=a[1],l=u.terms.map(t);if("any"===s){var f=["quote","text","tag","user"];o=l.map((function(e){return new i("or",f.map((function(t){return new n(t,e,c[t])})))}))}else o=l.map((function(e){return new n(s,e,c[s])}));return new i(u.operator,o)})),s=new i("and",a);return e.filter((function(e){return e.id&&s.matches(e)})).map((function(e){return e.id}))}}t.exports=c},{"../util/annotation-metadata":196}],170:[function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=e("redux"),i=e("redux-thunk").default,a=e("./util"),s=a.createReducer,c=a.bindSelectors;t.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a={},u={},l={};e.forEach((function(e){e.namespace?(a[e.namespace]=e.init.apply(e,r(t)),u[e.namespace]=s(e.update),l[e.namespace]={selectors:e.selectors}):console.warn("Store module does not specify a namespace",e)}));var f=[i],d=o.applyMiddleware.apply(o,f.concat(r(n))),p=o.createStore(o.combineReducers(u),a,d),h=Object.assign.apply(Object,[{}].concat(r(e.map((function(e){return e.actions}))))),m=o.bindActionCreators(h,p.dispatch),g=c(l,p.getState);return Object.assign(p,m,g),p}},{"./util":186,redux:19,"redux-thunk":18}],171:[function(e,t,n){"use strict";t.exports=function(e){var t=0;return function(n){return function(r){if(window.debug){++t;var o=r.type+" ("+t.toString()+")";console.group(o),console.log("Prev State:",e.getState()),console.log("Action:",r),n(r),console.log("Next State:",e.getState()),console.groupEnd(o)}else n(r)}}}},{}],172:[function(e,t,n){"use strict";y.$inject=["$rootScope","settings"];var r=e("./create-store"),o=e("./debug-middleware"),i=e("./modules/activity"),a=e("./modules/annotations"),s=e("./modules/direct-linked"),c=e("./modules/drafts"),u=e("./modules/frames"),l=e("./modules/links"),f=e("./modules/groups"),d=e("./modules/real-time-updates"),p=e("./modules/selection"),h=e("./modules/session"),m=e("./modules/sidebar-panels"),g=e("./modules/viewer");function v(e){return function(t){return function(n){t(n),e.$$phase||e.$applyAsync((function(){}))}}}function y(e,t){var n=[o,v.bind(null,e)];return r([i,a,s,c,u,l,f,d,p,h,m,g],[t],n)}t.exports=y},{"./create-store":170,"./debug-middleware":171,"./modules/activity":173,"./modules/annotations":174,"./modules/direct-linked":175,"./modules/drafts":176,"./modules/frames":177,"./modules/groups":178,"./modules/links":179,"./modules/real-time-updates":180,"./modules/selection":181,"./modules/session":182,"./modules/sidebar-panels":183,"./modules/viewer":184}],173:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a={API_REQUEST_STARTED:function(e){return o({},e,{activeApiRequests:e.activeApiRequests+1})},API_REQUEST_FINISHED:function(e){if(0===e.activeApiRequests)throw new Error("API_REQUEST_FINISHED action when no requests were active");return o({},e,{activeApiRequests:e.activeApiRequests-1})},ANNOTATION_FETCH_STARTED:function(e){return o({},e,{activeAnnotationFetches:e.activeAnnotationFetches+1})},ANNOTATION_FETCH_FINISHED:function(e){if(0===e.activeAnnotationFetches)throw new Error("ANNOTATION_FETCH_FINISHED action when no annotation fetches were active");return o({},e,{activeAnnotationFetches:e.activeAnnotationFetches-1})}},s=(0,e("../util").actionTypes)(a);t.exports={init:function(){return{activeApiRequests:0,activeAnnotationFetches:0}},update:a,namespace:"activity",actions:{apiRequestStarted:function(){return{type:s.API_REQUEST_STARTED}},apiRequestFinished:function(){return{type:s.API_REQUEST_FINISHED}},annotationFetchStarted:function(){return{type:s.ANNOTATION_FETCH_STARTED}},annotationFetchFinished:function(){return{type:s.ANNOTATION_FETCH_FINISHED}}},selectors:{isLoading:function(e){return e.activity.activeApiRequests>0},isFetchingAnnotations:function(e){return e.activity.activeAnnotationFetches>0}}}},{"../util":186}],174:[function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=e("reselect").createSelector,i=e("../../util/array"),a=e("../../util/annotation-metadata"),s=e("../../ui-constants"),c=e("./selection"),u=e("./drafts");function l(e,t){return e.find((function(e){return e.id===t}))}function f(e,t){return e.find((function(e){return e.$tag===t}))}var d={ADD_ANNOTATIONS:function(e,t){var n={},r={},o=[],i=[],a=[],s=e.nextTag;return t.annotations.forEach((function(t){var i;t.id&&(i=l(e.annotations,t.id)),!i&&t.$tag&&(i=f(e.annotations,t.$tag)),i?(a.push(Object.assign({},i,t)),t.id&&(n[t.id]=!0),i.$tag&&(r[i.$tag]=!0)):(o.push(function(e,t){var n=e.$orphan;return e.id||(n=!1),Object.assign({},e,{$anchorTimeout:!1,$tag:e.$tag||t,$orphan:n})}(t,"t"+s)),++s)})),e.annotations.forEach((function(e){n[e.id]||r[e.$tag]||i.push(e)})),{annotations:o.concat(a).concat(i),nextTag:s}},REMOVE_ANNOTATIONS:function(e,t){return{annotations:r(t.remainingAnnotations)}},CLEAR_ANNOTATIONS:function(){return{annotations:[]}},UPDATE_FLAG_STATUS:function(e,t){return{annotations:e.annotations.map((function(e){if(e.id&&e.id===t.id){if(e.flagged===t.isFlagged)return e;var n=Object.assign({},e,{flagged:t.isFlagged});if(n.moderation){var r=t.isFlagged?1:-1;n.moderation=Object.assign({},e.moderation,{flagCount:e.moderation.flagCount+r})}return n}return e}))}},UPDATE_ANCHOR_STATUS:function(e,t){return{annotations:e.annotations.map((function(e){if(!t.statusUpdates.hasOwnProperty(e.$tag))return e;var n=t.statusUpdates[e.$tag];return"timeout"===n?Object.assign({},e,{$anchorTimeout:!0}):Object.assign({},e,{$orphan:"orphan"===n})}))}},HIDE_ANNOTATION:function(e,t){return{annotations:e.annotations.map((function(e){return e.id!==t.id?e:Object.assign({},e,{hidden:!0})}))}},UNHIDE_ANNOTATION:function(e,t){return{annotations:e.annotations.map((function(e){return e.id!==t.id?e:Object.assign({},e,{hidden:!1})}))}}},p=e("../util").actionTypes(d);function h(e,t){return t=t||new Date,e=e.map((function(e){return e.id?e:Object.assign({created:t.toISOString(),updated:t.toISOString()},e)})),function(t,n){var r=e.filter((function(e){return!l(n().annotations.annotations,e.id)}));if(t({type:p.ADD_ANNOTATIONS,annotations:e,currentAnnotationCount:n().annotations.annotations.length}),n().viewer.isSidebar){var o=r.filter(a.isWaitingToAnchor).map((function(e){return e.id}));o.length>0&&setTimeout((function(){var e=n().annotations.annotations,r=o.map((function(t){return l(e,t)})).filter((function(e){return e&&a.isWaitingToAnchor(e)})).reduce((function(e,t){return e[t.$tag]="timeout",e}),{});t(m(r))}),500)}}}function m(e){return{type:p.UPDATE_ANCHOR_STATUS,statusUpdates:e}}var g=o((function(e){return e.annotations.annotations}),(function(e){return i.countIf(e,a.isPageNote)})),v=o((function(e){return e.annotations.annotations}),(function(e){return i.countIf(e,a.isAnnotation)})),y=o((function(e){return e.annotations.annotations}),(function(e){return i.countIf(e,a.isOrphan)})),b=o((function(e){return e.annotations.annotations}),(function(e){return e.some(a.isWaitingToAnchor)}));t.exports={init:function(){return{annotations:[],nextTag:1}},namespace:"annotations",update:d,actions:{addAnnotations:h,clearAnnotations:function(){return{type:p.CLEAR_ANNOTATIONS}},createAnnotation:function(e){return function(t){t(u.actions.deleteNewAndEmptyDrafts([e])),t(h([e])),a.isPageNote(e)?t(c.actions.selectTab(s.TAB_NOTES)):a.isAnnotation(e)&&t(c.actions.selectTab(s.TAB_ANNOTATIONS)),(e.references||[]).forEach((function(e){t(c.actions.setCollapsed(e,!1))}))}},hideAnnotation:function(e){return{type:p.HIDE_ANNOTATION,id:e}},removeAnnotations:function(e){return function(t,n){var r=function(e,t){var n={},r={};return t.forEach((function(e){e.id&&(n[e.id]=!0),e.$tag&&(r[e.$tag]=!0)})),e.filter((function(e){return!(e.id&&e.id in n||e.$tag&&e.$tag in r)}))}(n().annotations.annotations,e);t({type:p.REMOVE_ANNOTATIONS,annotationsToRemove:e,remainingAnnotations:r})}},updateAnchorStatus:m,updateFlagStatus:function(e,t){return{type:p.UPDATE_FLAG_STATUS,id:e,isFlagged:t}},unhideAnnotation:function(e){return{type:p.UNHIDE_ANNOTATION,id:e}}},selectors:{annotationExists:function(e,t){return e.annotations.annotations.some((function(e){return e.id===t}))},noteCount:g,annotationCount:v,orphanCount:y,isWaitingToAnchorAnnotations:b,findAnnotationByID:function(e,t){return l(e.annotations.annotations,t)},findIDsForTags:function(e,t){var n=[];return t.forEach((function(t){var r=f(e.annotations.annotations,t);r&&r.id&&n.push(r.id)})),n},savedAnnotations:function(e){return e.annotations.annotations.filter((function(e){return!a.isNew(e)}))}}}},{"../../ui-constants":194,"../../util/annotation-metadata":196,"../../util/array":198,"../util":186,"./drafts":176,"./selection":181,reselect:20}],175:[function(e,t,n){"use strict";var r={UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED:function(e,t){return{directLinkedGroupFetchFailed:t.directLinkedGroupFetchFailed}},UPDATE_DIRECT_LINKED_GROUP_ID:function(e,t){return{directLinkedGroupId:t.directLinkedGroupId}},UPDATE_DIRECT_LINKED_ANNOTATION_ID:function(e,t){return{directLinkedAnnotationId:t.directLinkedAnnotationId}},CLEAR_DIRECT_LINKED_IDS:function(){return{directLinkedAnnotationId:null,directLinkedGroupId:null}},CLEAR_SELECTION:function(){return{directLinkedAnnotationId:null,directLinkedGroupId:null,directLinkedGroupFetchFailed:!1}}},o=e("../util").actionTypes(r);t.exports={init:function(e){return{directLinkedGroupId:e.group||null,directLinkedAnnotationId:e.annotations||null,directLinkedGroupFetchFailed:!1}},namespace:"directLinked",update:r,actions:{setDirectLinkedGroupFetchFailed:function(){return{type:o.UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED,directLinkedGroupFetchFailed:!0}},setDirectLinkedGroupId:function(e){return{type:o.UPDATE_DIRECT_LINKED_GROUP_ID,directLinkedGroupId:e}},setDirectLinkedAnnotationId:function(e){return{type:o.UPDATE_DIRECT_LINKED_ANNOTATION_ID,directLinkedAnnotationId:e}},clearDirectLinkedGroupFetchFailed:function(){return{type:o.UPDATE_DIRECT_LINKED_GROUP_FETCH_FAILED,directLinkedGroupFetchFailed:!1}},clearDirectLinkedIds:function(){return{type:o.CLEAR_DIRECT_LINKED_IDS}}},selectors:{}}},{"../util":186}],176:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=e("../../util/annotation-metadata"),i=e("../util");var a=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.annotation={id:t.id,$tag:t.$tag},this.isPrivate=n.isPrivate,this.tags=n.tags,this.text=n.text}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"match",value:function(e){return this.annotation.$tag&&e.$tag===this.annotation.$tag||this.annotation.id&&e.id===this.annotation.id}},{key:"isEmpty",value:function(){return!this.text&&0===this.tags.length}}]),e}(),s={DISCARD_ALL_DRAFTS:function(){return[]},REMOVE_DRAFT:function(e,t){return e.filter((function(e){return!e.match(t.annotation)}))},UPDATE_DRAFT:function(e,t){var n=e.filter((function(e){return!e.match(t.draft.annotation)}));return n.push(t.draft),n}},c=i.actionTypes(s);function u(e){return{type:c.REMOVE_DRAFT,annotation:e}}function l(e,t){for(var n=e.drafts,r=0;r<n.length;r++){var o=n[r];if(o.match(t))return o}return null}function f(e,t){var n=l(e,t);return n?n.isEmpty()?null:n:null}t.exports={init:function(){return[]},namespace:"drafts",update:s,actions:{createDraft:function(e,t){return{type:c.UPDATE_DRAFT,draft:new a(e,t)}},deleteNewAndEmptyDrafts:function(){var t=e("./annotations");return function(e,n){var r=n().drafts.filter((function(e){return o.isNew(e.annotation)&&!f(n(),e.annotation)})).map((function(t){return e(u(t.annotation)),t.annotation}));e(t.actions.removeAnnotations(r))}},discardAllDrafts:function(){return{type:c.DISCARD_ALL_DRAFTS}},removeDraft:u},selectors:{countDrafts:function(e){return e.drafts.length},getDraft:l,getDraftIfNotEmpty:f,unsavedAnnotations:function(e){return e.drafts.filter((function(e){return!e.annotation.id})).map((function(e){return e.annotation}))}},Draft:a}},{"../../util/annotation-metadata":196,"../util":186,"./annotations":174}],177:[function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=e("reselect").createSelector;var i={CONNECT_FRAME:function(e,t){return[].concat(r(e),[t.frame])},DESTROY_FRAME:function(e,t){return e.filter((function(e){return e!==t.frame}))},UPDATE_FRAME_ANNOTATION_FETCH_STATUS:function(e,t){return e.map((function(e){return e.uri&&e.uri===t.uri?Object.assign({},e,{isAnnotationFetchComplete:t.isAnnotationFetchComplete}):e}))}},a=e("../util").actionTypes(i);var s=o((function(e){return e.frames}),(function(e){return e.find((function(e){return!e.id}))||null}));t.exports={init:function(){return[]},namespace:"frames",update:i,actions:{connectFrame:function(e){return{type:a.CONNECT_FRAME,frame:e}},destroyFrame:function(e){return{type:a.DESTROY_FRAME,frame:e}},updateFrameAnnotationFetchStatus:function(e,t){return{type:a.UPDATE_FRAME_ANNOTATION_FETCH_STATUS,isAnnotationFetchComplete:t,uri:e}}},selectors:{frames:function(e){return e.frames},mainFrame:s,searchUris:function(e){return e.frames.reduce((function(e,t){return e.concat(function(e){var t=[e.uri];return e.metadata&&e.metadata.documentFingerprint&&(t=e.metadata.link.map((function(e){return e.href}))),e.metadata&&e.metadata.link&&e.metadata.link.forEach((function(e){e.href.startsWith("doi:")&&t.push(e.href)})),t}(t))}),[])}}}},{"../util":186,reselect:20}],178:[function(e,t,n){"use strict";var r=e("reselect").createSelector,o=e("../util"),i=e("./session").selectors.isLoggedIn;var a={FOCUS_GROUP:function(e,t){return e.groups.find((function(e){return e.id===t.id}))?{focusedGroupId:t.id}:(console.error("Attempted to focus group ".concat(t.id," which is not loaded")),{})},LOAD_GROUPS:function(e,t){var n=t.groups,r=e.focusedGroupId;return null!==e.focusedGroupId&&n.find((function(t){return t.id===e.focusedGroupId}))||(r=n.length>0?n[0].id:null),{focusedGroupId:r,groups:t.groups}},CLEAR_GROUPS:function(){return{focusedGroupId:null,groups:[]}}},s=o.actionTypes(a);function c(e){return e.groups.groups}function u(e,t){return e.groups.groups.find((function(e){return e.id===t}))}var l=r((function(e){return e.groups.groups}),i,(function(e,t){return t?e.filter((function(e){return e.isMember})):[]})),f=r((function(e){return e.groups.groups}),(function(e){return e.filter((function(e){return!e.isMember&&e.isScopedToUri}))})),d=r(c,l,f,(function(e,t,n){return e.filter((function(e){return!t.includes(e)&&!n.includes(e)}))})),p=r((function(e){return e.groups.groups}),(function(e){return e.filter((function(e){return e.isScopedToUri}))}));t.exports={init:function(){return{groups:[],focusedGroupId:null}},namespace:"groups",update:a,actions:{focusGroup:function(e){return{type:s.FOCUS_GROUP,id:e}},loadGroups:function(e){return{type:s.LOAD_GROUPS,groups:e}},clearGroups:function(){return{type:s.CLEAR_GROUPS}}},selectors:{allGroups:c,getGroup:u,getCurrentlyViewingGroups:d,getFeaturedGroups:f,getMyGroups:l,getInScopeGroups:p,focusedGroup:function(e){return e.groups.focusedGroupId?u(e,e.groups.focusedGroupId):null},focusedGroupId:function(e){return e.groups.focusedGroupId}}}},{"../util":186,"./session":182,reselect:20}],179:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.exports={init:function(){return null},namespace:"links",update:{UPDATE_LINKS:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.newLinks)}},actions:{updateLinks:function(e){return{type:"UPDATE_LINKS",newLinks:e}}},selectors:{}}},{}],180:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=e("reselect").createSelector,c=e("../util").actionTypes,u=e("./annotations").selectors,l=e("./groups").selectors,f=e("./viewer").selectors;var d={RECEIVE_REAL_TIME_UPDATES:function(e,t){return{pendingUpdates:i({},t.pendingUpdates),pendingDeletions:i({},t.pendingDeletions)}},CLEAR_PENDING_UPDATES:function(){return{pendingUpdates:{},pendingDeletions:{}}},ADD_ANNOTATIONS:function(e,t){var n=t.annotations,r=i({},e.pendingUpdates);return n.forEach((function(e){return delete r[e.id]})),{pendingUpdates:r}},REMOVE_ANNOTATIONS:function(e,t){var n=t.annotationsToRemove,r=i({},e.pendingUpdates),o=i({},e.pendingDeletions);return n.forEach((function(e){delete r[e.id],delete o[e.id]})),{pendingUpdates:r,pendingDeletions:o}},FOCUS_GROUP:function(){return{pendingUpdates:{},pendingDeletions:{}}}},p=c(d);var h=s((function(e){return[e.realTimeUpdates.pendingUpdates,e.realTimeUpdates.pendingDeletions]}),(function(e){var t=r(e,2),n=t[0],o=t[1];return Object.keys(n).length+Object.keys(o).length}));t.exports={init:function(){return{pendingUpdates:{},pendingDeletions:{}}},namespace:"realTimeUpdates",update:d,actions:{receiveRealTimeUpdates:function(e){var t=e.updatedAnnotations,n=void 0===t?[]:t,r=e.deletedAnnotations,o=void 0===r?[]:r;return function(e,t){var r=i({},t().realTimeUpdates.pendingUpdates),a=i({},t().realTimeUpdates.pendingDeletions);n.forEach((function(e){e.group!==l.focusedGroupId(t())&&f.isSidebar(t())||(r[e.id]=e)})),o.forEach((function(e){delete r[e.id],u.annotationExists(t(),e.id)&&(a[e.id]=!0)})),e({type:p.RECEIVE_REAL_TIME_UPDATES,pendingUpdates:r,pendingDeletions:a})}},clearPendingUpdates:function(){return{type:p.CLEAR_PENDING_UPDATES}}},selectors:{hasPendingDeletion:function(e,t){return e.realTimeUpdates.pendingDeletions.hasOwnProperty(t)},pendingDeletions:function(e){return e.realTimeUpdates.pendingDeletions},pendingUpdates:function(e){return e.realTimeUpdates.pendingUpdates},pendingUpdateCount:h}}},{"../util":186,"./annotations":174,"./groups":178,"./viewer":184,reselect:20}],181:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=e("reselect").createSelector,s=e("seamless-immutable"),c=e("../../util/array"),u=e("../../util/annotation-metadata"),l=e("../../util/array").toSet,f=e("../../ui-constants"),d=e("../util"),p=f.TAB_ANNOTATIONS,h={};h[f.TAB_ANNOTATIONS]="Location",h[f.TAB_NOTES]="Oldest",h[f.TAB_ORPHANS]="Location";var m={};function g(e){var t={};return e.annotations&&!e.query&&(t[e.annotations]=!0),v(t)}function v(e){return Object.keys(e).length?s(e):null}m[f.TAB_ANNOTATIONS]=["Newest","Oldest","Location"],m[f.TAB_NOTES]=["Newest","Oldest"],m[f.TAB_ORPHANS]=["Newest","Oldest","Location"];var y=function(e,t){return-1===[f.TAB_ANNOTATIONS,f.TAB_NOTES,f.TAB_ORPHANS].indexOf(t)?{}:e===t?{}:{selectedTab:t,sortKey:h[t],sortKeysAvailable:m[t]}};var b={CLEAR_SELECTION:function(e){var t=e.selectedTab;return t===f.TAB_ORPHANS&&(t=f.TAB_ANNOTATIONS),o({filterQuery:null,selectedAnnotationMap:null},y(e.selectedTab,t))},CLEAR_SELECTED_ANNOTATIONS:function(){return{filterQuery:null,selectedAnnotationMap:null}},SELECT_ANNOTATIONS:function(e,t){return{selectedAnnotationMap:t.selection}},FOCUS_ANNOTATIONS:function(e,t){return{focusedAnnotationMap:t.focused}},SET_FOCUS_MODE_FOCUSED:function(e,t){return{focusMode:o({},e.focusMode,{focused:t.focused})}},CHANGE_FOCUS_MODE_USER:function(e,t){return void 0===t.user.username?{focusMode:o({},e.focusMode,{enabled:!1,focused:!1})}:{focusMode:o({},e.focusMode,{enabled:!0,focused:!0,config:{user:o({},t.user)}})}},SET_FORCE_VISIBLE:function(e,t){return{forceVisible:t.forceVisible}},SET_EXPANDED:function(e,t){return{expanded:t.expanded}},HIGHLIGHT_ANNOTATIONS:function(e,t){return{highlighted:t.highlighted}},SELECT_TAB:function(e,t){return y(e.selectedTab,t.tab)},ADD_ANNOTATIONS:function(e,t){var n=c.countIf(t.annotations,u.isPageNote)===t.annotations.length;return 0===t.currentAnnotationCount&&n?{selectedTab:f.TAB_NOTES}:{}},REMOVE_ANNOTATIONS:function(e,t){var n=Object.assign({},e.selectedAnnotationMap);t.annotationsToRemove.forEach((function(e){e.id&&delete n[e.id]}));var r=e.selectedTab;return r===f.TAB_ORPHANS&&0===c.countIf(t.remainingAnnotations,u.isOrphan)&&(r=f.TAB_ANNOTATIONS),{selectedAnnotationMap:v(n),selectedTab:r}},SET_FILTER_QUERY:function(e,t){return{filterQuery:t.query,forceVisible:{},expanded:{}}},SET_SORT_KEY:function(e,t){return{sortKey:t.key}}},_=d.actionTypes(b);function w(e){return{type:_.SELECT_ANNOTATIONS,selection:v(e)}}var A=a((function(e){return e.selection.selectedAnnotationMap}),(function(e){return e?Object.keys(e)[0]:null}));function T(e){return e.selection.focusMode.enabled}function E(e){if(e.selection.focusMode.config.user){if(e.selection.focusMode.config.user.userid)return e.selection.focusMode.config.user.userid;if(e.selection.focusMode.config.user.username)return e.selection.focusMode.config.user.username}return null}t.exports={init:function(e){return{focusedAnnotationMap:null,selectedAnnotationMap:g(e),expanded:g(e)||{},forceVisible:{},highlighted:[],filterQuery:e.query||null,selectedTab:p,focusMode:{enabled:e.hasOwnProperty("focus"),focused:!0,config:o({},e.focus?e.focus:{})},sortKey:h[p],sortKeysAvailable:m[p]}},namespace:"selection",update:b,actions:{clearSelectedAnnotations:function(){return{type:_.CLEAR_SELECTED_ANNOTATIONS}},clearSelection:function(){return{type:_.CLEAR_SELECTION}},focusAnnotations:function(e){return{type:_.FOCUS_ANNOTATIONS,focused:v(l(e))}},highlightAnnotations:function(e){return{type:_.HIGHLIGHT_ANNOTATIONS,highlighted:e}},selectAnnotations:function(e){return w(l(e))},selectTab:function(e){return{type:_.SELECT_TAB,tab:e}},setCollapsed:function(e,t){return function(n,r){var o=Object.assign({},r().selection.expanded);o[e]=!t,n({type:_.SET_EXPANDED,expanded:o})}},setFilterQuery:function(e){return{type:_.SET_FILTER_QUERY,query:e}},setFocusModeFocused:function(e){return{type:_.SET_FOCUS_MODE_FOCUSED,focused:e}},changeFocusModeUser:function(e){return{type:_.CHANGE_FOCUS_MODE_USER,user:e}},setForceVisible:function(e,t){return function(n,r){var o=Object.assign({},r().selection.forceVisible);o[e]=t,n({type:_.SET_FORCE_VISIBLE,forceVisible:o})}},setSortKey:function(e){return{type:_.SET_SORT_KEY,key:e}},toggleSelectedAnnotations:function(e){return function(t,n){for(var r=Object.assign({},n().selection.selectedAnnotationMap),o=0;o<e.length;o++){var i=e[o];r[i]?delete r[i]:r[i]=!0}t(w(r))}}},selectors:{hasSelectedAnnotations:function(e){return!!e.selection.selectedAnnotationMap},filterQuery:function(e){return e.selection.filterQuery},focusModeFocused:function(e){return T(e)&&e.selection.focusMode.focused},focusModeEnabled:T,focusModeHasUser:function(e){return T(e)&&!!E(e)},focusModeUserId:E,focusModeUserPrettyName:function(e){var t=e.selection.focusMode.config.user;return t?t.displayName?t.displayName:t.userid?t.userid:t.username?t.username:"":""},isAnnotationSelected:function(e,t){return(e.selection.selectedAnnotationMap||{}).hasOwnProperty(t)},getFirstSelectedAnnotationId:A}}},{"../../ui-constants":194,"../../util/annotation-metadata":196,"../../util/array":198,"../util":186,reselect:20,"seamless-immutable":25}],182:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i={UPDATE_SESSION:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.session)}},a=e("../util").actionTypes(i);t.exports={init:function(){return{features:{},preferences:{},userid:null}},namespace:"session",update:i,actions:{updateSession:function(e){return{type:a.UPDATE_SESSION,session:e}}},selectors:{isFeatureEnabled:function(e,t){return!!e.session.features[t]},isLoggedIn:function(e){return null!==e.session.userid},profile:function(e){return e.session}}}},{"../util":186}],183:[function(e,t,n){"use strict";var r={OPEN_SIDEBAR_PANEL:function(e,t){return{activePanelName:t.panelName}},CLOSE_SIDEBAR_PANEL:function(e,t){var n=e.activePanelName;return t.panelName===n&&(n=null),{activePanelName:n}},TOGGLE_SIDEBAR_PANEL:function(e,t){var n=e.activePanelName===t.panelName,r=void 0!==t.panelState?t.panelState:!n;return{activePanelName:r?t.panelName:n&&!r?null:e.activePanelName}}},o=e("../util").actionTypes(r);t.exports={namespace:"sidebarPanels",init:function(){return{activePanelName:null}},update:r,actions:{openSidebarPanel:function(e){return{type:o.OPEN_SIDEBAR_PANEL,panelName:e}},closeSidebarPanel:function(e){return{type:o.CLOSE_SIDEBAR_PANEL,panelName:e}},toggleSidebarPanel:function(e,t){return{type:o.TOGGLE_SIDEBAR_PANEL,panelName:e,panelState:t}}},selectors:{isSidebarPanelOpen:function(e,t){return e.sidebarPanels.activePanelName===t}}}},{"../util":186}],184:[function(e,t,n){"use strict";var r={SET_SIDEBAR:function(e,t){return{isSidebar:t.isSidebar}},SET_HIGHLIGHTS_VISIBLE:function(e,t){return{visibleHighlights:t.visible}}},o=e("../util").actionTypes(r);t.exports={init:function(){return{isSidebar:!0,visibleHighlights:!1}},namespace:"viewer",update:r,actions:{setAppIsSidebar:function(e){return{type:o.SET_SIDEBAR,isSidebar:e}},setShowHighlights:function(e){return{type:o.SET_HIGHLIGHTS_VISIBLE,visible:e}}},selectors:{isSidebar:function(e){return e.viewer.isSidebar}}}},{"../util":186}],185:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("shallowequal"),i=e("preact/hooks"),a=i.useEffect,s=i.useRef,c=i.useReducer,u=e("../util/service-context").useService;e("../../shared/warn-once");t.exports=function(e){var t=u("store"),n=s(null);n.current=e;var i=s(null);i.current=e(t);var l=r(c((function(e){return e+1}),0),2)[1];return a((function(){function e(){var e=n.current(t);o(e,i.current)||(i.current=e,l())}return e(),t.subscribe(e)}),[l,t]),i.current}},{"../../shared/warn-once":77,"../util/service-context":218,"preact/hooks":13,shallowequal:26}],186:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t.exports={actionTypes:function(e){return Object.keys(e).reduce((function(e,t){return e[t]=t,e}),{})},bindSelectors:function(e,t){var n={};return Object.keys(e).forEach((function(r){var o=e[r].selectors;Object.keys(o).forEach((function(e){n[e]=function(){var n=[].slice.apply(arguments);return n.unshift(t()),o[e].apply(null,n)}}))})),n},createReducer:function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=e[n.type];return r?Array.isArray(t)?a(r(t,n)):o({},t,{},r(t,n)):t}}}},{}],187:[function(e,t,n){t.exports='<div ng-class="vm.threadClasses()">\n  <div class="annotation-thread__thread-edge" ng-if="!vm.isTopLevelThread()">\n    <a href=""\n       ng-class="vm.threadToggleClasses()"\n       title="{{vm.thread.collapsed && \'Expand\' || \'Collapse\'}}"\n       ng-click="vm.toggleCollapsed()">\n       <span ng-class="{\'h-icon-arrow-right\': vm.thread.collapsed,\n                        \'h-icon-arrow-drop-down\': !vm.thread.collapsed}"></span>\n    </a>\n    <div class="annotation-thread__thread-line"></div>\n  </div>\n  <div class="annotation-thread__content">\n    <moderation-banner\n      annotation="vm.thread.annotation"\n      ng-if="vm.thread.annotation">\n    </moderation-banner>\n    <annotation ng-class="vm.annotationClasses()"\n             annotation="vm.thread.annotation"\n             is-collapsed="vm.thread.collapsed"\n             name="annotation"\n             ng-mouseenter="vm.annotationHovered = true"\n             ng-mouseleave="vm.annotationHovered = false"\n             ng-if="vm.thread.annotation"\n             ng-show="vm.thread.visible"\n             show-document-info="vm.showDocumentInfo"\n             on-reply-count-click="vm.toggleCollapsed()"\n             reply-count="vm.thread.replyCount">\n    </annotation>\n\n    <div ng-if="!vm.thread.annotation" class="thread-deleted">\n      <p><em>Message not available.</em></p>\n    </div>\n\n    <div ng-if="vm.hiddenCount() > 0">\n      <a class="small"\n         href=""\n         ng-click="vm.showThreadAndReplies()"\n         ng-pluralize\n         count="vm.hiddenCount()"\n         when="{\'0\': \'\',\n               one: \'View one more in conversation\',\n               other: \'View {} more in conversation\'}"\n         ></a>\n    </div>\n\n    \x3c!-- Replies --\x3e\n    <ul ng-show="!vm.thread.collapsed">\n      <li ng-repeat="child in vm.thread.children track by child.id"\n          ng-show="vm.shouldShowReply(child)">\n        <annotation-thread\n          show-document-info="false"\n          thread="child"\n          on-change-collapsed="vm.onChangeCollapsed({id:id, collapsed:collapsed})"\n          on-force-visible="vm.onForceVisible(thread)">\n        </annotation-thread>\n      </li>\n    </ul>\n  </div>\n</div>\n'},{}],188:[function(e,t,n){t.exports='<thread-list\n  on-change-collapsed="vm.setCollapsed(id, collapsed)"\n  on-force-visible="vm.forceVisible(thread)"\n  show-document-info="true"\n  thread="vm.rootThread()">\n</thread-list>\n'},{}],189:[function(e,t,n){t.exports='<header class="annotation-header" ng-if="!vm.user()">\n  <strong>You must be logged in to create annotations and highlights.</strong>\n</header>\n\n<div ng-keydown="vm.onKeydown($event)" ng-if="vm.user()">\n\n  <annotation-header annotation="vm.annotation"\n                         is-editing="vm.editing()"\n                         is-highlight="vm.isHighlight()"\n                         is-private="vm.state().isPrivate"\n                         on-reply-count-click="vm.onReplyCountClick()"\n                         reply-count="vm.replyCount"\n                         show-document-info="vm.showDocumentInfo">\n  </annotation-header>\n\n  <annotation-quote\n    quote="vm.quote()"\n    is-orphan="vm.isOrphan()"\n    ng-if="vm.quote()">\n  </annotation-quote>\n\n  <annotation-body\n    collapse="vm.collapseBody"\n    is-editing="vm.editing()"\n    is-hidden-by-moderator="vm.isHiddenByModerator()"\n    on-collapsible-changed="vm.setBodyCollapsible(collapsible)"\n    on-edit-text="vm.setText(text)"\n    on-toggle-collapsed="vm.collapseBody = collapsed"\n    text="vm.state().text">\n  </annotation-body>\n\n  <div class="annotation-link-more">\n    <a class="annotation-link u-strong" ng-show="vm.canCollapseBody && !vm.editing()"\n      ng-click="vm.toggleCollapseBody($event)"\n      ng-title="vm.collapseBody ? \'Show the full annotation text\' : \'Show the first few lines only\'"\n      ng-bind="vm.collapseBody ? \'More\' : \'Less\'"\n      h-branding="accentColor">mire</a>\n  </div>\n  \x3c!-- Tags --\x3e\n  <tag-editor\n    ng-if="vm.editing()"\n    annotation="vm.annotation"\n    on-edit-tags="vm.setTags(tags)"\n    tag-list="vm.state().tags" \n    />\n  </tag-editor>\n\n  <tag-list\n    ng-if="!vm.editing()"\n    annotation="vm.annotation"\n    tags="vm.state().tags"\n  ></tag-list>\n  \x3c!-- / Tags --\x3e\n\n  <footer class="annotation-footer">\n\n    <div class="annotation-form-actions" ng-if="vm.editing()">\n      <annotation-publish-control\n        group="vm.group()"\n        is-disabled="!vm.hasContent()"\n        is-shared="vm.isShared()"\n        on-cancel="vm.revert()"\n        on-save="vm.save()"\n        on-set-privacy="vm.setPrivacy(level)"></annotation-publish-control>\n    </div>\n\n    <annotation-license ng-if="vm.shouldShowLicense()"></annotation-license>\n\n    <div class="annotation-replies" ng-if="!vm.isReply() && vm.replyCount > 0">\n      <a href=""\n        ng-click="vm.onReplyCountClick()">\n        <span class="annotation-replies__link">{{ vm.isCollapsed ? \'Show replies\' : \'Hide replies\' }}</span>\n        <span class="annotation-replies__count">({{ vm.replyCount }})</span>\n      </a>\n    </div>\n\n    <div class="annotation-actions" ng-if="vm.isSaving">\n      Saving...\n    </div>\n\n    <div class="annotation-actions" ng-if="!vm.isSaving && !vm.editing() && vm.id()">\n      <annotation-action-bar\n        annotation="vm.annotation"\n        is-private="vm.state().isPrivate"\n        on-delete="vm.delete()"\n        on-flag="vm.flag()"\n        on-edit="vm.edit()"\n        on-reply="vm.reply()"></annotation-action-bar>\n    </div>\n  </footer>\n</div>\n'},{}],190:[function(e,t,n){t.exports='<div class="app-content-wrapper js-thread-list-scroll-root" h-branding="appBackgroundColor">\n  <top-bar\n    auth="vm.auth"\n    on-login="vm.login()"\n    on-sign-up="vm.signUp()"\n    on-logout="vm.logout()"\n    is-sidebar="::vm.isSidebar">\n  </top-bar>\n\n  <div class="content">\n    <help-panel auth="vm.auth"></help-panel>\n    <share-annotations-panel></share-annotations-panel>\n    <main ng-view=""></main>\n  </div>\n</div>\n'},{}],191:[function(e,t,n){t.exports='<focused-mode-header\n  ng-if="vm.showFocusedHeader()">\n</focused-mode-header>\n\n<selection-tabs\n  ng-if="vm.showSelectedTabs()"\n  is-loading="vm.isLoading()">\n</selection-tabs>\n\n<search-status-bar\n  ng-if="!vm.isLoading()">\n</search-status-bar>\n\n\x3c!-- Display error message if direct-linked annotation fetch failed. --\x3e\n<sidebar-content-error\n  class="sidebar-content-error"\n  logged-out-error-message="\'This annotation is not available.\'"\n  logged-in-error-message="\'You do not have permission to view this annotation.\'"\n  on-login-request="vm.onLogin()"\n  is-logged-in="vm.auth.status === \'logged-in\'"\n  ng-if="vm.selectedAnnotationUnavailable()"\n>\n</sidebar-content-error>\n\n\x3c!-- Display error message if direct-linked group fetch failed. --\x3e\n<sidebar-content-error\n  class="sidebar-content-error"\n  logged-out-error-message="\'This group is not available.\'"\n  logged-in-error-message="\'This group is not available.\'"\n  on-login-request="vm.onLogin()"\n  is-logged-in="vm.auth.status === \'logged-in\'"\n  ng-if="vm.selectedGroupUnavailable()"\n>\n</sidebar-content-error>\n\n<thread-list\n  on-change-collapsed="vm.setCollapsed(id, collapsed)"\n  on-focus="vm.focus(annotation)"\n  on-select="vm.scrollTo(annotation)"\n  show-document-info="false"\n  ng-if="!vm.selectedGroupUnavailable()"\n  thread="vm.rootThread()">\n</thread-list>\n\n<logged-out-message ng-if="vm.shouldShowLoggedOutMessage()" on-login="vm.onLogin()">\n</logged-out-message>\n'},{}],192:[function(e,t,n){t.exports='<span window-scroll="vm.loadMore(20)">\n  <thread-list\n    on-change-collapsed="vm.setCollapsed(id, collapsed)"\n    show-document-info="true"\n    thread="vm.rootThread()">\n  </thread-list>\n</span>\n'},{}],193:[function(e,t,n){t.exports='<ul class="thread-list">\n  <li class="thread-list__spacer"\n      ng-style="{height: vm.virtualThreadList.offscreenUpperHeight}"></li>\n  <li ng-repeat="child in vm.virtualThreadList.visibleThreads track by child.id">\n    <div id="{{child.id}}"\n        class="thread-list__card"\n        ng-mouseenter="vm.onFocus({annotation: child.annotation})"\n        ng-class="{\'thread-list__card--theme-clean\' : vm.isThemeClean }"\n        ng-click="vm.onSelect({annotation: child.annotation})"\n        ng-mouseleave="vm.onFocus({annotation: null})">\n        <annotation-thread\n          thread="child"\n          show-document-info="vm.showDocumentInfo"\n          on-change-collapsed="vm.onChangeCollapsed({id: id, collapsed: collapsed})">\n        </annotation-thread>\n    </div>\n    <hr ng-if="vm.isThemeClean"\n        class="thread-list__separator--theme-clean" />\n  </li>\n  <li id="{{child.id}}"\n      ng-show="false"\n      ng-repeat="child in vm.virtualThreadList.invisibleThreads track by child.id">\n      <annotation-thread thread="child" />\n  </li>\n  <li class="thread-list__spacer"\n      ng-style="{height: vm.virtualThreadList.offscreenLowerHeight}"></li>\n</ul>\n'},{}],194:[function(e,t,n){"use strict";t.exports={PANEL_HELP:"help",PANEL_SHARE_ANNOTATIONS:"shareGroupAnnotations",TAB_ANNOTATIONS:"annotation",TAB_NOTES:"note",TAB_ORPHANS:"orphan"}},{}],195:[function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.match(/^acct:([^@]+)@(.+)/);return t?{username:t[1],provider:t[2]}:null}t.exports={isThirdPartyUser:function(e,t){var n=r(e);return!!n&&n.provider!==t},parseAccountID:r,username:function(e){var t=r(e);return t?t.username:""}}},{}],196:[function(e,t,n){"use strict";function r(e){var t=e.uri,n=new URL(t).hostname,r=n;return e.document&&e.document.title&&(r=e.document.title[0]),"localhost"===n&&(n=""),{uri:t,domain:n,title:r}}function o(e){var t=e.uri;return t&&0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&(t=null),e.links&&e.links.incontext&&(t=e.links.incontext),t}function i(e){var t=r(e),n="";if(t.uri&&0===t.uri.indexOf("file://")&&t.title){var o=t.uri.split("/"),i=o[o.length-1];i&&(n=i)}else t.domain&&t.domain!==t.title&&(n=t.domain);return n}function a(e){var t=r(e).title;return t.length>30&&(t=t.slice(0,30)+""),t}function s(e){return(e.references||[]).length>0}function c(e){return!!(e.target&&e.target.length>0&&e.target[0].selector)}function u(e){return c(e)&&e.$orphan}t.exports={documentMetadata:r,domainAndTitle:function(e){return{domain:i(e),titleText:a(e),titleLink:o(e)}},flagCount:function(e){return e.moderation?e.moderation.flagCount:null},isAnnotation:function(e){return!(!c(e)||u(e))},isNew:function(e){return!e.id},isOrphan:u,isPageNote:function(e){return!c(e)&&!s(e)},isPublic:function(e){var t=!1;return e.permissions?(e.permissions.read.forEach((function(e){var n=e.split(":");2===n.length&&"group"===n[0]&&(t=!0)})),t):t},isReply:s,isWaitingToAnchor:function(e){return c(e)&&void 0===e.$orphan&&!e.$anchorTimeout},location:function(e){if(e)for(var t=e.target||[],n=0;n<t.length;n++)for(var r=t[n].selector||[],o=0;o<r.length;o++)if("TextPositionSelector"===r[o].type)return r[o].start;return Number.POSITIVE_INFINITY},quote:function(e){if(0===e.target.length)return null;var t=e.target[0];if(!t.selector)return null;var n=t.selector.find((function(e){return"TextQuoteSelector"===e.type}));return n?n.exact:null}}},{}],197:[function(e,t,n){"use strict";var r=e("../service-config");function o(e){var t=r(e);return null===t||"boolean"!=typeof t.enableShareLinks||t.enableShareLinks}function i(e){var t=e.links;return t&&(t.incontext||t.html)}t.exports={sharingEnabled:o,shareURI:i,isShareable:function(e,t){return!(!o(t)||!i(e))}}},{"../service-config":148}],198:[function(e,t,n){"use strict";t.exports={countIf:function(e,t){return e.reduce((function(e,n){return t(n)?e+1:e}),0)},filterMap:function(e,t){return e.reduce((function(e,n){var r=t(n);return r&&e.push(r),e}),[])},toSet:function(e){return e.reduce((function(e,t){return e[t]=!0,e}),{})}}},{}],199:[function(e,t,n){"use strict";t.exports={copyText:function(e){var t=document.createElement("pre");t.className="copy-text",t.textContent=e,document.body.appendChild(t);try{var n=document.createRange(),r=document.getSelection();r.removeAllRanges(),n.selectNodeContents(t),r.addRange(n),document.execCommand("copy")}finally{t.remove()}}}},{}],200:[function(e,t,n){"use strict";var r;t.exports={format:function(e){return"undefined"!=typeof Intl&&Intl.DateTimeFormat?(r||(r=new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"2-digit",weekday:"long",hour:"2-digit",minute:"2-digit"})),r.format(e)):e.toDateString()+" "+e.toLocaleTimeString()}}},{}],201:[function(e,t,n){"use strict";t.exports=function(e){e.addEventListener("click",(function(e){if("A"===e.target.tagName){var t=e.target;"_blank"===t.target&&(t.rel="noopener")}}))}},{}],202:[function(e,t,n){"use strict";t.exports={listen:function(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).useCapture,o=void 0!==r&&r;return Array.isArray(t)||(t=[t]),t.forEach((function(t){return e.addEventListener(t,n,o)})),function(){t.forEach((function(t){return e.removeEventListener(t,n,o)}))}}}},{}],203:[function(e,t,n){"use strict";var r=e("../get-api-url"),o=e("../host-config"),i=e("./postmessage-json-rpc");t.exports={fetchConfig:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,n=o(t);return(n.requestConfigFromFrame?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,n=[],r=!0,o=!1,a=void 0;try{for(var s,c=function(e){if(e===e.top)return[];var t=[];do{e=e.parent,t.push(e)}while(e!==e.top);return t}(t)[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var u=s.value,l=i.call(u,e,"requestConfig",3e3);n.push(l)}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return 0===n.length&&n.push(Promise.reject(new Error("Client is top frame"))),Promise.race(n)}(n.requestConfigFromFrame,t):Promise.resolve(n)).then((function(t){var n=Object.assign({},e,t);return n.apiUrl=r(n),n}))}}},{"../get-api-url":140,"../host-config":141,"./postmessage-json-rpc":213}],204:[function(e,t,n){"use strict";t.exports={orgName:function(e){return e.organization&&e.organization.name},trackViewGroupActivity:function(e){e.track(e.events.GROUP_VIEW_ACTIVITY)}}},{}],205:[function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=e("seamless-immutable"),a="__default__";function s(e){var t={};return e.forEach((function(e){if("object"===o(e.organization)){var n=function(e){return e.id===a?a:"".concat(e.name.toLowerCase()).concat(e.id)}(e.organization);void 0===t[n]&&(t[n]=Object.assign({},e.organization),t[n].groups=[]),function(e,t){var n=Object.assign({},e),r=t.groups;!r.length&&e.organization.logo&&(n.logo=e.organization.logo),r.push(i(n))}(e,t[n])}})),t}t.exports=function(e){var t=s(e),n=[],o=[];return Object.keys(t).sort().forEach((function(e){e===a?n.push.apply(n,r(t[e].groups)):o.push.apply(o,r(t[e].groups))})),n.length&&o.push.apply(o,n),o}},{"seamless-immutable":25}],206:[function(e,t,n){"use strict";var r=e("escape-string-regexp");t.exports={combineGroups:function(e,t,n){var o=t.find((function(e){return"__world__"===e.id}));o&&e.unshift(o);var i=e.map((function(e){return e.id}));(t=t.filter((function(e){return!i.includes(e.id)}))).forEach((function(e){return e.isMember=!1})),e.forEach((function(e){return e.isMember=!0}));var a=e.concat(t);return a.forEach((function(e){return e.isScopedToUri=function(e,t){return!(e.scopes&&e.scopes.uri_patterns.length>0&&t)||function(e,t){return void 0!==t.find((function(t){return e.match(t.split("*").map(r).join(".*"))}))}(t,e.scopes.uri_patterns)}(e,n)})),a}}},{"escape-string-regexp":5}],207:[function(e,t,n){"use strict";t.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return!(e.location.pathname.startsWith("/stream")||e.location.pathname.startsWith("/a/"))}},{}],208:[function(e,t,n){"use strict";var r=e("../service-config");t.exports=function(e){var t=r(e);return null!==t&&!!t.hasOwnProperty("authority")&&t.authority!==e.authDomain}},{"../service-config":148}],209:[function(e,t,n){"use strict";t.exports=function(e){if(1!==e.length)throw new Error("Memoize input must be a function of one argument");var t,n;return function(r){return r===t?n:(t=r,n=e(r))}}},{}],210:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("query-string"),a=e("./random");function s(e){return e.json().then((function(e){return{accessToken:e.access_token,expiresAt:Date.now()+1e3*(e.expires_in-10),refreshToken:e.refresh_token}}))}function c(){return a.generateHexString(16)}var u=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.clientId=t.clientId,this.tokenEndpoint=t.tokenEndpoint,this.authorizationEndpoint=t.authorizationEndpoint,this.revokeEndpoint=t.revokeEndpoint,this.generateState=t.generateState||c}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"exchangeAuthCode",value:function(e){var t={client_id:this.clientId,grant_type:"authorization_code",code:e};return this._formPost(this.tokenEndpoint,t).then((function(e){if(200!==e.status)throw new Error("Authorization code exchange failed");return s(e)}))}},{key:"exchangeGrantToken",value:function(e){var t={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:e};return this._formPost(this.tokenEndpoint,t).then((function(e){if(200!==e.status)throw new Error("Failed to retrieve access token");return s(e)}))}},{key:"refreshToken",value:function(e){var t={grant_type:"refresh_token",refresh_token:e};return this._formPost(this.tokenEndpoint,t).then((function(e){if(200!==e.status)throw new Error("Failed to refresh access token");return s(e)}))}},{key:"revokeToken",value:function(e){return this._formPost(this.revokeEndpoint,{token:e})}},{key:"authorize",value:function(e,t){var n=this.generateState(),o=new Promise((function(t,o){e.addEventListener("message",(function i(a){"object"===r(a.data)&&a.data.state===n&&("authorization_response"===a.data.type&&t(a.data),"authorization_canceled"===a.data.type&&o(new Error("Authorization window was closed")),e.removeEventListener("message",i))}))})),a=this.authorizationEndpoint;return a+="?"+i.stringify({client_id:this.clientId,origin:e.location.origin,response_mode:"web_message",response_type:"code",state:n}),t.location=a,o.then((function(e){return e.code}))}},{key:"_formPost",value:function(e,t){var n=i.stringify(t);return fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n})}}],[{key:"openAuthPopupWindow",value:function(e){var t=e.screen.width/2-237.5,n=e.screen.height/2-215,r=i.stringify({left:t,top:n,width:475,height:430}).replace(/&/g,",");return e.open("about:blank","Log in to Hypothesis",r)}}]),e}();t.exports=u},{"./random":214,"query-string":17}],211:[function(e,t,n){"use strict";t.exports=function(e,t){if("undefined"!=typeof ResizeObserver){var n=new ResizeObserver((function(){return t(e.clientWidth,e.clientHeight)}));return n.observe(e),function(){return n.disconnect()}}var r=e.clientWidth,o=e.clientHeight,i=function(){r===e.clientWidth&&o===e.clientHeight||(r=e.clientWidth,o=e.clientHeight,t(r,o))};e.addEventListener("load",i),window.addEventListener("resize",i);var a=new MutationObserver(i);return a.observe(e,{characterData:!0,childList:!0,subtree:!0}),function(){e.removeEventListener("load",i),window.removeEventListener("resize",i),a.disconnect()}}},{}],212:[function(e,t,n){"use strict";t.exports={onActivate:function(e,t){return{onClick:t,onKeypress:function(e){"Enter"!==e.key&&" "!==e.key||t(e)},role:e,tabIndex:0}}}},{}],213:[function(e,t,n){"use strict";var r=e("./random").generateHexString;t.exports={call:function(e,t,n){var o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2e3,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:window,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r(10),u={jsonrpc:"2.0",method:n,params:i,id:c};try{e.postMessage(u,t)}catch(e){return Promise.reject(e)}var l=new Promise((function(e,n){o=function(r){if(r.origin===t&&r.data instanceof Object&&"2.0"===r.data.jsonrpc&&r.data.id===c){var o=r.data,i=o.error,a=o.result;void 0!==i?n(i):void 0!==a?e(a):n(new Error("RPC reply had no result or error"))}},s.addEventListener("message",o)})),f=function(e,t){return new Promise((function(n,r){setTimeout((function(){return r(new Error(t))}),e)}))}(a,"Request to ".concat(t," timed out"));return Promise.race([l,f]).then((function(e){return s.removeEventListener("message",o),e})).catch((function(e){throw s.removeEventListener("message",o),e}))}}},{"./random":214}],214:[function(e,t,n){"use strict";function r(e){var t=e.toString(16);return 1===t.length?"0"+t:t}t.exports={generateHexString:function(e){var t=window.crypto||window.msCrypto,n=new Uint8Array(e/2);return t.getRandomValues(n),Array.from(n).map(r).join("")}}},{}],215:[function(e,t,n){"use strict";var r=e("retry");t.exports={retryPromiseOperation:function(e,t){return new Promise((function(n,o){var i=r.operation(t);i.attempt((function(){e().then((function(e){i.retry(),n(e)})).catch((function(e){i.retry(e)||o(e)}))}))}))}}},{retry:21}],216:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,o){var i;r=r||setTimeout,o=o||clearTimeout;var a=r((function(){i(),t()}),n);i=e.$on("$destroy",(function(){o(a)}))}},{}],217:[function(e,t,n){"use strict";var r=e("@sentry/browser"),o=e("../../shared/warn-once"),i=0,a=5;t.exports={init:function(e){var t=function(){try{return new URL(document.currentScript.src).origin}catch(e){return null}}(),n=t?[t]:null;r.init({dsn:e.dsn,environment:e.environment,release:"1.262.0",whitelistUrls:n,beforeSend:function(e,t){if(i>=a)return o("Client-side Sentry quota reached. No further Sentry events will be sent"),null;++i;try{var n=t&&t.originalException;n instanceof Event&&Object.assign(e.extra,{type:n.type,detail:n.detail,isTrusted:n.isTrusted})}catch(e){}return e}}),r.setExtra("document_url",document.referrer)},setUserInfo:function(e){r.setUser(e)},reset:function(){i=0}}},{"../../shared/warn-once":77,"@sentry/browser":"@sentry/browser"}],218:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var a=e("preact/hooks").useContext,s=e("preact"),c=s.createContext,u=s.createElement,l=c({get:function(e){throw new Error('Missing ServiceContext provider to provide "'.concat(e,'" prop'))}});t.exports={ServiceContext:l,withServices:function(e){if(!e.injectedProps)return e;function t(t){var n=a(l),r={},o=!0,s=!1,c=void 0;try{for(var f,d=e.injectedProps[Symbol.iterator]();!(o=(f=d.next()).done);o=!0){var p=f.value;p in t||(r[p]=n.get(p))}}catch(e){s=!0,c=e}finally{try{o||null==d.return||d.return()}finally{if(s)throw c}}return u(e,i({},r,t))}var n=e.displayName||e.name;return t.displayName="withServices(".concat(n,")"),t.propTypes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.propTypes),e.injectedProps.forEach((function(e){delete t.propTypes[e]})),t},useService:function(e){return a(l).get(e)}}},{preact:12,"preact/hooks":13}],219:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=e("../service-config");t.exports={shouldShowSidebarTutorial:function(e){return!!e.preferences.show_sidebar_tutorial},shouldAutoDisplayTutorial:function(e,t,n){var i="object"===r(t.preferences)&&!!t.preferences.show_sidebar_tutorial,a=o(n)||{};return e&&!a.onHelpRequestProvided&&i}}},{"../service-config":148}],220:[function(e,t,n){"use strict";t.exports={awaitStateChange:function(e,t){var n=t(e);return null!==n?Promise.resolve(n):new Promise((function(n){var r=e.subscribe((function(){var o=t(e);null!==o&&(r(),n(o))}))}))}}},{}],221:[function(e,t,n){"use strict";var r=e("./annotation-metadata"),o=e("../ui-constants");function i(e){return r.isOrphan(e)?o.TAB_ORPHANS:r.isPageNote(e)?o.TAB_NOTES:o.TAB_ANNOTATIONS}t.exports={shouldShowInTab:function(e,t){return!r.isWaitingToAnchor(e)&&i(e)===t},tabForAnnotation:i}},{"../ui-constants":194,"./annotation-metadata":196}],222:[function(e,t,n){"use strict";var r={accentColor:"color",appBackgroundColor:"backgroundColor",ctaBackgroundColor:"backgroundColor",ctaTextColor:"color",selectionFontFamily:"fontFamily",annotationFontFamily:"fontFamily"};t.exports={applyTheme:function(e,t){var n={};return t.branding?(e.forEach((function(e){var o=r[e],i=t.branding[e];o&&i&&(n[o]=i)})),n):n}}},{}],223:[function(e,t,n){"use strict";var r=1e3,o=60*r,i=60*o,a={};function s(e,t){return t-e}function c(e,t,n){if(void 0===n&&(n=window.Intl),n&&n.DateTimeFormat){var r=JSON.stringify(t),o=a[r];return o||(o=a[r]=new n.DateTimeFormat(void 0,t)),o.format(e)}return e.toDateString()}var u=[{test:function(e,t){return s(e,t)<30*r},formatFn:function(){return"Just now"},nextUpdate:1*r},{test:function(e,t){return s(e,t)<1*o},formatFn:function(e,t){var n=Math.floor(s(e,t)/r);return"".concat(n," secs ago")},nextUpdate:1*r},{test:function(e,t){return s(e,t)<1*i},formatFn:function(e,t){var n=Math.floor(s(e,t)/o),r=n>1?"s":"";return"".concat(n," min").concat(r," ago")},nextUpdate:1*o},{test:function(e,t){return s(e,t)<24*i},formatFn:function(e,t){var n=Math.floor(s(e,t)/i),r=n>1?"s":"";return"".concat(n," hr").concat(r," ago")},nextUpdate:1*i},{test:function(e,t){return e.getFullYear()===t.getFullYear()},formatFn:function(e,t,n){return c(e,{month:"short",day:"numeric"},n)},nextUpdate:null},{test:function(){return!0},formatFn:function(e,t,n){return c(e,{day:"numeric",month:"short",year:"numeric"},n)},nextUpdate:null}];function l(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=u[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s.test(e,t))return s}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return null}function f(e,t){if(!e)return null;var n=l(e,t).nextUpdate;return null===n?null:(n=Math.max(n,5*r),n=Math.min(n,2073600*r))}t.exports={clearFormatters:function(){a={}},decayingInterval:function(e,t){var n,r=e?new Date(e):null;return function o(){var i=f(r,new Date);null!==i&&(n=setTimeout((function(){t(e),o()}),i+500))}(),function(){return clearTimeout(n)}},nextFuzzyUpdate:f,toFuzzyString:function(e,t,n){return e?l(e,t).formatFn(e,t,n):""}}},{}],224:[function(e,t,n){"use strict";t.exports={replaceURLParams:function(e,t){var n={};for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],i=":"+r;-1!==e.indexOf(i)?e=e.replace(i,encodeURIComponent(o)):n[r]=o}return{url:e,params:n}},resolve:function(e,t){return new URL(e,t).href}}},{}],225:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var o=n.metadata,i="N/A";t.userid&&(i=t.userid,t.displayName&&(i="".concat(t.displayName," (").concat(i,")"))),this.timestamp=(new Date).toString(),this.url=n.uri||"N/A",this.fingerprint=o&&o.documentFingerprint?o.documentFingerprint:"N/A",this.account=i,this.userAgent=r.navigator.userAgent,this.version="1.262.0"}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"asFormattedString",value:function(){var e="";for(var t in this)Object.prototype.hasOwnProperty.call(this,t)&&(e+="".concat(t,": ").concat(this[t],"\r\n"));return e}},{key:"asEncodedURLString",value:function(){return encodeURIComponent(this.asFormattedString())}}]),e}();t.exports=o},{}],226:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=e("preact"),i=o.createElement,a=o.render,s=e("./service-context").ServiceContext;function c(e){return e.match(/^on[A-Z]/)}var u=function(){function e(t,n,r,o){var i=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.domElement=t[0],this.$injector=n,this.type=o,this.props={},Object.keys(this.type.propTypes).forEach((function(e){c(e)&&(i.props[e]=function(t){if(t!==Object(t))throw new Error("".concat(e," callback must be invoked with an object. ")+'Was passed "'.concat(t,'"'));r.$root.$$phase?i[e](t):r.$apply((function(){i[e](t)}))})}))}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"$onChanges",value:function(e){var t=this;Object.keys(e).forEach((function(n){c(n)||(t.props[n]=e[n].currentValue)})),this.updateReactComponent()}},{key:"$onDestroy",value:function(){a(i(null),this.domElement)}},{key:"updateReactComponent",value:function(){a(i(s.Provider,{value:this.$injector},i(this.type,this.props)),this.domElement)}}]),e}();t.exports=function(e){if(t.$inject=["$element","$injector","$scope"],!e.propTypes)throw new Error("React component ".concat(e.name,' does not specify its inputs using "propTypes"'));function t(t,n,r){return new u(t,n,r,e)}var n={};return Object.keys(e.propTypes).forEach((function(e){n[e]=c(e)?"&":"<"})),{bindings:n,controller:t}}},{"./service-context":218,preact:12}],227:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}var c=e("tiny-emitter"),u=e("lodash.debounce"),l=function(e){function t(e,n,o,s){var c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=a(c=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?a(e):t}(this,i(t).call(this)));c._rootThread=o,c._options=Object.assign({},s),c._heights={},c.window=n,c.scrollRoot=s.scrollRoot||document.body;var f=u((function(){l.calculateVisibleThreads(),e.$digest()}),20);return c.scrollRoot.addEventListener("scroll",f),c.window.addEventListener("resize",f),c._detach=function(){this.scrollRoot.removeEventListener("scroll",f),this.window.removeEventListener("resize",f)},c}return s(t,c),function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(t,[{key:"detach",value:function(){this._detach()}},{key:"setRootThread",value:function(e){e!==this._rootThread&&(this._rootThread=e,this.calculateVisibleThreads())}},{key:"setThreadHeight",value:function(e,t){if(isNaN(t)||t<=0)throw new Error("Invalid thread height %d",t);this._heights[e]=t}},{key:"_height",value:function(e){return this._heights[e]||200}},{key:"yOffsetOf",value:function(e){var t=this,n=this._rootThread.children,r=n.findIndex((function(t){return t.id===e}));return-1===r?0:n.slice(0,r).reduce((function(e,n){return e+t._height(n.id)}),0)}},{key:"calculateVisibleThreads",value:function(){for(var e,t=0,n=0,r=[],o=[],i=this._rootThread.children,a=this.window.innerHeight,s=0,c=0;c<i.length;c++){e=i[c];var u=this._height(e.id),l=!1;s+u<this.scrollRoot.scrollTop-800?n+=u:s<this.scrollRoot.scrollTop+a+800?(r.push(e),l=!0):t+=u,!l&&this._options.invisibleThreadFilter&&this._options.invisibleThreadFilter(e)&&o.push(e),s+=u}return this.emit("changed",{offscreenLowerHeight:t,offscreenUpperHeight:n,visibleThreads:r,invisibleThreads:o}),{offscreenLowerHeight:t,offscreenUpperHeight:n,visibleThreads:r,invisibleThreads:o}}}]),t}();t.exports=l},{"lodash.debounce":8,"tiny-emitter":30}],228:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}var s=e("retry"),c=e("tiny-emitter"),u=1e3,l=1e3,f=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a,c,f=i(n=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}(this,o(t).call(this))),d=[];function p(){for(;d.length>0;){var e=JSON.stringify(d.shift());a.send(e)}}return n.close=function(){a.close()},n.send=function(e){d.push(e),this.isConnected()&&p()},n.isConnected=function(){return a.readyState===WebSocket.OPEN},function t(){c||(c=s.operation({minTimeout:2*l,retries:10,randomize:!0})).attempt((function(){(a=new WebSocket(e)).onopen=function(e){c=null,p(),f.emit("open",e)},a.onclose=function(e){if(e.code!==u){var n=new Error("WebSocket closed abnormally, code: "+e.code);console.warn(n),function(e){if(c)c.retry(e)||console.error("reached max retries attempting to reconnect websocket");else{var n=l;n+=Math.floor(Math.random()*n),c=setTimeout((function(){c=null,t()}),n)}}(n)}else f.emit("close",e)},a.onerror=function(e){f.emit("error",e)},a.onmessage=function(e){f.emit("message",e)}}))}(),n}return a(t,c),t}();t.exports=f},{retry:21,"tiny-emitter":30}]},{},[142]);
//# sourceMappingURL=sidebar.bundle.js.map